<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Biodiverse: Biodiverse::Tree Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Biodiverse
   &#160;<span id="projectnumber">0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classBiodiverse_1_1Tree.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classBiodiverse_1_1Tree-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Biodiverse::Tree Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Biodiverse::Tree:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBiodiverse_1_1Tree__coll__graph.png" border="0" usemap="#Biodiverse_1_1Tree_coll__map" alt="Collaboration graph"/></div>
<map name="Biodiverse_1_1Tree_coll__map" id="Biodiverse_1_1Tree_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a0579936aee34b5444872aa4df8cd4459"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0579936aee34b5444872aa4df8cd4459"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>stats_class</b></td></tr>
<tr class="separator:a0579936aee34b5444872aa4df8cd4459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac9b26ab630eaff010f4a8269209e48f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac9b26ab630eaff010f4a8269209e48f"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>EMPTY_STRING</b></td></tr>
<tr class="separator:aac9b26ab630eaff010f4a8269209e48f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Avaliable Methods</h2></td></tr>
<tr class="memitem:a25da5d55c96372f4f451ad7dd7a82fa8"><td class="memItemLeft" align="right" valign="top">scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a25da5d55c96372f4f451ad7dd7a82fa8">AUTOLOAD</a></td></tr>
<tr class="separator:a25da5d55c96372f4f451ad7dd7a82fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7e3fd63125d195c9f24e42ad3f4db2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a9b7e3fd63125d195c9f24e42ad3f4db2">compare</a> ()</td></tr>
<tr class="separator:a9b7e3fd63125d195c9f24e42ad3f4db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61535a864f05fe2d59bc9e0270014935"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a61535a864f05fe2d59bc9e0270014935">get_root_nodes</a> ()</td></tr>
<tr class="separator:a61535a864f05fe2d59bc9e0270014935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a2543198b355ea4f103ef3ed3d3154"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae9a2543198b355ea4f103ef3ed3d3154">get_node_refs</a> ()</td></tr>
<tr class="separator:ae9a2543198b355ea4f103ef3ed3d3154"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a765e8f89fe7999881bfa336b1fac7a43"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a765e8f89fe7999881bfa336b1fac7a43">get_node_count</a> ()</td></tr>
<tr class="separator:a765e8f89fe7999881bfa336b1fac7a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7af879258c3caf1321c3efa2c29e6d2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac7af879258c3caf1321c3efa2c29e6d2">get_tree_length</a> ()</td></tr>
<tr class="separator:ac7af879258c3caf1321c3efa2c29e6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889a8e0744c3461e290b38ab71eccc80"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a889a8e0744c3461e290b38ab71eccc80">rename</a> ()</td></tr>
<tr class="separator:a889a8e0744c3461e290b38ab71eccc80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac925f7a86358d8360cd7e111f4e83aad"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac925f7a86358d8360cd7e111f4e83aad">get_root_node_refs</a> ()</td></tr>
<tr class="separator:ac925f7a86358d8360cd7e111f4e83aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a66c9e50eff509c161c1f545db0a2f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a64a66c9e50eff509c161c1f545db0a2f">get_metadata_export</a> ()</td></tr>
<tr class="separator:a64a66c9e50eff509c161c1f545db0a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1e795779a11c3ea32cb0a1982941325"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac1e795779a11c3ea32cb0a1982941325">numerically</a> ()</td></tr>
<tr class="separator:ac1e795779a11c3ea32cb0a1982941325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a6cc6e68fc7839d82d48357c467a34"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a69a6cc6e68fc7839d82d48357c467a34">get_max_total_length</a> ()</td></tr>
<tr class="separator:a69a6cc6e68fc7839d82d48357c467a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c708967749e36b64c163e9d03572ed8"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a9c708967749e36b64c163e9d03572ed8">export_newick</a> ()</td></tr>
<tr class="separator:a9c708967749e36b64c163e9d03572ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6bfd41d8c486324f48bfdcd102b894d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ab6bfd41d8c486324f48bfdcd102b894d">set_parents_below</a> ()</td></tr>
<tr class="separator:ab6bfd41d8c486324f48bfdcd102b894d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6839b73ab3dc0c7bf6f6c11861482444"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a6839b73ab3dc0c7bf6f6c11861482444">weaken_parent_refs</a> ()</td></tr>
<tr class="separator:a6839b73ab3dc0c7bf6f6c11861482444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6ee1c7a898ddc646ec042815ffd551"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#abb6ee1c7a898ddc646ec042815ffd551">trim</a> ()</td></tr>
<tr class="separator:abb6ee1c7a898ddc646ec042815ffd551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe08f6d533f61fd9a171e5f6b2d85e29"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#abe08f6d533f61fd9a171e5f6b2d85e29">collapse_tree_below</a> ()</td></tr>
<tr class="separator:abe08f6d533f61fd9a171e5f6b2d85e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d84505757b700cee52c0bc7963a9a15"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a6d84505757b700cee52c0bc7963a9a15">export_tabular_tree</a> ()</td></tr>
<tr class="separator:a6d84505757b700cee52c0bc7963a9a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d1104b6d02d393c0f458cc41eccdac"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a63d1104b6d02d393c0f458cc41eccdac">get_list_stats</a> ()</td></tr>
<tr class="separator:a63d1104b6d02d393c0f458cc41eccdac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b895c1701bafc76e970b7685afb6115"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a7b895c1701bafc76e970b7685afb6115">contains_tree</a> ()</td></tr>
<tr class="separator:a7b895c1701bafc76e970b7685afb6115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4b471e18296bb30a26558f0f4ba49d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a8c4b471e18296bb30a26558f0f4ba49d">get_named_nodes</a> ()</td></tr>
<tr class="separator:a8c4b471e18296bb30a26558f0f4ba49d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3c816a63a191f28c94375eafa22b547"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae3c816a63a191f28c94375eafa22b547">node_is_in_tree</a> ()</td></tr>
<tr class="separator:ae3c816a63a191f28c94375eafa22b547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276acdfd68fbc07000795601775be460"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a276acdfd68fbc07000795601775be460">delete_from_node_hash</a> ()</td></tr>
<tr class="separator:a276acdfd68fbc07000795601775be460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe62f0e121cb4917f1cf35c333604094"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#abe62f0e121cb4917f1cf35c333604094">get_terminal_elements</a> ()</td></tr>
<tr class="separator:abe62f0e121cb4917f1cf35c333604094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8958638d92ccbe6b0f2a82c4ba6c1945"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a8958638d92ccbe6b0f2a82c4ba6c1945">add_node</a> ()</td></tr>
<tr class="separator:a8958638d92ccbe6b0f2a82c4ba6c1945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace607d006bc6fd264a0349d7640a9c4e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ace607d006bc6fd264a0349d7640a9c4e">export_range_table</a> ()</td></tr>
<tr class="separator:ace607d006bc6fd264a0349d7640a9c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014bc51e8ab0bced6ff6f33e039c4f26"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a014bc51e8ab0bced6ff6f33e039c4f26">get_metadata_export_table_grouped</a> ()</td></tr>
<tr class="separator:a014bc51e8ab0bced6ff6f33e039c4f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3167d750ac593335127ae460b2825a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace3167d750ac593335127ae460b2825a"></a>
public method&#160;</td><td class="memItemRight" valign="bottom"><b>AUTOLOAD</b> ()</td></tr>
<tr class="separator:ace3167d750ac593335127ae460b2825a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ccf313cd54e7617292e4b460397a80"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae0ccf313cd54e7617292e4b460397a80">get_total_tree_length</a> ()</td></tr>
<tr class="separator:ae0ccf313cd54e7617292e4b460397a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa57a2c23c0eb60cf4c3d81df41d8819a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#aa57a2c23c0eb60cf4c3d81df41d8819a">get_last_shared_ancestor_for_nodes</a> ()</td></tr>
<tr class="separator:aa57a2c23c0eb60cf4c3d81df41d8819a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3eea5eb7a4d34650676277d9c073e32"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#af3eea5eb7a4d34650676277d9c073e32">get_node_hash_by_total_length</a> ()</td></tr>
<tr class="separator:af3eea5eb7a4d34650676277d9c073e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6994a68f467d3d2f9e7c0c4c217355e4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a6994a68f467d3d2f9e7c0c4c217355e4">get_metadata_export_tabular_tree</a> ()</td></tr>
<tr class="separator:a6994a68f467d3d2f9e7c0c4c217355e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b10fa4b330b635ef8a734c94b423861"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a5b10fa4b330b635ef8a734c94b423861">get_root_node</a> ()</td></tr>
<tr class="separator:a5b10fa4b330b635ef8a734c94b423861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b6633049adbc557f4ded3b22d16cf0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ab0b6633049adbc557f4ded3b22d16cf0">get_terminal_node_refs</a> ()</td></tr>
<tr class="separator:ab0b6633049adbc557f4ded3b22d16cf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2f33456a58711e7b7f1af3d28ac625"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a6b2f33456a58711e7b7f1af3d28ac625">get_terminal_nodes</a> ()</td></tr>
<tr class="separator:a6b2f33456a58711e7b7f1af3d28ac625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b363d731983b96c9c8280bb5cf2689"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a42b363d731983b96c9c8280bb5cf2689">get_node_ref</a> ()</td></tr>
<tr class="separator:a42b363d731983b96c9c8280bb5cf2689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abc5187a00abaa2c8aac7158e381f26"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a5abc5187a00abaa2c8aac7158e381f26">get_table_export_metadata</a> ()</td></tr>
<tr class="separator:a5abc5187a00abaa2c8aac7158e381f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b94f0bb41dc4dcd8599cbd4c724c3e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a54b94f0bb41dc4dcd8599cbd4c724c3e">get_metadata_export_range_table</a> ()</td></tr>
<tr class="separator:a54b94f0bb41dc4dcd8599cbd4c724c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3594b5287b3f2e1f28130361541b2027"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a3594b5287b3f2e1f28130361541b2027">max</a> ()</td></tr>
<tr class="separator:a3594b5287b3f2e1f28130361541b2027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c51d82228e4219c3167129bb6c08bb"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a97c51d82228e4219c3167129bb6c08bb">get_node_hash</a> ()</td></tr>
<tr class="separator:a97c51d82228e4219c3167129bb6c08bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a5f2a93f953c655729baa000565bfc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a19a5f2a93f953c655729baa000565bfc">get_node_hash_by_depth_below</a> ()</td></tr>
<tr class="separator:a19a5f2a93f953c655729baa000565bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc25799bef5a7c2e8303217c33109d9"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#afcc25799bef5a7c2e8303217c33109d9">add_to_node_hash</a> ()</td></tr>
<tr class="separator:afcc25799bef5a7c2e8303217c33109d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1137610fd272f0c34d4b431fc460a6d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae1137610fd272f0c34d4b431fc460a6d">get_node_hash_by_depth</a> ()</td></tr>
<tr class="separator:ae1137610fd272f0c34d4b431fc460a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15bdbe722c14b241c01abf09490e95b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac15bdbe722c14b241c01abf09490e95b">get_range_table</a> ()</td></tr>
<tr class="separator:ac15bdbe722c14b241c01abf09490e95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0d728517492a2c984c5470f3a22c67"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a7f0d728517492a2c984c5470f3a22c67">new</a> ()</td></tr>
<tr class="separator:a7f0d728517492a2c984c5470f3a22c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a855c4870813c037883a29bdd4a6466f0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a855c4870813c037883a29bdd4a6466f0">export</a> ()</td></tr>
<tr class="separator:a855c4870813c037883a29bdd4a6466f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac48efbb0e6fae004e7d9d3051ea8279c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac48efbb0e6fae004e7d9d3051ea8279c">get_unique_name</a> ()</td></tr>
<tr class="separator:ac48efbb0e6fae004e7d9d3051ea8279c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa74cf32ae2d17c33da4b350ec958997"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#aaa74cf32ae2d17c33da4b350ec958997">shuffle_terminal_names</a> ()</td></tr>
<tr class="separator:aaa74cf32ae2d17c33da4b350ec958997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e988bfc5c6f12c5c46678427521df3"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae3e988bfc5c6f12c5c46678427521df3">get_tree_depth</a> ()</td></tr>
<tr class="separator:ae3e988bfc5c6f12c5c46678427521df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a788a961c6e9648d04fdc1f2ba6a936"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a4a788a961c6e9648d04fdc1f2ba6a936">get_metadata_export_nexus</a> ()</td></tr>
<tr class="separator:a4a788a961c6e9648d04fdc1f2ba6a936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae191a462ea80da433e1ef3f2bc97ab86"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae191a462ea80da433e1ef3f2bc97ab86">root_unrooted_tree</a> ()</td></tr>
<tr class="separator:ae191a462ea80da433e1ef3f2bc97ab86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6aea1c26db724541c0e5c8066618ed"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a0e6aea1c26db724541c0e5c8066618ed">get_branch_node_refs</a> ()</td></tr>
<tr class="separator:a0e6aea1c26db724541c0e5c8066618ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b3ed75a7f6264bc88fb52955ccd1d1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a83b3ed75a7f6264bc88fb52955ccd1d1">DESTROY</a> ()</td></tr>
<tr class="separator:a83b3ed75a7f6264bc88fb52955ccd1d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac806e98e291f0969df4f3bb8abc66fbc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac806e98e291f0969df4f3bb8abc66fbc">to_matrix</a> ()</td></tr>
<tr class="separator:ac806e98e291f0969df4f3bb8abc66fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52412801f941e70b588363d1b89e907e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a52412801f941e70b588363d1b89e907e">describe</a> ()</td></tr>
<tr class="separator:a52412801f941e70b588363d1b89e907e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c452994d1e5ceaefeafb24daa73244c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a8c452994d1e5ceaefeafb24daa73244c">export_table_grouped</a> ()</td></tr>
<tr class="separator:a8c452994d1e5ceaefeafb24daa73244c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cda3395505daa9181be4c9145b96bcf"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a4cda3395505daa9181be4c9145b96bcf">get_lists_for_export</a> ()</td></tr>
<tr class="separator:a4cda3395505daa9181be4c9145b96bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6437404b3ca199ec97733c9307051f80"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a6437404b3ca199ec97733c9307051f80">get_tree_ref</a> ()</td></tr>
<tr class="separator:a6437404b3ca199ec97733c9307051f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8102174908f6e30d6fd88c5d0ec09cfe"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a8102174908f6e30d6fd88c5d0ec09cfe">get_branch_nodes</a> ()</td></tr>
<tr class="separator:a8102174908f6e30d6fd88c5d0ec09cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d256b9520fbd573bdad8d4f39fcda6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a35d256b9520fbd573bdad8d4f39fcda6">export_nexus</a> ()</td></tr>
<tr class="separator:a35d256b9520fbd573bdad8d4f39fcda6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9583b65614cbb1d9911b81bda8a81b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#aeb9583b65614cbb1d9911b81bda8a81b">find_list_indices_across_nodes</a> ()</td></tr>
<tr class="separator:aeb9583b65614cbb1d9911b81bda8a81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0165c03955edf4460fce5671e24fce4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ae0165c03955edf4460fce5671e24fce4">get_terminal_element_count</a> ()</td></tr>
<tr class="separator:ae0165c03955edf4460fce5671e24fce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77dc1fe009ceccba2694c19efe3359c4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a77dc1fe009ceccba2694c19efe3359c4">get_length_to_tip</a> ()</td></tr>
<tr class="separator:a77dc1fe009ceccba2694c19efe3359c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191ee4a4dbd4b0f3e798a7ff6ff1e4ba"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a191ee4a4dbd4b0f3e798a7ff6ff1e4ba">trees_are_same</a> ()</td></tr>
<tr class="separator:a191ee4a4dbd4b0f3e798a7ff6ff1e4ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af551d57c50ac5e4038e1ec4e1c815bfa"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#af551d57c50ac5e4038e1ec4e1c815bfa">min</a> ()</td></tr>
<tr class="separator:af551d57c50ac5e4038e1ec4e1c815bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e894d100d79083299c9fd05ada4433"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ab9e894d100d79083299c9fd05ada4433">get_lists_export_metadata</a> ()</td></tr>
<tr class="separator:ab9e894d100d79083299c9fd05ada4433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1b71cdcf0069654c55b5a0df15e887"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#abc1b71cdcf0069654c55b5a0df15e887">collapse_tree</a> ()</td></tr>
<tr class="separator:abc1b71cdcf0069654c55b5a0df15e887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5488d868f993bdc0ae5f7e22c7b9b61a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a5488d868f993bdc0ae5f7e22c7b9b61a">get_metadata_export_newick</a> ()</td></tr>
<tr class="separator:a5488d868f993bdc0ae5f7e22c7b9b61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23daed7c20396c4d46ca7a98d50f4018"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a23daed7c20396c4d46ca7a98d50f4018">shuffle_no_change</a> ()</td></tr>
<tr class="separator:a23daed7c20396c4d46ca7a98d50f4018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a87e663ddffc738b98105c58d59d19"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ad8a87e663ddffc738b98105c58d59d19">delete_node</a> ()</td></tr>
<tr class="separator:ad8a87e663ddffc738b98105c58d59d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaec80d380581dcad90c96e56e36b3a2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#abaec80d380581dcad90c96e56e36b3a2">get_free_internal_name</a> ()</td></tr>
<tr class="separator:abaec80d380581dcad90c96e56e36b3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac871d5a0b9f0ec7bbfda74f23507e77d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#ac871d5a0b9f0ec7bbfda74f23507e77d">exists_node</a> ()</td></tr>
<tr class="separator:ac871d5a0b9f0ec7bbfda74f23507e77d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9963e391cf6afb4d2198d60d5f9944bb"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Tree.html#a9963e391cf6afb4d2198d60d5f9944bb">is_tree_object</a> ()</td></tr>
<tr class="separator:a9963e391cf6afb4d2198d60d5f9944bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="NAME"></a>
NAME</h1>
<p>Biodiverse::????</p>
<h1><a class="anchor" id="SYNOPSIS"></a>
SYNOPSIS</h1>
<pre>  use Biodiverse::????;
  $object = <a class="el" href="classBiodiverse_1_1Statistics.html">Biodiverse::Statistics</a>-&gt;<a class="el" href="classBiodiverse_1_1Tree.html#a7f0d728517492a2c984c5470f3a22c67">new()</a>;</pre><h1><a class="anchor" id="DESCRIPTION"></a>
DESCRIPTION</h1>
<p>TO BE FILLED IN</p>
<h1><a class="anchor" id="METHODS"></a>
METHODS</h1>
<ul>
<li>
<a class="anchor" id="item_INSERT_METHODS"></a><b>INSERT METHODS</b>  </li>
</ul>
<h1><a class="anchor" id="REPORTING_ERRORS"></a>
REPORTING ERRORS</h1>
<p>Use the issue tracker at <a href="http://www.purl.org/biodiverse">http://www.purl.org/biodiverse</a></p>
<h1><a class="anchor" id="COPYRIGHT"></a>
COPYRIGHT</h1>
<p>Copyright (c) 2010 Shawn Laffan. All rights reserved.</p>
<h1><a class="anchor" id="LICENSE"></a>
LICENSE</h1>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>For a full copy of the license see &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>

<p>Definition at line <a class="el" href="Tree_8pm_source.html#l00059">59</a> of file <a class="el" href="Tree_8pm_source.html">Tree.pm</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8958638d92ccbe6b0f2a82c4ba6c1945"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::add_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_node: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a8958638d92ccbe6b0f2a82c4ba6c1945">add_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $node = $args{node_ref} || <a class="code" href="classBiodiverse_1_1TreeNode.html">Biodiverse::TreeNode</a>-&gt;<a class="code" href="classBiodiverse_1_1TreeNode.html#ac5c47488d553f4bc9f82103672df0966">new</a> (@_);</div>
<div class="line">    $self-&gt;add_to_node_hash (node_ref =&gt; $node);</div>
<div class="line">    <span class="keywordflow">return</span> $node;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="afcc25799bef5a7c2e8303217c33109d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::add_to_node_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_to_node_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_to_node_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_to_node_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_to_node_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_to_node_hash: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#afcc25799bef5a7c2e8303217c33109d9">add_to_node_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $nodeRef = $args{node_ref};</div>
<div class="line">    my $name = $nodeRef-&gt;get_name;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;exists_node (@_)) {</div>
<div class="line">        Biodiverse::Tree::NodeAlreadyExists-&gt;throw(</div>
<div class="line">            message =&gt; <span class="stringliteral">&quot;Node $name already exists in this tree\n&quot;</span>,</div>
<div class="line">            name    =&gt; $name,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;{TREE_BY_NAME}{$name} = $nodeRef;</div>
<div class="line">    <span class="keywordflow">return</span> $nodeRef <span class="keywordflow">if</span> defined wantarray;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abc1b71cdcf0069654c55b5a0df15e887"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::collapse_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-collapse_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-collapse_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-collapse_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-collapse_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in collapse_tree: 103</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#abc1b71cdcf0069654c55b5a0df15e887">collapse_tree</a> {</div>
<div class="line"><span class="preprocessor">#  collapse tree to a polytomy a set distance above the tips</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  assumes ultrametric tree</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $self = shift;   # expects a Tree <span class="keywordtype">object</span></div>
<div class="line">    my %args = @_;</div>
<div class="line"><span class="preprocessor">    # the only args are:</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #   cutoff_absolute - the depth from the tips of the tree at which to cut in units of branch length</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #   or cutoff_relative - the depth from the tips of the tree at which to cut as a proportion</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #   of the total tree depth.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #   if both parameters are given, cutoff_relative overrides cutoff_absolute</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $cutoff = $args{cutoff_absolute};</div>
<div class="line"></div>
<div class="line">    my $total_tree_length = $self-&gt;get_tree_length;    </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cutoff_relative} &gt;= 0) {</div>
<div class="line">        my $cutoff_relative = $args{cutoff_relative};</div>
<div class="line">        <span class="keywordflow">if</span> (($cutoff_relative &gt;= 0) and ($cutoff_relative &lt;= 1)) {</div>
<div class="line">            $cutoff = $cutoff_relative * $total_tree_length;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my ($zero_count, $shorter_count);</div>
<div class="line"></div>
<div class="line">    my %node_hash = $self-&gt;get_node_hash;</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Total length: &quot;</span>.$total_tree_length.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Node count: &quot;</span>.(scalar keys %node_hash).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $node;</div>
<div class="line"></div>
<div class="line">    my %new_node_lengths;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  first pass - calculate the new lengths</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $name (sort keys %node_hash) {</div>
<div class="line">        $node = $node_hash{$name};</div>
<div class="line"><span class="preprocessor">        #my $new_branch_length;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        my $node_length = $node-&gt;get_length;</div>
<div class="line">        my $length_to_tip = $node-&gt;get_length_below;  #  includes length of $node</div>
<div class="line">        my $upper_bound = $length_to_tip;</div>
<div class="line">        my $lower_bound = $length_to_tip - $node_length;</div>
<div class="line"></div>
<div class="line">        my $type;</div>
<div class="line"><span class="preprocessor">        # whole branch is inside the limit - no change</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ($upper_bound &lt; $cutoff) {</div>
<div class="line">            next;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">        # whole of branch is outside limit - set branch length to 0</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($lower_bound &gt;= $cutoff) {</div>
<div class="line">            $new_node_lengths{$name} = 0;</div>
<div class="line">            $zero_count ++;</div>
<div class="line">            $type = 1;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">        # part of branch is outside limit - shorten branch</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span> {                       </div>
<div class="line">            $new_node_lengths{$name} = $cutoff - $lower_bound;</div>
<div class="line">            $shorter_count ++;</div>
<div class="line">            $type = 2;</div>
<div class="line">        };</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  second pass - apply the new lengths</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $name (keys %new_node_lengths) {</div>
<div class="line">        $node = $node_hash{$name};</div>
<div class="line"></div>
<div class="line">        my $new_length;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ($new_node_lengths{$name} == 0) {</div>
<div class="line">            <span class="keywordflow">if</span> ($node-&gt;is_terminal_node) {</div>
<div class="line">                $new_length = ($total_tree_length / 10000);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                $new_length = 0;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            $new_length = $new_node_lengths{$name};</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        $node-&gt;set_length (length =&gt; $new_length);</div>
<div class="line"></div>
<div class="line">        print <span class="stringliteral">&quot;$name: new length is $new_length\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;delete_cached_values;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  reset all the total length values</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;reset_total_length_below;</div>
<div class="line">    $self-&gt;get_total_tree_length;</div>
<div class="line"></div>
<div class="line">    my @now_empty = $self-&gt;flatten_tree;</div>
<div class="line"><span class="preprocessor">    #  now we clean up all the empty nodes in the other indexes</span></div>
<div class="line"><span class="preprocessor"></span>    print <span class="stringliteral">&quot;[TREE] Deleting &quot;</span> . scalar @now_empty . <span class="stringliteral">&quot; empty nodes\n&quot;</span>;</div>
<div class="line"><span class="preprocessor">    #foreach my $now_empty (@now_empty) {</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;delete_from_node_hash (nodes =&gt; \@now_empty) <span class="keywordflow">if</span> scalar @now_empty;</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Total length: &quot;</span> . $self-&gt;get_tree_length . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Node count: &quot;</span> . $self-&gt;get_node_count . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abe08f6d533f61fd9a171e5f6b2d85e29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::collapse_tree_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-collapse_tree_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-collapse_tree_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-collapse_tree_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-collapse_tree_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in collapse_tree_below: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#abe08f6d533f61fd9a171e5f6b2d85e29">collapse_tree_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $target_hash = $self-&gt;group_nodes_below (%args);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $node (values %$target_hash) {</div>
<div class="line">        my %terminals = $node-&gt;get_terminal_node_refs;</div>
<div class="line">        my @children = $node-&gt;get_children;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $desc_node (@children) {</div>
<div class="line">            next <span class="keywordflow">if</span> $desc_node-&gt;is_terminal_node;</div>
<div class="line">            eval {</div>
<div class="line">                $self-&gt;delete_node (node =&gt; $desc_node-&gt;get_name);</div>
<div class="line">            };</div>
<div class="line">        }</div>
<div class="line">        $node-&gt;add_children (children =&gt; [values %terminals]);  #  still need to ensure they are in the node hash</div>
<div class="line"></div>
<div class="line">        print <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9b7e3fd63125d195c9f24e42ad3f4db2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::compare </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-compare' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-compare-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-compare-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-compare-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in compare: 202</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a9b7e3fd63125d195c9f24e42ad3f4db2">compare</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  make all numeric warnings fatal to catch locale/sprintf issues</span></div>
<div class="line"><span class="preprocessor"></span>    use warnings FATAL =&gt; qw { numeric };</div>
<div class="line"></div>
<div class="line">    my $comparison = $args{comparison}</div>
<div class="line">      || croak <span class="stringliteral">&quot;Comparison not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $track_matches    = !$args{no_track_matches};</div>
<div class="line">    my $track_node_stats = !$args{no_track_node_stats};</div>
<div class="line">    my $terminals_only   = $args{terminals_only};</div>
<div class="line">    my $comp_precision   = $args{comp_precision} <span class="comment">// &#39;%.10f&#39;;</span></div>
<div class="line"></div>
<div class="line">    my $result_list_pfx = $args{result_list_name};</div>
<div class="line">    <span class="keywordflow">if</span> (!$track_matches) {  #  avoid some warnings lower down</div>
<div class="line">       $result_list_pfx <span class="comment">//= q{};</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Comparison list name not specified\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> ! defined $result_list_pfx;</div>
<div class="line"></div>
<div class="line">    my $result_data_list = $result_list_pfx . <span class="stringliteral">&quot;_DATA&quot;</span>;</div>
<div class="line">    my $result_identical_node_length_list = $result_list_pfx . <span class="stringliteral">&quot;_ID_LDIFFS&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $progress = <a class="code" href="classBiodiverse_1_1Progress.html">Biodiverse::Progress</a>-&gt;<a class="code" href="classBiodiverse_1_1Progress.html#a88f4cef6f66986952a850fb70a2b62d8">new</a>();</div>
<div class="line">    my $progress_text</div>
<div class="line">      = sprintf <span class="stringliteral">&quot;Comparing %s with %s\n&quot;</span>,</div>
<div class="line">        $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>),</div>
<div class="line">        $comparison-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line">    $progress-&gt;update ($progress_text, 0);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #print &quot;\n[TREE] &quot; . $progress_text;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #  set up the comparison operators if it has spatial results</span></div>
<div class="line"><span class="preprocessor"></span>    my $has_spatial_results = defined $self-&gt;get_list_ref (</div>
<div class="line">        list =&gt; <span class="stringliteral">&#39;SPATIAL_RESULTS&#39;</span>,</div>
<div class="line">    );</div>
<div class="line">    my %base_list_indices;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($track_matches &amp;&amp; $has_spatial_results) {</div>
<div class="line"></div>
<div class="line">        %base_list_indices = $self-&gt;find_list_indices_across_nodes;</div>
<div class="line">        $base_list_indices{SPATIAL_RESULTS} = <span class="stringliteral">&#39;SPATIAL_RESULTS&#39;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">foreach</span> my $list_name (keys %base_list_indices) {</div>
<div class="line">            $base_list_indices{$list_name}</div>
<div class="line">                = $result_list_pfx . <span class="stringliteral">&#39;&gt;&gt;&#39;</span> . $list_name;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we chug through each node, finding its most similar comparator node in the other tree</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  we store the similarity value as a measure of cluster reliability and </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  we then use that node to assess how goodthe spatial results are</span></div>
<div class="line"><span class="preprocessor"></span>    my $min_poss_value = 0;</div>
<div class="line">    my $max_poss_value = 1;</div>
<div class="line">    my %compare_nodes = $comparison-&gt;get_node_hash;  #  make sure it<span class="stringliteral">&#39;s a copy</span></div>
<div class="line"><span class="stringliteral">    my %done;</span></div>
<div class="line"><span class="stringliteral">    my %found_perfect_match;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $to_do = max ($self-&gt;get_node_count, $comparison-&gt;get_node_count);</span></div>
<div class="line"><span class="stringliteral">    my $i = 0;</span></div>
<div class="line"><span class="stringliteral">    my $last_update = [gettimeofday];</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">  BASE_NODE:</span></div>
<div class="line"><span class="stringliteral">    foreach my $base_node ($self-&gt;get_node_refs) {</span></div>
<div class="line"><span class="stringliteral">        $i++;</span></div>
<div class="line"><span class="stringliteral">        $progress-&gt;update ($progress_text . &quot;(node $i / $to_do)&quot;, $i / $to_do);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        my %base_elements = $base_node-&gt;get_terminal_elements;</span></div>
<div class="line"><span class="stringliteral">        my $base_node_name = $base_node-&gt;get_name;</span></div>
<div class="line"><span class="stringliteral">        my $min_val = $max_poss_value;</span></div>
<div class="line"><span class="stringliteral">        my $most_similar_node;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        #  A small optimisation - if they have the same name then</span></div>
<div class="line"><span class="stringliteral">        #  they can often have the same terminals so this will</span></div>
<div class="line"><span class="stringliteral">        #  reduce the search times</span></div>
<div class="line"><span class="stringliteral">        my @compare_name_list = keys %compare_nodes;</span></div>
<div class="line"><span class="stringliteral">        if (exists $compare_nodes{$base_node_name}) {</span></div>
<div class="line"><span class="stringliteral">            unshift @compare_name_list, $base_node_name;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        COMP:</span></div>
<div class="line"><span class="stringliteral">        foreach my $compare_node_name (@compare_name_list) {</span></div>
<div class="line"><span class="stringliteral">            next if exists $found_perfect_match{$compare_node_name};</span></div>
<div class="line"><span class="stringliteral">            my $sorenson = $done{$compare_node_name}{$base_node_name}</span></div>
<div class="line"><span class="stringliteral">                        // $done{$base_node_name}{$compare_node_name};</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            if (! defined $sorenson) { #  if still not defined then it needs to be calculated</span></div>
<div class="line"><span class="stringliteral">                my %comp_elements  = $compare_nodes{$compare_node_name}-&gt;get_terminal_elements;</span></div>
<div class="line"><span class="stringliteral">                my %union_elements = (%comp_elements, %base_elements);</span></div>
<div class="line"><span class="stringliteral">                my $abc =  scalar keys %union_elements;</span></div>
<div class="line"><span class="stringliteral">                my $a   = (scalar keys %base_elements) + (scalar keys %comp_elements) - $abc;</span></div>
<div class="line"><span class="stringliteral">                $sorenson = 1 - ((2 * $a) / ($a + $abc));</span></div>
<div class="line"><span class="stringliteral">                $done{$compare_node_name}{$base_node_name} = $sorenson;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            if ($sorenson &lt;= $min_val) {</span></div>
<div class="line"><span class="stringliteral">                $min_val = $sorenson;</span></div>
<div class="line"><span class="stringliteral">                $most_similar_node = $compare_nodes{$compare_node_name};</span></div>
<div class="line"><span class="stringliteral">                carp $compare_node_name if ! defined $most_similar_node;</span></div>
<div class="line"><span class="stringliteral">                if ($sorenson == $min_poss_value) {</span></div>
<div class="line"><span class="stringliteral">                    #  cannot be related to another node</span></div>
<div class="line"><span class="stringliteral">                    if ($terminals_only) {</span></div>
<div class="line"><span class="stringliteral">                        $found_perfect_match{$compare_node_name} = 1;</span></div>
<div class="line"><span class="stringliteral">                    }</span></div>
<div class="line"><span class="stringliteral">                    else {</span></div>
<div class="line"><span class="stringliteral">                        #  If its length is same then we have perfect match</span></div>
<div class="line"><span class="stringliteral">                        my $len_comp = $self-&gt;set_precision (</span></div>
<div class="line"><span class="stringliteral">                            value     =&gt; $compare_nodes{$compare_node_name}-&gt;get_length,</span></div>
<div class="line"><span class="stringliteral">                            precision =&gt; $comp_precision,</span></div>
<div class="line"><span class="stringliteral">                        );</span></div>
<div class="line"><span class="stringliteral">                        my $len_base = $self-&gt;set_precision (</span></div>
<div class="line"><span class="stringliteral">                            value     =&gt; $base_node-&gt;get_length,</span></div>
<div class="line"><span class="stringliteral">                            precision =&gt; $comp_precision,</span></div>
<div class="line"><span class="stringliteral">                        );</span></div>
<div class="line"><span class="stringliteral">                        if ($len_comp eq $len_base) {</span></div>
<div class="line"><span class="stringliteral">                            $found_perfect_match{$compare_node_name} = $len_base;</span></div>
<div class="line"><span class="stringliteral">                        }</span></div>
<div class="line"><span class="stringliteral">                        #else {say &quot;$compare_node_name, $len_comp, $len_base&quot;}</span></div>
<div class="line"><span class="stringliteral">                    }</span></div>
<div class="line"><span class="stringliteral">                    last COMP;</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">            carp &quot;$compare_node_name $sorenson $min_val&quot;</span></div>
<div class="line"><span class="stringliteral">                if ! defined $most_similar_node;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        next BASE_NODE if !$track_matches;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        if ($track_node_stats) {</span></div>
<div class="line"><span class="stringliteral">            $base_node-&gt;add_to_lists ($result_data_list =&gt; [$min_val]);</span></div>
<div class="line"><span class="stringliteral">            my $stats = $stats_class-&gt;new;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">            $stats-&gt;add_data ($base_node-&gt;get_list_ref (list =&gt; $result_data_list));</span></div>
<div class="line"><span class="stringliteral">            my $prev_stat   = $base_node-&gt;get_list_ref (list =&gt; $result_list_pfx);</span></div>
<div class="line"><span class="stringliteral">            my %stats = (</span></div>
<div class="line"><span class="stringliteral">                MEAN   =&gt; $stats-&gt;mean,</span></div>
<div class="line"><span class="stringliteral">                SD     =&gt; $stats-&gt;standard_deviation,</span></div>
<div class="line"><span class="stringliteral">                MEDIAN =&gt; $stats-&gt;median,</span></div>
<div class="line"><span class="stringliteral">                Q25    =&gt; scalar $stats-&gt;percentile (25),</span></div>
<div class="line"><span class="stringliteral">                Q05    =&gt; scalar $stats-&gt;percentile (5),</span></div>
<div class="line"><span class="stringliteral">                Q01    =&gt; scalar $stats-&gt;percentile (1),</span></div>
<div class="line"><span class="stringliteral">                COUNT_IDENTICAL</span></div>
<div class="line"><span class="stringliteral">                       =&gt;   ($prev_stat-&gt;{COUNT_IDENTICAL} || 0)</span></div>
<div class="line"><span class="stringliteral">                          + ($min_val == $min_poss_value ?  1 : 0),</span></div>
<div class="line"><span class="stringliteral">                COMPARISONS</span></div>
<div class="line"><span class="stringliteral">                       =&gt; ($prev_stat-&gt;{COMPARISONS} || 0) + 1,</span></div>
<div class="line"><span class="stringliteral">            );</span></div>
<div class="line"><span class="stringliteral">            $stats{PCT_IDENTICAL} = 100 * $stats{COUNT_IDENTICAL} / $stats{COMPARISONS};</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">            my $length_diff = ($min_val == $min_poss_value)</span></div>
<div class="line"><span class="stringliteral">                            ? [  $base_node-&gt;get_total_length</span></div>
<div class="line"><span class="stringliteral">                               - $most_similar_node-&gt;get_total_length</span></div>
<div class="line"><span class="stringliteral">                              ]</span></div>
<div class="line"><span class="stringliteral">                            : [];  #  empty array by default</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">            $base_node-&gt;add_to_lists (</span></div>
<div class="line"><span class="stringliteral">                $result_identical_node_length_list =&gt; $length_diff</span></div>
<div class="line"><span class="stringliteral">            );</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">            $base_node-&gt;add_to_lists ($result_list_pfx =&gt; \%stats);</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        if ($has_spatial_results) {</span></div>
<div class="line"><span class="stringliteral">            BY_INDEX_LIST:</span></div>
<div class="line"><span class="stringliteral">            while (my ($list_name, $result_list_name) = each %base_list_indices) {</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                my $base_ref = $base_node-&gt;get_list_ref (</span></div>
<div class="line"><span class="stringliteral">                    list =&gt; $list_name,</span></div>
<div class="line"><span class="stringliteral">                );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                my $comp_ref = $most_similar_node-&gt;get_list_ref (</span></div>
<div class="line"><span class="stringliteral">                    list =&gt; $list_name,</span></div>
<div class="line"><span class="stringliteral">                );</span></div>
<div class="line"><span class="stringliteral">                next BY_INDEX_LIST if ! defined $comp_ref;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                my $results = $base_node-&gt;get_list_ref (</span></div>
<div class="line"><span class="stringliteral">                    list =&gt; $result_list_name,</span></div>
<div class="line"><span class="stringliteral">                )</span></div>
<div class="line"><span class="stringliteral">                || {};</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                $self-&gt;compare_lists_by_item (</span></div>
<div class="line"><span class="stringliteral">                    base_list_ref     =&gt; $base_ref,</span></div>
<div class="line"><span class="stringliteral">                    comp_list_ref     =&gt; $comp_ref,</span></div>
<div class="line"><span class="stringliteral">                    results_list_ref  =&gt; $results,</span></div>
<div class="line"><span class="stringliteral">                );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                #  add list to the base_node if it&#39;</span>s not already there</div>
<div class="line">                <span class="keywordflow">if</span> (! defined $base_node-&gt;get_list_ref (list =&gt; $result_list_name)) {</div>
<div class="line">                    $base_node-&gt;add_to_lists ($result_list_name =&gt; $results);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;set_last_update_time;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> scalar keys %found_perfect_match;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7b895c1701bafc76e970b7685afb6115"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::contains_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-contains_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-contains_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-contains_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-contains_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in contains_tree: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a7b895c1701bafc76e970b7685afb6115">contains_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $exact_match_count = $self-&gt;compare (%args, no_track_matches =&gt; 1);</div>
<div class="line"></div>
<div class="line">    my $comparison = $args{comparison}</div>
<div class="line">        || croak <span class="stringliteral">&quot;Comparison not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $node_count_comp = $comparison-&gt;get_node_count;</div>
<div class="line">    <span class="keywordflow">if</span> ($args{ignore_root}) {</div>
<div class="line">        $node_count_comp --;</div>
<div class="line">    }</div>
<div class="line">    my $correction += $args{correction} <span class="comment">// 0;</span></div>
<div class="line">    $node_count_comp += $correction;</div>
<div class="line"></div>
<div class="line">    my $contains = $exact_match_count == $node_count_comp;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $contains;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a276acdfd68fbc07000795601775be460"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::delete_from_node_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_from_node_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_from_node_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_from_node_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_from_node_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_from_node_hash: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a276acdfd68fbc07000795601775be460">delete_from_node_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{node}) {</div>
<div class="line">        <span class="keyword">delete</span> $self-&gt;{TREE_BY_NAME}{$args{node}};  #  $args{node} implies single deletion</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $arg_nodes_ref = ref $args{nodes};</div>
<div class="line">    my @list;</div>
<div class="line">    <span class="keywordflow">if</span> ($arg_nodes_ref =~ /HASH/) {</div>
<div class="line">        @list = keys %{$args{nodes}};</div>
<div class="line">    }</div>
<div class="line">    elsif ($arg_nodes_ref =~ /ARRAY/) {</div>
<div class="line">        @list = @{$args{nodes}};</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        @list = $args{nodes};</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">delete</span> @{$self-&gt;{TREE_BY_NAME}}{@list};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad8a87e663ddffc738b98105c58d59d19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::delete_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_node: 27</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ad8a87e663ddffc738b98105c58d59d19">delete_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  get the node ref</span></div>
<div class="line"><span class="preprocessor"></span>    my $node_ref = $self-&gt;get_node_ref (node =&gt; $args{node});</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! defined $node_ref;  #  node does not exist anyway</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Clear any cached values.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  We could just do the DESCENDENTS lists, but they are not the</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  only ones that point to now non-existent nodes.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  This also circumvents circular refs from the caches.</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;get_tree_ref-&gt;delete_cached_values_below;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  get the names of all descendents </span></div>
<div class="line"><span class="preprocessor"></span>    my %node_hash = $node_ref-&gt;get_all_descendents;</div>
<div class="line">    $node_hash{$node_ref-&gt;get_name} = $node_ref;  #  add node_ref to <span class="keyword">this</span> list</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we delete it from the treenode structure.  This cleans up any children in the tree.</span></div>
<div class="line"><span class="preprocessor"></span>    $node_ref-&gt;get_parent-&gt;delete_child (child =&gt; $node_ref);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we delete it and its descendents from the node hash</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;delete_from_node_hash (nodes =&gt; \%node_hash);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  return a list of the names of those deleted nodes</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span> wantarray ? keys %node_hash : [keys %node_hash];</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a52412801f941e70b588363d1b89e907e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::describe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-describe' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-describe-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-describe-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-describe-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in describe: 47</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a52412801f941e70b588363d1b89e907e">describe</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @description = (</div>
<div class="line">        [<span class="stringliteral">&#39;TYPE: &#39;</span>,</div>
<div class="line">         blessed $self,</div>
<div class="line">         ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my @keys = qw /</div>
<div class="line">        NAME</div>
<div class="line">    /;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $key (@keys) {</div>
<div class="line">        my $desc = $self-&gt;get_param ($key);</div>
<div class="line">        <span class="keywordflow">if</span> ((ref $desc) =~ /ARRAY/) {</div>
<div class="line">            $desc = join q{, }, @$desc;</div>
<div class="line">        }</div>
<div class="line">        push @description, [<span class="stringliteral">&quot;$key: &quot;</span>, $desc];</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    push @description, [</div>
<div class="line">        <span class="stringliteral">&quot;Node count: &quot;</span>,</div>
<div class="line">        scalar @{$self-&gt;get_node_refs},</div>
<div class="line">    ];</div>
<div class="line">    push @description, [</div>
<div class="line">        <span class="stringliteral">&quot;Terminal node count: &quot;</span>,</div>
<div class="line">        scalar @{$self-&gt;get_terminal_node_refs},</div>
<div class="line">    ];</div>
<div class="line">    push @description, [</div>
<div class="line">        <span class="stringliteral">&quot;Root node count: &quot;</span>,</div>
<div class="line">        scalar @{$self-&gt;get_root_node_refs}</div>
<div class="line">    ];</div>
<div class="line"></div>
<div class="line">    push @description, [</div>
<div class="line">        <span class="stringliteral">&quot;Sum of branch lengths: &quot;</span>,</div>
<div class="line">        sprintf <span class="stringliteral">&quot;%.4f&quot;</span>, $self-&gt;get_total_tree_length</div>
<div class="line">    ];</div>
<div class="line"></div>
<div class="line">    my $description;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $row (@description) {</div>
<div class="line">        $description .= join <span class="stringliteral">&quot;\t&quot;</span>, @$row;</div>
<div class="line">        $description .= <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @description : $description;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a83b3ed75a7f6264bc88fb52955ccd1d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::DESTROY </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-DESTROY' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-DESTROY-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-DESTROY-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-DESTROY-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in DESTROY: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a83b3ed75a7f6264bc88fb52955ccd1d1">DESTROY</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    $self-&gt;delete_cached_values;       #  clear the cache</div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;{TREE_BY_NAME}) {</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node ($self-&gt;get_node_refs) {</div>
<div class="line">            next <span class="keywordflow">if</span> !defined $node;</div>
<div class="line">            $node-&gt;delete_cached_values;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my $name = $self-&gt;get_param (&#39;NAME&#39;);</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;DELETING $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;set_param (BASEDATA_REF =&gt; undef);  #  clear the ref to the parent basedata <span class="keywordtype">object</span></div>
<div class="line">    </div>
<div class="line">    $self-&gt;{TREE} = undef;  # empty the ref to the tree</div>
<div class="line">    $self-&gt;{TREE_BY_NAME} = undef;  #  empty the list of nodes</div>
<div class="line"><span class="preprocessor">    #print &quot;DELETED $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac871d5a0b9f0ec7bbfda74f23507e77d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::exists_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-exists_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-exists_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-exists_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-exists_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in exists_node: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac871d5a0b9f0ec7bbfda74f23507e77d">exists_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $name = $args{name};</div>
<div class="line">    <span class="keywordflow">if</span> (not defined $name) {</div>
<div class="line">        <span class="keywordflow">if</span> (defined $args{node_ref}) {</div>
<div class="line">            $name = $args{node_ref}-&gt;get_name;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">return</span>;  #  should we croak instead?  </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> exists $self-&gt;{TREE_BY_NAME}{$name};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a855c4870813c037883a29bdd4a6466f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a855c4870813c037883a29bdd4a6466f0">export</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;[TREE] Export:  Argument &#39;file&#39; not specified or null\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> not defined $args{file}</div>
<div class="line">            || length ($args{file}) == 0;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  get our own metadata...</span></div>
<div class="line"><span class="preprocessor"></span>    my %metadata = $self-&gt;get_args (sub =&gt; <span class="stringliteral">&#39;export&#39;</span>);</div>
<div class="line"></div>
<div class="line">    my $sub_to_use = $metadata{format_labels}{$args{format}}</div>
<div class="line">      || croak <span class="stringliteral">&quot;Argument &#39;format&#39; not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  remap the format name if needed - part of the matrices kludge</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($metadata{component_map}{$args{format}}) {</div>
<div class="line">        $args{format} = $metadata{component_map}{$args{format}};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    eval {</div>
<div class="line">        $self-&gt;$sub_to_use (%args)</div>
<div class="line">    };</div>
<div class="line">    croak $EVAL_ERROR <span class="keywordflow">if</span> $EVAL_ERROR;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9c708967749e36b64c163e9d03572ed8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export_newick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_newick' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export_newick-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_newick-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_newick-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export_newick: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a9c708967749e36b64c163e9d03572ed8">export_newick</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $file = $args{file};</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] WRITING TO TREE TO NEWICK FILE $file\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    open (my $fh, <span class="charliteral">&#39;&gt;&#39;</span>, $file) || croak <span class="stringliteral">&quot;Could not open file &#39;$file&#39; for writing\n&quot;</span>;</div>
<div class="line">    print {$fh} $self-&gt;to_newick (%args);</div>
<div class="line">    $fh-&gt;close;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a35d256b9520fbd573bdad8d4f39fcda6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export_nexus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_nexus' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export_nexus-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_nexus-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_nexus-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export_nexus: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a35d256b9520fbd573bdad8d4f39fcda6">export_nexus</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $file = $args{file};</div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] WRITING TO TREE TO NEXUS FILE $file\n&quot;</span>;</div>
<div class="line">    open (my $fh, <span class="charliteral">&#39;&gt;&#39;</span>, $file)</div>
<div class="line">        || croak <span class="stringliteral">&quot;Could not open file &#39;$file&#39; for writing\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    print {$fh}</div>
<div class="line">        $self-&gt;to_nexus (</div>
<div class="line">            tree_name =&gt; $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>),</div>
<div class="line">            %args,</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">    $fh-&gt;close;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ace607d006bc6fd264a0349d7640a9c4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export_range_table </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_range_table' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export_range_table-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_range_table-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_range_table-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export_range_table: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ace607d006bc6fd264a0349d7640a9c4e">export_range_table</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $file = $args{file};</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] WRITING TREE RANGE TABLE, FILE $file\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $data = eval {</div>
<div class="line">        $self-&gt;get_range_table (</div>
<div class="line">            name =&gt; $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>),</div>
<div class="line">            @_,</div>
<div class="line">        )</div>
<div class="line">    };</div>
<div class="line">    croak $EVAL_ERROR <span class="keywordflow">if</span> $EVAL_ERROR;</div>
<div class="line"></div>
<div class="line">    $self-&gt;write_table (</div>
<div class="line">        %args,</div>
<div class="line">        file =&gt; $file,</div>
<div class="line">        data =&gt; $data,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8c452994d1e5ceaefeafb24daa73244c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export_table_grouped </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_table_grouped' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export_table_grouped-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_table_grouped-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_table_grouped-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export_table_grouped: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a8c452994d1e5ceaefeafb24daa73244c">export_table_grouped</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $file = $args{file};</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] WRITING TO TREE TO TABLE STRUCTURE USING TERMINAL ELEMENTS, FILE $file\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $data = $self-&gt;to_table_group_nodes (@_);</div>
<div class="line"></div>
<div class="line">    $self-&gt;write_table (</div>
<div class="line">        %args,</div>
<div class="line">        file =&gt; $file,</div>
<div class="line">        data =&gt; $data</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6d84505757b700cee52c0bc7963a9a15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::export_tabular_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-export_tabular_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-export_tabular_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-export_tabular_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-export_tabular_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in export_tabular_tree: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a6d84505757b700cee52c0bc7963a9a15">export_tabular_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $name = $args{name};</div>
<div class="line">    <span class="keywordflow">if</span> (! defined $name) {</div>
<div class="line">        $name = $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $table = $self-&gt;to_table (</div>
<div class="line">        symmetric   =&gt; 1,</div>
<div class="line">        name        =&gt; $name,</div>
<div class="line">        %args,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    $self-&gt;write_table_csv (%args, data =&gt; $table);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aeb9583b65614cbb1d9911b81bda8a81b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::find_list_indices_across_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-find_list_indices_across_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-find_list_indices_across_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-find_list_indices_across_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-find_list_indices_across_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in find_list_indices_across_nodes: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#aeb9583b65614cbb1d9911b81bda8a81b">find_list_indices_across_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my @lists = $self-&gt;get_hash_lists_below;</div>
<div class="line"></div>
<div class="line">    my $bd = $self-&gt;get_param (<span class="stringliteral">&#39;BASEDATA_REF&#39;</span>);</div>
<div class="line">    my $indices_object = <a class="code" href="classBiodiverse_1_1Indices.html">Biodiverse::Indices</a>-&gt;<a class="code" href="classBiodiverse_1_1Indices.html#a9b653e2cf5ae1ebc02b930dabae47779">new</a>(BASEDATA_REF =&gt; $bd);</div>
<div class="line"></div>
<div class="line">    my %calculations_by_index = $indices_object-&gt;get_index_source_hash;</div>
<div class="line"></div>
<div class="line">    my %index_hash;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  loop over the lists and find those that are generated by a calculation</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  This ensures we get all of them if subsets are used.</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $list_name (@lists) {</div>
<div class="line">        <span class="keywordflow">if</span> (exists $calculations_by_index{$list_name}) {</div>
<div class="line">            $index_hash{$list_name} = $list_name;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %index_hash : \%index_hash;    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a0e6aea1c26db724541c0e5c8066618ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_branch_node_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_branch_node_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_branch_node_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_branch_node_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_branch_node_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_branch_node_refs: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a0e6aea1c26db724541c0e5c8066618ed">get_branch_node_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my @nodeList;</div>
<div class="line">    <span class="keywordflow">while</span> ((my $node, my $nodeRef) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line">        next <span class="keywordflow">if</span> $nodeRef-&gt;is_terminal_node;</div>
<div class="line">        push @nodeList, $nodeRef;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @nodeList : \@nodeList;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8102174908f6e30d6fd88c5d0ec09cfe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_branch_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_branch_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_branch_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_branch_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_branch_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_branch_nodes: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a8102174908f6e30d6fd88c5d0ec09cfe">get_branch_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %node_list;</div>
<div class="line">    my $node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    <span class="keywordflow">while</span> (my ($node, $node_ref) = each (%$node_hash)) {</div>
<div class="line">        next <span class="keywordflow">if</span> $node_ref-&gt;is_terminal_node;</div>
<div class="line">        $node_list{$node} = $node_ref;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %node_list : \%node_list;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abaec80d380581dcad90c96e56e36b3a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_free_internal_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_free_internal_name' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_free_internal_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_free_internal_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_free_internal_name-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_free_internal_name: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#abaec80d380581dcad90c96e56e36b3a2">get_free_internal_name</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $skip = $args{exclude} || {};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  iterate over the existing nodes and get the highest internal name that isn&#39;t used</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  also check the whole translate table (keys and values) to ensure no</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    overlaps with valid user defined names</span></div>
<div class="line"><span class="preprocessor"></span>    my %node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    my $highest = -1;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $name (keys %node_hash, %$skip) {  #  should be keys %$skip?</div>
<div class="line">        <span class="keywordflow">if</span> ($name =~ /^(\d+)___$/) {</div>
<div class="line">            my $num = $1;</div>
<div class="line">            next <span class="keywordflow">if</span> not defined $num;</div>
<div class="line">            $highest = $num <span class="keywordflow">if</span> $num &gt; $highest;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    $highest ++;</div>
<div class="line">    <span class="keywordflow">return</span> $highest . <span class="stringliteral">&#39;___&#39;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa57a2c23c0eb60cf4c3d81df41d8819a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_last_shared_ancestor_for_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_last_shared_ancestor_for_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_last_shared_ancestor_for_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_last_shared_ancestor_for_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_last_shared_ancestor_for_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_last_shared_ancestor_for_nodes: 43</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#aa57a2c23c0eb60cf4c3d81df41d8819a">get_last_shared_ancestor_for_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my @node_names = keys %{$args{node_names}};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> !scalar @node_names;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my $node = $self-&gt;get_root_node;</span></div>
<div class="line"><span class="preprocessor"></span>    my $first_name = shift @node_names;</div>
<div class="line">    my $first_node = $self-&gt;get_node_ref (node =&gt; $first_name);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $first_node <span class="keywordflow">if</span> !scalar @node_names;</div>
<div class="line"></div>
<div class="line">    my @reference_path = $first_node-&gt;get_path_to_root_node;</div>
<div class="line">    </div>
<div class="line">  PATH:</div>
<div class="line">    <span class="keywordflow">while</span> (my $node_name = shift @node_names) {</div>
<div class="line">        last PATH <span class="keywordflow">if</span> scalar @reference_path == 1;   #  must be just the root node left, so drop out</div>
<div class="line"></div>
<div class="line">        my $node_ref = $self-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line">        my @path = $node_ref-&gt;get_path_to_root_node;</div>
<div class="line"></div>
<div class="line">      PATH_NODE_REF:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $path_node_ref (@path) {</div>
<div class="line"><span class="preprocessor">            #my $node_name_path = $path_node_ref-&gt;get_name; #  for debug</span></div>
<div class="line"><span class="preprocessor"></span>            my $idx = first_index { $_ eq $path_node_ref } @reference_path;</div>
<div class="line"></div>
<div class="line">            next PATH_NODE_REF <span class="keywordflow">if</span> $idx &lt; 0;  #  not in path, <span class="keywordflow">try</span> the next node</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> ($idx) {</div>
<div class="line"><span class="preprocessor">                #  reduce length of reference_path to reduce comparisons in next iter</span></div>
<div class="line"><span class="preprocessor"></span>                splice @reference_path, 0, $idx;</div>
<div class="line">            }</div>
<div class="line">            next PATH;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $node = $reference_path[0];</div>
<div class="line">    my $ancestor_name = $node-&gt;get_name;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $node;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a77dc1fe009ceccba2694c19efe3359c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_length_to_tip </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_length_to_tip' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_length_to_tip-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_length_to_tip-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_length_to_tip-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_length_to_tip: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a77dc1fe009ceccba2694c19efe3359c4">get_length_to_tip</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_tree_length;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a63d1104b6d02d393c0f458cc41eccdac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_list_stats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_list_stats' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_list_stats-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_list_stats-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_list_stats-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_list_stats: 45</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a63d1104b6d02d393c0f458cc41eccdac">get_list_stats</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{list}   || croak <span class="stringliteral">&quot;List not specified\n&quot;</span>;</div>
<div class="line">    my $index = $args{index} || croak <span class="stringliteral">&quot;Index not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my @data;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node (values %{$self-&gt;get_node_hash}) {</div>
<div class="line">        my $list_ref = $node-&gt;get_list_ref (list =&gt; $list);</div>
<div class="line">        next <span class="keywordflow">if</span> ! defined $list_ref;</div>
<div class="line">        next <span class="keywordflow">if</span> ! exists  $list_ref-&gt;{$index};</div>
<div class="line">        next <span class="keywordflow">if</span> ! defined $list_ref-&gt;{$index};  #  skip undef values</div>
<div class="line"></div>
<div class="line">        push @data, $list_ref-&gt;{$index};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %stats_hash = (</div>
<div class="line">        MAX  =&gt; undef,</div>
<div class="line">        MIN  =&gt; undef,</div>
<div class="line">        MEAN =&gt; undef,</div>
<div class="line">        SD   =&gt; undef,</div>
<div class="line">        PCT025 =&gt; undef,</div>
<div class="line">        PCT975 =&gt; undef,</div>
<div class="line">        PCT05  =&gt; undef,</div>
<div class="line">        PCT95  =&gt; undef,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (scalar @data) {  #  don<span class="stringliteral">&#39;t bother if they are all undef</span></div>
<div class="line"><span class="stringliteral">        my $stats = $stats_class-&gt;new;</span></div>
<div class="line"><span class="stringliteral">        $stats-&gt;add_data (\@data);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        %stats_hash = (</span></div>
<div class="line"><span class="stringliteral">            MAX  =&gt; $stats-&gt;max,</span></div>
<div class="line"><span class="stringliteral">            MIN  =&gt; $stats-&gt;min,</span></div>
<div class="line"><span class="stringliteral">            MEAN =&gt; $stats-&gt;mean,</span></div>
<div class="line"><span class="stringliteral">            SD   =&gt; $stats-&gt;standard_deviation,</span></div>
<div class="line"><span class="stringliteral">            PCT025 =&gt; scalar $stats-&gt;percentile (2.5),</span></div>
<div class="line"><span class="stringliteral">            PCT975 =&gt; scalar $stats-&gt;percentile (97.5),</span></div>
<div class="line"><span class="stringliteral">            PCT05  =&gt; scalar $stats-&gt;percentile (5),</span></div>
<div class="line"><span class="stringliteral">            PCT95  =&gt; scalar $stats-&gt;percentile (95),</span></div>
<div class="line"><span class="stringliteral">        );</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    return wantarray ? %stats_hash : \%stats_hash;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab9e894d100d79083299c9fd05ada4433"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_lists_export_metadata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_lists_export_metadata' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_lists_export_metadata-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_lists_export_metadata-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_lists_export_metadata-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_lists_export_metadata: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ab9e894d100d79083299c9fd05ada4433">get_lists_export_metadata</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @lists = $self-&gt;get_lists_for_export;</div>
<div class="line"></div>
<div class="line">    my $metadata = [</div>
<div class="line">        {</div>
<div class="line">            name        =&gt; <span class="stringliteral">&#39;sub_list&#39;</span>,</div>
<div class="line">            label_text  =&gt; <span class="stringliteral">&#39;List to export&#39;</span>,</div>
<div class="line">            type        =&gt; <span class="stringliteral">&#39;choice&#39;</span>,</div>
<div class="line">            choices     =&gt; \@lists,</div>
<div class="line">            <span class="keywordflow">default</span>     =&gt; 0</div>
<div class="line">        }</div>
<div class="line">    ];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @$metadata : $metadata;    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4cda3395505daa9181be4c9145b96bcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_lists_for_export </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_lists_for_export' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_lists_for_export-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_lists_for_export-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_lists_for_export-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_lists_for_export: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a4cda3395505daa9181be4c9145b96bcf">get_lists_for_export</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @sub_list;  #  <span class="keyword">get</span> a list of available sub_lists (these are actually hashes)</div>
<div class="line">    <span class="preprocessor">#foreach my $list (sort $self-&gt;get_hash_lists) {</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $list (sort $self-&gt;get_list_names_below) {  #  <span class="keyword">get</span> all lists</div>
<div class="line">        <span class="keywordflow">if</span> ($list eq <span class="stringliteral">&#39;SPATIAL_RESULTS&#39;</span>) {</div>
<div class="line">            unshift @sub_list, $list;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            push @sub_list, $list;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    unshift @sub_list, <span class="stringliteral">&#39;(no list)&#39;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @sub_list : \@sub_list;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a69a6cc6e68fc7839d82d48357c467a34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_max_total_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_max_total_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_max_total_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_max_total_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_max_total_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_max_total_length: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a69a6cc6e68fc7839d82d48357c467a34">get_max_total_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @lengths = reverse sort <a class="code" href="classBiodiverse_1_1Tree.html#ac1e795779a11c3ea32cb0a1982941325">numerically</a> keys %{$self-&gt;get_node_hash_by_total_length};</div>
<div class="line">    <span class="keywordflow">return</span> $lengths[0];</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a64a66c9e50eff509c161c1f545db0a2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export: 72</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a64a66c9e50eff509c161c1f545db0a2f">get_metadata_export</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  get the available lists</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my @lists = $self-&gt;get_lists_for_export;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #  need a list of export subs</span></div>
<div class="line"><span class="preprocessor"></span>    my %subs = $self-&gt;get_subs_with_prefix (prefix =&gt; <span class="stringliteral">&#39;export_&#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  (not anymore)</span></div>
<div class="line"><span class="preprocessor"></span>    my @formats;</div>
<div class="line">    my %format_labels;  #  track sub names by format label</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  loop through subs and get their metadata</span></div>
<div class="line"><span class="preprocessor"></span>    my %params_per_sub;</div>
<div class="line">    my %component_map;</div>
<div class="line"></div>
<div class="line">    LOOP_EXPORT_SUB:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $sub (sort keys %subs) {</div>
<div class="line">        my %sub_args = $self-&gt;get_args (sub =&gt; $sub);</div>
<div class="line"></div>
<div class="line">        my $format = $sub_args{format};</div>
<div class="line"></div>
<div class="line">        croak <span class="stringliteral">&quot;Metadata item &#39;format&#39; missing\n&quot;</span></div>
<div class="line">          <span class="keywordflow">if</span> not defined $format;</div>
<div class="line"></div>
<div class="line">        $format_labels{$format} = $sub;</div>
<div class="line"></div>
<div class="line">        next LOOP_EXPORT_SUB</div>
<div class="line">          <span class="keywordflow">if</span> $sub_args{format} eq $EMPTY_STRING;</div>
<div class="line"></div>
<div class="line">        my $params_array = $sub_args{parameters};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  Need to raise the matrices args</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  This is extremely kludgy as it assumes there is only one</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  output format for matrices</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ((ref $params_array) =~ /HASH/) {</div>
<div class="line">            my @values = values %$params_array;</div>
<div class="line">            my @keys   = keys   %$params_array;</div>
<div class="line"></div>
<div class="line">            $component_map{$format} = shift @keys;</div>
<div class="line">            $params_array = shift @values;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $params_per_sub{$format} = $params_array;</div>
<div class="line"></div>
<div class="line">        push @formats, $format;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    @formats = sort @formats;</div>
<div class="line">    $self-&gt;move_to_front_of_list (</div>
<div class="line">        list =&gt; \@formats,</div>
<div class="line">        item =&gt; <span class="stringliteral">&#39;Nexus&#39;</span></div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        parameters     =&gt; \%params_per_sub,</div>
<div class="line">        format_choices =&gt; [</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;format&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Format to use&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;choice&#39;</span>,</div>
<div class="line">                choices     =&gt; \@formats,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0</div>
<div class="line">            },</div>
<div class="line">        ],</div>
<div class="line">        format_labels  =&gt; \%format_labels,</div>
<div class="line">        component_map  =&gt; \%component_map,</div>
<div class="line">    ); </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5488d868f993bdc0ae5f7e22c7b9b61a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export_newick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export_newick' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export_newick-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export_newick-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export_newick-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export_newick: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a5488d868f993bdc0ae5f7e22c7b9b61a">get_metadata_export_newick</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        format =&gt; <span class="stringliteral">&#39;Newick&#39;</span>,</div>
<div class="line">        parameters =&gt; [</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;use_internal_names&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Label internal nodes&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Should the internal node labels be included?&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">        ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4a788a961c6e9648d04fdc1f2ba6a936"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export_nexus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export_nexus' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export_nexus-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export_nexus-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export_nexus-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export_nexus: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a4a788a961c6e9648d04fdc1f2ba6a936">get_metadata_export_nexus</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        format =&gt; <span class="stringliteral">&#39;Nexus&#39;</span>,</div>
<div class="line">        parameters =&gt; [</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;use_internal_names&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Label internal nodes&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Should the internal node labels be included?&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">        ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a54b94f0bb41dc4dcd8599cbd4c724c3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export_range_table </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export_range_table' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export_range_table-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export_range_table-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export_range_table-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export_range_table: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a54b94f0bb41dc4dcd8599cbd4c724c3e">get_metadata_export_range_table</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $bd = $args{basedata_ref} || $self-&gt;get_param (<span class="stringliteral">&#39;BASEDATA_REF&#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  hide from GUI if no $bd</span></div>
<div class="line"><span class="preprocessor"></span>    my $format = defined $bd ? <span class="stringliteral">&#39;Range table&#39;</span> : $EMPTY_STRING;</div>
<div class="line">    $format = $EMPTY_STRING; # no, just hide from GUI <span class="keywordflow">for</span> now</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        format =&gt; $format,</div>
<div class="line">        parameters =&gt; [</div>
<div class="line">            $self-&gt;get_table_export_metadata()</div>
<div class="line">        ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a014bc51e8ab0bced6ff6f33e039c4f26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export_table_grouped </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export_table_grouped' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export_table_grouped-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export_table_grouped-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export_table_grouped-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export_table_grouped: 74</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a014bc51e8ab0bced6ff6f33e039c4f26">get_metadata_export_table_grouped</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        format =&gt; <span class="stringliteral">&#39;Table grouped&#39;</span>,</div>
<div class="line">        parameters =&gt; [</div>
<div class="line">            $self-&gt;get_lists_export_metadata(),</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;num_clusters&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Number of groups&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;integer&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 5</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;use_target_value&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&quot;Set number of groups\nusing a cutoff value&quot;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Overrides the &quot;Number of groups&quot; setting.  Uses length by default.&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;target_value&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Value for cutoff&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Group the nodes using some threshold value.  &#39;</span></div>
<div class="line">                             . <span class="stringliteral">&#39;This is analogous to the grouping when using &#39;</span></div>
<div class="line">                             . <span class="stringliteral">&#39;the slider bar on the dendrogram plots.&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;float&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;group_by_depth&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&quot;Group clusters by depth\n(default is by length)&quot;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Use depth to define the groupings.  When a cutoff is used, it will be in units of node depth.&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;symmetric&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Force output table to be symmetric&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;one_value_per_line&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;One value per line&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Sparse matrix format&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;include_node_data&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&quot;Include node data\n(child counts etc)&quot;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;sort_array_lists&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Sort array lists&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Should any array list results be sorted before exprting?  Turn this off if the original order is important.&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;terminals_only&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Export data for terminal nodes only&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            $self-&gt;get_table_export_metadata(),</div>
<div class="line">        ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6994a68f467d3d2f9e7c0c4c217355e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_metadata_export_tabular_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_export_tabular_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_export_tabular_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_export_tabular_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_export_tabular_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_export_tabular_tree: 34</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a6994a68f467d3d2f9e7c0c4c217355e4">get_metadata_export_tabular_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        format =&gt; <span class="stringliteral">&#39;Tabular tree&#39;</span>,</div>
<div class="line">        parameters =&gt; [</div>
<div class="line">            $self-&gt;get_lists_export_metadata(),</div>
<div class="line">            $self-&gt;get_table_export_metadata(),</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;include_plot_coords&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Add plot coords&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Allows the subsequent creation of, for example, shapefile versions of the dendrogram&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;plot_coords_scale_factor&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Plot coords scale factor&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Scales the y-axis to fit the x-axis.  Leave as 0 for default (equalises axes)&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;float&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">                name        =&gt; <span class="stringliteral">&#39;plot_coords_left_to_right&#39;</span>,</div>
<div class="line">                label_text  =&gt; <span class="stringliteral">&#39;Plot tree from left to right&#39;</span>,</div>
<div class="line">                tooltip     =&gt; <span class="stringliteral">&#39;Leave off for default (plots as per labels and cluster tabs, root node at right, tips at left)&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;boolean&#39;</span>,</div>
<div class="line">                <span class="keywordflow">default</span>     =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">        ],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8c4b471e18296bb30a26558f0f4ba49d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_named_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_named_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_named_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_named_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_named_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_named_nodes: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a8c4b471e18296bb30a26558f0f4ba49d">get_named_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %node_list;</div>
<div class="line">    my $node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    <span class="keywordflow">while</span> (my ($node, $node_ref) = each (%$node_hash)) {</div>
<div class="line">        next <span class="keywordflow">if</span> $node_ref-&gt;is_internal_node;</div>
<div class="line">        $node_list{$node} = $node_ref;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %node_list : \%node_list;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a765e8f89fe7999881bfa336b1fac7a43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_count: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a765e8f89fe7999881bfa336b1fac7a43">get_node_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> my $tmp = keys %{$self-&gt;get_node_hash};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a97c51d82228e4219c3167129bb6c08bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_hash: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a97c51d82228e4219c3167129bb6c08bb">get_node_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  create an empty hash if needed</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;{TREE_BY_NAME} = {} <span class="keywordflow">if</span> ! exists $self-&gt;{TREE_BY_NAME};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %{$self-&gt;{TREE_BY_NAME}} : $self-&gt;{TREE_BY_NAME};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae1137610fd272f0c34d4b431fc460a6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_hash_by_depth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_hash_by_depth' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_hash_by_depth-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_hash_by_depth-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_hash_by_depth-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_hash_by_depth: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae1137610fd272f0c34d4b431fc460a6d">get_node_hash_by_depth</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %by_value;</div>
<div class="line">    <span class="keywordflow">while</span> ((my $node_name, my $node_ref) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line">        my $depth = $node_ref-&gt;get_depth;</div>
<div class="line">        $by_value{$depth}{$node_name} = $node_ref;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %by_value : \%by_value;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a19a5f2a93f953c655729baa000565bfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_hash_by_depth_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_hash_by_depth_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_hash_by_depth_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_hash_by_depth_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_hash_by_depth_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_hash_by_depth_below: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a19a5f2a93f953c655729baa000565bfc">get_node_hash_by_depth_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %by_value;</div>
<div class="line">    <span class="keywordflow">while</span> ((my $node_name, my $node_ref) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line">        my $depth = $node_ref-&gt;get_depth_below;</div>
<div class="line">        $by_value{$depth}{$node_name} = $node_ref;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %by_value : \%by_value;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af3eea5eb7a4d34650676277d9c073e32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_hash_by_total_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_hash_by_total_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_hash_by_total_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_hash_by_total_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_hash_by_total_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_hash_by_total_length: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#af3eea5eb7a4d34650676277d9c073e32">get_node_hash_by_total_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %by_value;</div>
<div class="line">    <span class="keywordflow">while</span> ((my $node_name, my $node_ref) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line"><span class="preprocessor">        #  uses total_length param if exists</span></div>
<div class="line"><span class="preprocessor"></span>        my $value = $node_ref-&gt;get_length_below;  </div>
<div class="line">        $by_value{$value}{$node_name} = $node_ref;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %by_value : \%by_value;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a42b363d731983b96c9c8280bb5cf2689"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_ref' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_ref-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_ref-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_ref-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_ref: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a42b363d731983b96c9c8280bb5cf2689">get_node_ref</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    croak <span class="stringliteral">&quot;node not specified\n&quot;</span> <span class="keywordflow">if</span> ! defined $args{node};</div>
<div class="line"></div>
<div class="line">    Biodiverse::Tree::NotExistsNode-&gt;throw (<span class="stringliteral">&quot;[Tree] $args{node} does not exist&quot;</span>)</div>
<div class="line">      <span class="keywordflow">if</span> !exists $self-&gt;{TREE_BY_NAME}{$args{node}};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{TREE_BY_NAME}{$args{node}};    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae9a2543198b355ea4f103ef3ed3d3154"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_node_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_refs: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae9a2543198b355ea4f103ef3ed3d3154">get_node_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my @refs = values %{$self-&gt;get_node_hash};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @refs : \@refs;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac15bdbe722c14b241c01abf09490e95b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_range_table </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_range_table' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_range_table-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_range_table-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_range_table-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_range_table: 133</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac15bdbe722c14b241c01abf09490e95b">get_range_table</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"><span class="preprocessor">    #my $progress_bar = $args{progress};</span></div>
<div class="line"><span class="preprocessor"></span>    my $progress_bar = <a class="code" href="classBiodiverse_1_1Progress.html">Biodiverse::Progress</a>-&gt;<a class="code" href="classBiodiverse_1_1Progress.html#a88f4cef6f66986952a850fb70a2b62d8">new</a>();</div>
<div class="line"></div>
<div class="line">    my $use_internal = $args{use_internal};  #  ignores them by <span class="keywordflow">default</span></div>
<div class="line"></div>
<div class="line">    my $name = $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  gets the ranges from the basedata</span></div>
<div class="line"><span class="preprocessor"></span>    my $bd = $args{basedata_ref} || $self-&gt;get_param (<span class="stringliteral">&#39;BASEDATA_REF&#39;</span>);</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Tree has no attached BaseData object, cannot generate range table\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> not defined $bd;</div>
<div class="line"></div>
<div class="line">    my %nodes = $self-&gt;get_node_hash;  #  make sure we work on a copy</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (! $use_internal) {  #  strip out the <span class="keyword">internal</span> nodes</div>
<div class="line">        <span class="keywordflow">while</span> (my ($name1, $node1) = each %nodes) {</div>
<div class="line">            <span class="keywordflow">if</span> ($node1-&gt;is_internal_node) {</div>
<div class="line">                <span class="keyword">delete</span> $nodes{$name1};</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @results = [</div>
<div class="line">        qw /Node1</div>
<div class="line">            Node2</div>
<div class="line">            Length1</div>
<div class="line">            Length2</div>
<div class="line">            P_dist</div>
<div class="line">            Range1</div>
<div class="line">            Range2</div>
<div class="line">            Rel_range</div>
<div class="line">            Range_shared</div>
<div class="line">            Rel_shared</div>
<div class="line">        /</div>
<div class="line">    ];</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #declare progress tracking variables</span></div>
<div class="line"><span class="preprocessor"></span>    my (%done, $progress, $progress_percent);</div>
<div class="line">    my $to_do = scalar keys %nodes;</div>
<div class="line">    my $printed_progress = 0;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # progress feedback to text window</span></div>
<div class="line"><span class="preprocessor"></span>    print <span class="stringliteral">&quot;[TREE] CREATING NODE RANGE TABLE FOR TREE: $name  &quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $node1 (values %nodes) {</div>
<div class="line">        my $name1 = $node1-&gt;get_name;</div>
<div class="line">        my $length1 = $node1-&gt;get_total_length;</div>
<div class="line"></div>
<div class="line">        my $range_elements1</div>
<div class="line">            = $bd-&gt;get_range_union (</div>
<div class="line">                labels =&gt; scalar $node1-&gt;get_terminal_elements</div>
<div class="line">        );</div>
<div class="line">        my $range1 = $node1-&gt;is_terminal_node</div>
<div class="line">            ? $bd-&gt;get_range (element =&gt; $name1)</div>
<div class="line">            : scalar @$range_elements1;  #  need to allow <span class="keywordflow">for</span> labels positioned higher on the tree</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # progress feedback for text window and GUI        </span></div>
<div class="line"><span class="preprocessor"></span>        $progress ++;</div>
<div class="line">        $progress_bar-&gt;update(</div>
<div class="line">            <span class="stringliteral">&quot;Converting tree $name to matrix\n&quot;</span></div>
<div class="line">            . <span class="stringliteral">&quot;($progress / $to_do)&quot;</span>,</div>
<div class="line">            $progress / $to_do,</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        LOOP_NODE2:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node2 (values %nodes) {</div>
<div class="line">            my $name2 = $node2-&gt;get_name;</div>
<div class="line"></div>
<div class="line">            next LOOP_NODE2 <span class="keywordflow">if</span> $done{$name1}{$name2} || $done{$name2}{$name1};</div>
<div class="line"></div>
<div class="line">            my $length2 = $node2-&gt;get_total_length;</div>
<div class="line">            my $range_elements2 = $bd-&gt;get_range_union (labels =&gt; scalar $node2-&gt;get_terminal_elements);</div>
<div class="line">            my $range2 = $node1-&gt;is_terminal_node</div>
<div class="line">                ? $bd-&gt;get_range (element =&gt; $name2)</div>
<div class="line">                : scalar @$range_elements2;</div>
<div class="line"></div>
<div class="line">            my $shared_ancestor = $node1-&gt;get_shared_ancestor (node =&gt; $node2);</div>
<div class="line">            my $length_ancestor = $shared_ancestor-&gt;get_length;  #  need to exclude length of ancestor itself</div>
<div class="line">            my $length1_to_ancestor = $node1-&gt;get_length_above (target_ref =&gt; $shared_ancestor) - $length_ancestor;</div>
<div class="line">            my $length2_to_ancestor = $node2-&gt;get_length_above (target_ref =&gt; $shared_ancestor) - $length_ancestor;</div>
<div class="line">            my $length_sum = $length1_to_ancestor + $length2_to_ancestor;</div>
<div class="line"></div>
<div class="line">            my ($range_shared, $range_rel, $shared_rel);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ($range1 and $range2) { # only calculate range comparisons <span class="keywordflow">if</span> both nodes have a range &gt; 0</div>
<div class="line">                <span class="keywordflow">if</span> ($name1 eq $name2) { # <span class="keywordflow">if</span> the names are the same, the shared range is the whole range</div>
<div class="line">                    $range_shared = $range1;</div>
<div class="line">                    $range_rel = 1;</div>
<div class="line">                    $shared_rel = 1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="preprocessor">                    #calculate shared range    </span></div>
<div class="line"><span class="preprocessor"></span>                    my (%tmp1, %tmp2); </div>
<div class="line"><span class="preprocessor">                    #@tmp1{@$range_elements1} = @$range_elements1;</span></div>
<div class="line"><span class="preprocessor"></span>                    @tmp2{@$range_elements2} = @$range_elements2;</div>
<div class="line">                    <span class="keyword">delete</span> @tmp2{@$range_elements1};</div>
<div class="line">                    $range_shared = $range2 - scalar keys %tmp2;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">                    #calculate relative range</span></div>
<div class="line"><span class="preprocessor"></span>                    my $greater_range = $range1 &gt; $range2</div>
<div class="line">                        ? $range1</div>
<div class="line">                        : $range2;</div>
<div class="line">                    my $lesser_range = $range1 &gt; $range2</div>
<div class="line">                        ? $range2</div>
<div class="line">                        : $range1;             </div>
<div class="line">                    $range_rel = $lesser_range / $greater_range;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">                    #calculate relative shared range</span></div>
<div class="line"><span class="preprocessor"></span>                    $shared_rel = $range_shared / $lesser_range;</div>
<div class="line">                };</div>
<div class="line">            };</div>
<div class="line"></div>
<div class="line">            push @results, [</div>
<div class="line">                $name1,</div>
<div class="line">                $name2,</div>
<div class="line">                $length1_to_ancestor,</div>
<div class="line">                $length2_to_ancestor,</div>
<div class="line">                $length_sum,</div>
<div class="line">                $range1,</div>
<div class="line">                $range2,</div>
<div class="line">                $range_rel,</div>
<div class="line">                $range_shared,</div>
<div class="line">                $shared_rel</div>
<div class="line">            ];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @results : \@results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5b10fa4b330b635ef8a734c94b423861"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_root_node: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a5b10fa4b330b635ef8a734c94b423861">get_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %root_nodes = $self-&gt;get_root_nodes;</div>
<div class="line">    croak <span class="stringliteral">&quot;More than one root node\n&quot;</span> <span class="keywordflow">if</span> scalar keys %root_nodes &gt; 1;</div>
<div class="line"></div>
<div class="line">    my @refs = values %root_nodes;</div>
<div class="line">    my $root_node_ref = $refs[0];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %root_nodes : $root_node_ref;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac925f7a86358d8360cd7e111f4e83aad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_root_node_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_root_node_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_root_node_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_root_node_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_root_node_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_root_node_refs: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac925f7a86358d8360cd7e111f4e83aad">get_root_node_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @refs = values %{$self-&gt;get_root_nodes};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @refs : \@refs;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a61535a864f05fe2d59bc9e0270014935"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_root_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_root_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_root_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_root_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_root_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_root_nodes: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a61535a864f05fe2d59bc9e0270014935">get_root_nodes</a> {  #  <span class="keywordflow">if</span> there are several root nodes</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %nodeList;</div>
<div class="line">    my $node_hash = $self-&gt;get_node_hash;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> ((my $node, my $nodeRef) = each (%$node_hash)) {</div>
<div class="line">        next <span class="keywordflow">if</span> (! defined $nodeRef);</div>
<div class="line">        $nodeList{$node} = $nodeRef <span class="keywordflow">if</span> $nodeRef-&gt;is_root_node;</div>
<div class="line"><span class="preprocessor">        #my $check = $nodeRef-&gt;is_root_node;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #print &quot;&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %nodeList : \%nodeList;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5abc5187a00abaa2c8aac7158e381f26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_table_export_metadata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_table_export_metadata' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_table_export_metadata-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_table_export_metadata-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_table_export_metadata-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_table_export_metadata: 35</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a5abc5187a00abaa2c8aac7158e381f26">get_table_export_metadata</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @sep_chars</div>
<div class="line">        = defined $ENV{BIODIVERSE_FIELD_SEPARATORS}</div>
<div class="line">            ? @$ENV{BIODIVERSE_FIELD_SEPARATORS}</div>
<div class="line">            : (<span class="charliteral">&#39;,&#39;</span>, <span class="stringliteral">&#39;tab&#39;</span>, <span class="charliteral">&#39;;&#39;</span>, <span class="stringliteral">&#39;space&#39;</span>, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"></div>
<div class="line">    my @quote_chars = qw /<span class="stringliteral">&quot; &#39; + $/;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $table_metadata_defaults = [</span></div>
<div class="line"><span class="stringliteral">        {</span></div>
<div class="line"><span class="stringliteral">            name       =&gt; &#39;file&#39;,</span></div>
<div class="line"><span class="stringliteral">            type       =&gt; &#39;file&#39;</span></div>
<div class="line"><span class="stringliteral">        },</span></div>
<div class="line"><span class="stringliteral">        {</span></div>
<div class="line"><span class="stringliteral">            name       =&gt; &#39;sep_char&#39;,</span></div>
<div class="line"><span class="stringliteral">            label_text =&gt; &#39;Field separator&#39;,</span></div>
<div class="line"><span class="stringliteral">            tooltip    =&gt; &#39;Suggested options are comma for .csv files, tab for .txt files&#39;,</span></div>
<div class="line"><span class="stringliteral">            type       =&gt; &#39;choice&#39;,</span></div>
<div class="line"><span class="stringliteral">            choices    =&gt; \@sep_chars,</span></div>
<div class="line"><span class="stringliteral">            default    =&gt; 0</span></div>
<div class="line"><span class="stringliteral">        },</span></div>
<div class="line"><span class="stringliteral">        {</span></div>
<div class="line"><span class="stringliteral">            name       =&gt; &#39;quote_char&#39;,</span></div>
<div class="line"><span class="stringliteral">            label_text =&gt; &#39;Quote character&#39;,</span></div>
<div class="line"><span class="stringliteral">            #tooltip    =&gt; &#39;For delimited text exports only&#39;,</span></div>
<div class="line"><span class="stringliteral">            type       =&gt; &#39;choice&#39;,</span></div>
<div class="line"><span class="stringliteral">            choices    =&gt; \@quote_chars,</span></div>
<div class="line"><span class="stringliteral">            default    =&gt; 0</span></div>
<div class="line"><span class="stringliteral">        },</span></div>
<div class="line"><span class="stringliteral">     ];</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    return wantarray ? @$table_metadata_defaults : $table_metadata_defaults;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae0165c03955edf4460fce5671e24fce4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_terminal_element_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_element_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_element_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_element_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_element_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_element_count: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae0165c03955edf4460fce5671e24fce4">get_terminal_element_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);  #  cache by <span class="keywordflow">default</span></div>
<div class="line"></div>
<div class="line">    my $nodeRef;</div>
<div class="line">    <span class="keywordflow">if</span> (defined $args{node}) {</div>
<div class="line">        my $node = $args{node};</div>
<div class="line">        $nodeRef = $self-&gt;get_node_ref(node =&gt; $node);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        $nodeRef = $self-&gt;get_root_node;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  follow logic of get_terminal_elements, which returns a hash of</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  node if not a ref - good or bad idea?  Ever used?  </span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span> 1 <span class="keywordflow">if</span> !defined $nodeRef;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $nodeRef-&gt;get_terminal_element_count (cache =&gt; $args{cache});</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abe62f0e121cb4917f1cf35c333604094"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_terminal_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_elements' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_elements-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_elements-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_elements-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_elements: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#abe62f0e121cb4917f1cf35c333604094">get_terminal_elements</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);  #  cache by <span class="keywordflow">default</span></div>
<div class="line"></div>
<div class="line">    my $node = $args{node} || croak <span class="stringliteral">&quot;node not specified\n&quot;</span>;</div>
<div class="line">    my $nodeRef = $self-&gt;get_node_ref(node =&gt; $node);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $nodeRef-&gt;get_terminal_elements (cache =&gt; $args{cache})</div>
<div class="line">      <span class="keywordflow">if</span> defined $nodeRef;</div>
<div class="line"></div>
<div class="line">    my %hash = ($node =&gt; $nodeRef);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %hash : \%hash;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab0b6633049adbc557f4ded3b22d16cf0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_terminal_node_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_node_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_node_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_node_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_node_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_node_refs: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ab0b6633049adbc557f4ded3b22d16cf0">get_terminal_node_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my @nodeList;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> ((my $node, my $nodeRef) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! $nodeRef-&gt;is_terminal_node;</div>
<div class="line">        push @nodeList, $nodeRef;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @nodeList : \@nodeList;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6b2f33456a58711e7b7f1af3d28ac625"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_terminal_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_nodes: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a6b2f33456a58711e7b7f1af3d28ac625">get_terminal_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %nodeList;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> ((my $node, my $nodeRef) = each (%{$self-&gt;get_node_hash})) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! $nodeRef-&gt;is_terminal_node;</div>
<div class="line">        $nodeList{$node} = $nodeRef;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %nodeList : \%nodeList;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae0ccf313cd54e7617292e4b460397a80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_total_tree_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_total_tree_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_total_tree_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_total_tree_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_total_tree_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_total_tree_length: 22</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae0ccf313cd54e7617292e4b460397a80">get_total_tree_length</a> { #  calculate the total length of the tree</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $length;</div>
<div class="line">    my $node_length;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #check if length is already stored in tree object</span></div>
<div class="line"><span class="preprocessor"></span>    $length = $self-&gt;get_param(<span class="stringliteral">&#39;TOTAL_LENGTH&#39;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> $length <span class="keywordflow">if</span> (defined $length);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_ref (values %{$self-&gt;get_node_hash}) {</div>
<div class="line">        $node_length = $node_ref-&gt;get_length;</div>
<div class="line">        $length += $node_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  cache the result</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> (defined $length) {</div>
<div class="line">        $self-&gt;set_param (TOTAL_LENGTH =&gt; $length);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $length;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae3e988bfc5c6f12c5c46678427521df3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_tree_depth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_tree_depth' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_tree_depth-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_tree_depth-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_tree_depth-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_tree_depth: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae3e988bfc5c6f12c5c46678427521df3">get_tree_depth</a> {  #  traverse the tree and calculate the maximum depth</div>
<div class="line"><span class="preprocessor">                      #  need ref to the root node</span></div>
<div class="line"><span class="preprocessor"></span>    my $self = shift;</div>
<div class="line">    my $treeRef = $self-&gt;get_tree_ref;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! defined $treeRef ;</div>
<div class="line">    <span class="keywordflow">return</span> $treeRef-&gt;get_depth_below;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac7af879258c3caf1321c3efa2c29e6d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_tree_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_tree_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_tree_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_tree_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_tree_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_tree_length: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac7af879258c3caf1321c3efa2c29e6d2">get_tree_length</a> {  # need ref to the root node</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $tree_ref = $self-&gt;get_tree_ref;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! defined $tree_ref;</div>
<div class="line">    <span class="keywordflow">return</span> $tree_ref-&gt;get_length_below;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6437404b3ca199ec97733c9307051f80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_tree_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_tree_ref' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_tree_ref-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_tree_ref-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_tree_ref-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_tree_ref: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a6437404b3ca199ec97733c9307051f80">get_tree_ref</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">if</span> (! defined $self-&gt;{TREE}) {</div>
<div class="line">        my %root_nodes = $self-&gt;get_root_nodes;</div>
<div class="line">        my @keys = sort keys %root_nodes;</div>
<div class="line">        <span class="keywordflow">return</span> undef <span class="keywordflow">if</span> not defined $keys[0];  #  no tree ref yet</div>
<div class="line">        $self-&gt;{TREE} = $root_nodes{$keys[0]};</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{TREE};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac48efbb0e6fae004e7d9d3051ea8279c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::get_unique_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_unique_name' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_unique_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_unique_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_unique_name-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_unique_name: 22</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac48efbb0e6fae004e7d9d3051ea8279c">get_unique_name</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $prefix = $args{prefix};</div>
<div class="line">    my $suffix = $args{suffix} || q{__dup};</div>
<div class="line">    my $skip   = $args{exclude} || {};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  iterate over the existing nodes and see if we can geberate a unique name</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  also check the whole translate table (keys and values) to ensure no</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    overlaps with valid user defined names</span></div>
<div class="line"><span class="preprocessor"></span>    my %node_hash = $self-&gt;get_node_hash;</div>
<div class="line"></div>
<div class="line">    my $i = 1;</div>
<div class="line">    my $unique_name = $prefix . $suffix . $i;</div>
<div class="line">    my %exists = (%node_hash, %$skip);</div>
<div class="line">    <span class="keywordflow">while</span> (exists $exists{$unique_name}) {</div>
<div class="line">        $i++;</div>
<div class="line">        $unique_name = $prefix . $suffix . $i;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $unique_name;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9963e391cf6afb4d2198d60d5f9944bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::is_tree_object </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_tree_object' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_tree_object-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_tree_object-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_tree_object-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_tree_object: 3</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a9963e391cf6afb4d2198d60d5f9944bb">is_tree_object</a> {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a3594b5287b3f2e1f28130361541b2027"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-max' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-max-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-max-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-max-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in max: 1</span></div>
<div class="line"><span class="preprocessor">sub max {return $_[0] &lt; $_[1] ? $_[1] : $_[0]};</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af551d57c50ac5e4038e1ec4e1c815bfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::min </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-min' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-min-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-min-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-min-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in min: 1</span></div>
<div class="line"><span class="preprocessor">sub min {return $_[0] &gt; $_[1] ? $_[1] : $_[0]};</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7f0d728517492a2c984c5470f3a22c67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-new' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-new-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-new-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-new-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in new: 32</span></div>
<div class="line"><span class="preprocessor"></span>sub <span class="keyword">new</span> {</div>
<div class="line">    my $class = shift;</div>
<div class="line"></div>
<div class="line">    my $self = bless {}, $class;</div>
<div class="line"></div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # do we have a file to load from?</span></div>
<div class="line"><span class="preprocessor"></span>    my $file_loaded;</div>
<div class="line">    <span class="keywordflow">if</span> (defined $args{file}) {</div>
<div class="line">        $file_loaded = $self-&gt;load_file(@_);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $file_loaded <span class="keywordflow">if</span> defined $file_loaded;</div>
<div class="line"></div>
<div class="line">    my %PARAMS = (  #  <span class="keywordflow">default</span> params</div>
<div class="line">        TYPE =&gt; <span class="stringliteral">&#39;TREE&#39;</span>,</div>
<div class="line">        OUTSUFFIX =&gt; <span class="stringliteral">&#39;bts&#39;</span>,</div>
<div class="line">        OUTSUFFIX_YAML =&gt; <span class="stringliteral">&#39;bty&#39;</span>,</div>
<div class="line">        CACHE_TREE_AS_MATRIX =&gt; 1,</div>
<div class="line">    );</div>
<div class="line">    $self-&gt;set_params (%PARAMS, %args);</div>
<div class="line">    $self-&gt;set_default_params;  #  load any user overrides</div>
<div class="line"></div>
<div class="line">    $self-&gt;{TREE_BY_NAME} = {};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  avoid memory leak probs with circular refs to parents</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  ensures children are destroyed when parent is destroyed</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;weaken_basedata_ref;  </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae3c816a63a191f28c94375eafa22b547"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::node_is_in_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-node_is_in_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-node_is_in_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-node_is_in_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-node_is_in_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in node_is_in_tree: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae3c816a63a191f28c94375eafa22b547">node_is_in_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $node_name = $args{node};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  node cannot exist if it has no name...</span></div>
<div class="line"><span class="preprocessor"></span>    croak <span class="stringliteral">&quot;node name undefined\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> !defined $node_name;  </div>
<div class="line"></div>
<div class="line">    my $node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    <span class="keywordflow">return</span> exists $node_hash-&gt;{$node_name};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac1e795779a11c3ea32cb0a1982941325"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::numerically </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-numerically' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-numerically-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-numerically-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-numerically-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in numerically: 1</span></div>
<div class="line"><span class="preprocessor">sub numerically {$a &lt;=&gt; $b};</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a889a8e0744c3461e290b38ab71eccc80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::rename </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-rename' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-rename-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-rename-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-rename-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in rename: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a889a8e0744c3461e290b38ab71eccc80">rename</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $name = $args{new_name};</div>
<div class="line">    <span class="keywordflow">if</span> (not defined $name) {</div>
<div class="line">        croak <span class="stringliteral">&quot;[Tree] Argument &#39;name&#39; not defined\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  first tell the basedata object</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my $bd = $self-&gt;get_param (&#39;BASEDATA_REF&#39;);</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #$bd-&gt;rename_output (object =&gt; $self, new_name =&gt; $name);</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    # and now change ourselves    </span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;set_param (NAME =&gt; $name);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae191a462ea80da433e1ef3f2bc97ab86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::root_unrooted_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-root_unrooted_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-root_unrooted_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-root_unrooted_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-root_unrooted_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in root_unrooted_tree: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ae191a462ea80da433e1ef3f2bc97ab86">root_unrooted_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @root_nodes = $self-&gt;get_root_node_refs;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> scalar @root_nodes &lt;= 1;</div>
<div class="line"></div>
<div class="line">    my $name = $self-&gt;get_free_internal_name;</div>
<div class="line">    my $new_root_node = $self-&gt;add_node (length =&gt; 0, name =&gt; $name);</div>
<div class="line"></div>
<div class="line">    $new_root_node-&gt;add_children(children =&gt; \@root_nodes);</div>
<div class="line"></div>
<div class="line">    @root_nodes = $self-&gt;get_root_node_refs;</div>
<div class="line">    croak <span class="stringliteral">&quot;failure\n&quot;</span> <span class="keywordflow">if</span> scalar @root_nodes &gt; 1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab6bfd41d8c486324f48bfdcd102b894d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::set_parents_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_parents_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_parents_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_parents_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_parents_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_parents_below: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ab6bfd41d8c486324f48bfdcd102b894d">set_parents_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my @root_nodes = $self-&gt;get_root_node_refs;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $root_node ($self-&gt;get_root_node_refs) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! $root_node-&gt;is_root_node;  #  may have been fixed on a previous iteration, so skip it</div>
<div class="line">        $root_node-&gt;set_parents_below;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my @root_nodes2 = $self-&gt;get_root_node_refs;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a23daed7c20396c4d46ca7a98d50f4018"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::shuffle_no_change </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-shuffle_no_change' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-shuffle_no_change-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-shuffle_no_change-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-shuffle_no_change-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in shuffle_no_change: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a23daed7c20396c4d46ca7a98d50f4018">shuffle_no_change</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aaa74cf32ae2d17c33da4b350ec958997"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::shuffle_terminal_names </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-shuffle_terminal_names' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-shuffle_terminal_names-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-shuffle_terminal_names-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-shuffle_terminal_names-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in shuffle_terminal_names: 21</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#aaa74cf32ae2d17c33da4b350ec958997">shuffle_terminal_names</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $target_node = $args{target_node} <span class="comment">// $self-&gt;get_root_node;</span></div>
<div class="line"></div>
<div class="line">    my $node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    my %reordered = $target_node-&gt;shuffle_terminal_names (%args);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  place holder for nodes that will change</span></div>
<div class="line"><span class="preprocessor"></span>    my %tmp;</div>
<div class="line">    <span class="keywordflow">while</span> (my ($old, $new) = each %reordered) {</div>
<div class="line">        $tmp{$new} = $node_hash-&gt;{$old};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  and now we override the old with the new</span></div>
<div class="line"><span class="preprocessor"></span>    @{$node_hash}{keys %tmp} = values %tmp;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> !defined wantarray;</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %reordered : \%reordered;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac806e98e291f0969df4f3bb8abc66fbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::to_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_matrix' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_matrix-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_matrix-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_matrix-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_matrix: 83</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#ac806e98e291f0969df4f3bb8abc66fbc">to_matrix</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $class = $args{<span class="keyword">class</span>} || <span class="stringliteral">&#39;Biodiverse::Matrix&#39;</span>;</div>
<div class="line">    my $use_internal = $args{use_internal};</div>
<div class="line">    my $progress_bar = <a class="code" href="classBiodiverse_1_1Progress.html">Biodiverse::Progress</a>-&gt;<a class="code" href="classBiodiverse_1_1Progress.html#a88f4cef6f66986952a850fb70a2b62d8">new</a>();</div>
<div class="line"></div>
<div class="line">    my $name = $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Converting tree $name to matrix\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $matrix = $class-&gt;new (NAME =&gt; ($args{name} || ($name . <span class="stringliteral">&quot;_AS_MX&quot;</span>)));</div>
<div class="line"></div>
<div class="line">    my %nodes = $self-&gt;get_node_hash;  #  make sure we work on a copy</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (! $use_internal) {  #  strip out the <span class="keyword">internal</span> nodes</div>
<div class="line">        <span class="keywordflow">while</span> (my ($name1, $node1) = each %nodes) {</div>
<div class="line">            <span class="keywordflow">if</span> ($node1-&gt;is_internal_node) {</div>
<div class="line">                <span class="keyword">delete</span> $nodes{$name1};</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $progress;</div>
<div class="line">    my $to_do = scalar keys %nodes;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node1 (values %nodes) {</div>
<div class="line">        my $name1 = $node1-&gt;get_name;</div>
<div class="line"></div>
<div class="line">        $progress ++;</div>
<div class="line"></div>
<div class="line">        NODE2:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node2 (values %nodes) {</div>
<div class="line">            my $name2 = $node2-&gt;get_name;</div>
<div class="line">            $progress_bar-&gt;update(</div>
<div class="line">                <span class="stringliteral">&quot;Converting tree $name to matrix\n($progress / $to_do)&quot;</span>,</div>
<div class="line">                $progress / $to_do,</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line">            next NODE2 <span class="keywordflow">if</span> $node1 eq $node2;</div>
<div class="line">            next NODE2 <span class="keywordflow">if</span> $matrix-&gt;element_pair_exists(</div>
<div class="line">                element1 =&gt; $name1,</div>
<div class="line">                element2 =&gt; $name2,</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #my $shared_ancestor = $node1-&gt;get_shared_ancestor (node =&gt; $node2);</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #my $total_length = $shared_ancestor-&gt;get_total_length;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            ##  should allow user to choose whether to just get length to shared ancestor?</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #my $path_length1 = $total_length - $node1-&gt;get_total_length;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #my $path_length2 = $total_length - $node2-&gt;get_total_length;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #my $path_length_total = $path_length1 + $path_length2;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #$matrix-&gt;add_element (</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #    element1 =&gt; $name1,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #    element2 =&gt; $name2,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #    value    =&gt; $path_length_total,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #);</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">            my $last_ancestor = $self-&gt;get_last_shared_ancestor_for_nodes (</div>
<div class="line">                node_names =&gt; {$name1 =&gt; 1, $name2 =&gt; 1},</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line">            my %path;</div>
<div class="line">            <span class="keywordflow">foreach</span> my $node_name ($name1, $name2) {</div>
<div class="line">                my $node_ref = $self-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line">                my $sub_path = $node_ref-&gt;get_path_lengths_to_ancestral_node (</div>
<div class="line">                    ancestral_node =&gt; $last_ancestor,</div>
<div class="line">                    %args,</div>
<div class="line">                );</div>
<div class="line">                @path{keys %$sub_path} = values %$sub_path;</div>
<div class="line">            }</div>
<div class="line">            <span class="keyword">delete</span> $path{$last_ancestor-&gt;get_name()};</div>
<div class="line">            my $path_length = sum values %path;</div>
<div class="line">            $matrix-&gt;set_value(</div>
<div class="line">                element1 =&gt; $name1,</div>
<div class="line">                element2 =&gt; $name2,</div>
<div class="line">                value    =&gt; $path_length,</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $matrix;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a191ee4a4dbd4b0f3e798a7ff6ff1e4ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::trees_are_same </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-trees_are_same' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-trees_are_same-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-trees_are_same-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-trees_are_same-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in trees_are_same: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a191ee4a4dbd4b0f3e798a7ff6ff1e4ba">trees_are_same</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $exact_match_count = $self-&gt;compare (%args, no_track_matches =&gt; 1);</div>
<div class="line">    </div>
<div class="line">    my $comparison = $args{comparison}</div>
<div class="line">        || croak <span class="stringliteral">&quot;Comparison not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $node_count_self = $self-&gt;get_node_count;</div>
<div class="line">    my $node_count_comp = $comparison-&gt;get_node_count;</div>
<div class="line">    my $trees_match</div>
<div class="line">        = $node_count_self == $node_count_comp</div>
<div class="line">        &amp;&amp; $exact_match_count == $node_count_self;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $trees_match;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abb6ee1c7a898ddc646ec042815ffd551"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::trim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-trim' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-trim-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-trim-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-trim-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in trim: 95</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#abb6ee1c7a898ddc646ec042815ffd551">trim</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (</div>
<div class="line">        delete_internals =&gt; 1,   #  <span class="keyword">delete</span> internals by <span class="keywordflow">default</span></div>
<div class="line">        @_,                      #  <span class="keywordflow">if</span> they have no named children to keep</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $delete_internals = $args{delete_internals};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  get keep and trim lists and convert to hashes as needs dictate</span></div>
<div class="line"><span class="preprocessor"></span>    my $keep = $args{keep} || {};  #  those to keep</div>
<div class="line">    $keep = $self-&gt;array_to_hash_keys (list =&gt; $keep);</div>
<div class="line">    my $trim = $args{<a class="code" href="classBiodiverse_1_1Tree.html#abb6ee1c7a898ddc646ec042815ffd551">trim</a>}; #  those to <span class="keyword">delete</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  if the keep list is defined, and the trim list is not defined,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    then we work with all named nodes that don&#39;t have children we want to keep</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> (! defined $args{<a class="code" href="classBiodiverse_1_1Tree.html#abb6ee1c7a898ddc646ec042815ffd551">trim</a>} &amp;&amp; defined $args{keep}) {</div>
<div class="line">        $trim = {};</div>
<div class="line">        my %node_hash = $self-&gt;get_node_hash;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $name (keys %node_hash) {</div>
<div class="line">            my $node = $node_hash{$name};</div>
<div class="line">            next <span class="keywordflow">if</span> exists $keep-&gt;{$name};</div>
<div class="line">            next <span class="keywordflow">if</span> $node-&gt;is_internal_node;</div>
<div class="line">            next <span class="keywordflow">if</span> $node-&gt;is_root_node;  #  never <span class="keyword">delete</span> the root node</div>
<div class="line">            my %children = $node-&gt;get_all_descendents;  #  make sure we use a copy</div>
<div class="line">            my $child_count = scalar keys %children;</div>
<div class="line">            <span class="keyword">delete</span> @children{keys %$keep};</div>
<div class="line"><span class="preprocessor">            #  if any were deleted then we have some children to keep.  don&#39;t add this node</span></div>
<div class="line"><span class="preprocessor"></span>            next <span class="keywordflow">if</span> $child_count != scalar keys %children;  </div>
<div class="line">            $trim-&gt;{$name} = $node_hash{$name};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        $trim = {};</div>
<div class="line">    }</div>
<div class="line">    my %trim_hash = $self-&gt;array_to_hash_keys (list =&gt; $trim);  #  makes a copy</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  we only want to consider those not being explicitly kept (included)</span></div>
<div class="line"><span class="preprocessor"></span>    my %candidate_node_hash = $self-&gt;get_node_hash;</div>
<div class="line">    <span class="keyword">delete</span> @candidate_node_hash{keys %$keep};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my %all_nodes = $self-&gt;get_node_hash;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #delete @all_nodes{keys %candidate_node_hash};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;keeping \n&quot;, join (&quot;\n&quot;, keys %$keep), &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;trimming \n&quot;, join (&quot;\n&quot;, keys %trim_hash), &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;ignoring \n&quot;, join (&quot;\n&quot;, keys %all_nodes), &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my %deleted;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $name (keys %candidate_node_hash) {</div>
<div class="line">        next <span class="keywordflow">if</span> $deleted{$name};  #  we might have deleted a named parent, so <span class="keyword">this</span> node no longer exists in the tree</div>
<div class="line">        my $node = $candidate_node_hash{$name};</div>
<div class="line"><span class="preprocessor">        #  delete if it is in the list to exclude</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (exists $trim_hash{$name}) {</div>
<div class="line">            print <span class="stringliteral">&quot;[Tree] Deleting node $name\n&quot;</span>;</div>
<div class="line">            my @deleted_nodes = $self-&gt;delete_node (node =&gt; $name);</div>
<div class="line">            <span class="keywordflow">foreach</span> my $del_name (@deleted_nodes) {</div>
<div class="line">                $deleted{$del_name} ++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">        #else {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #    print &quot;[TREE] NOT deleting node $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #}</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($delete_internals and scalar keys %deleted) {</div>
<div class="line"><span class="preprocessor">        #  delete any internal nodes with no named children</span></div>
<div class="line"><span class="preprocessor"></span>        my %node_hash = $self-&gt;get_node_hash;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $name (keys %node_hash) {</div>
<div class="line">            my $node = $node_hash{$name};</div>
<div class="line">            next <span class="keywordflow">if</span> ! $node-&gt;is_internal_node;</div>
<div class="line">            next <span class="keywordflow">if</span> $node-&gt;is_root_node;</div>
<div class="line"></div>
<div class="line">            my $children = $node-&gt;get_all_descendents;</div>
<div class="line">            my %named_children;</div>
<div class="line">            <span class="keywordflow">foreach</span> my $child (keys %$children) {</div>
<div class="line">                my $child_node = $children-&gt;{$child};</div>
<div class="line">                $named_children{$child} = 1 <span class="keywordflow">if</span> ! $child_node-&gt;is_internal_node;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (scalar keys %named_children == 0) {</div>
<div class="line"><span class="preprocessor">                #  might have already been deleted , so wrap in an eval</span></div>
<div class="line"><span class="preprocessor"></span>                eval { $self-&gt;delete_node (node =&gt; $name) };</div>
<div class="line"><span class="preprocessor">                #print &quot;[TREE] Deleting internal node $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            }</div>
<div class="line"><span class="preprocessor">            #else {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #    print &quot;[TREE] NOT Deleting internal node $name\n&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #}</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;delete_param (<span class="stringliteral">&#39;TOTAL_LENGTH&#39;</span>);  #  need to clear <span class="keyword">this</span> up</div>
<div class="line">    $self-&gt;get_tree_ref-&gt;delete_cached_values_below;</div>
<div class="line">    $keep = undef;  #  was leaking - not sure it matters, though</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6839b73ab3dc0c7bf6f6c11861482444"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::weaken_parent_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-weaken_parent_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-weaken_parent_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-weaken_parent_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-weaken_parent_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in weaken_parent_refs: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a6839b73ab3dc0c7bf6f6c11861482444">weaken_parent_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $nodeList = $self-&gt;get_node_hash;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $nodeRef (values %$nodeList) {</div>
<div class="line">        $nodeRef-&gt;weaken_parent_ref;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a25da5d55c96372f4f451ad7dd7a82fa8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Tree::AUTOLOAD</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-AUTOLOAD' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-AUTOLOAD-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-AUTOLOAD-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-AUTOLOAD-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in AUTOLOAD: 27</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Tree.html#a25da5d55c96372f4f451ad7dd7a82fa8">AUTOLOAD</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $type = ref($self) || $self;</div>
<div class="line"><span class="preprocessor">                #or croak &quot;$self is not an object\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $method = $AUTOLOAD;</div>
<div class="line">    $method =~ s/.*:<span class="comment">//;   # strip fully-qualified portion</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  seem to be getting destroy issues - let the system take care of it.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    return if $method eq &#39;DESTROY&#39;;  </span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $root_node = $self-&gt;get_tree_ref;</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&#39;No root node&#39;</span> <span class="keywordflow">if</span> ! $root_node;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (defined $root_node and $root_node-&gt;can ($method)) {</div>
<div class="line"><span class="preprocessor">        #print &quot;[TREE] Using AUTOLOADER method $method\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> $root_node-&gt;$method (@_);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        Biodiverse::NoMethod-&gt;throw (method =&gt; $method, message =&gt; <span class="stringliteral">&quot;$self cannot call method $method&quot;</span>);</div>
<div class="line"><span class="preprocessor">        #croak &quot;[$type (TREE)] No root node and/or cannot access method $method, &quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #    . &quot;tried AUTOLOADER and failed\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
<p>Definition at line <a class="el" href="Tree_8pm_source.html#l00063">63</a> of file <a class="el" href="Tree_8pm_source.html">Tree.pm</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/Biodiverse/<a class="el" href="Tree_8pm_source.html">Tree.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Biodiverse</b></li><li class="navelem"><a class="el" href="classBiodiverse_1_1Tree.html">Tree</a></li>
    <li class="footer">Generated on Tue Nov 5 2013 19:07:30 for Biodiverse by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
