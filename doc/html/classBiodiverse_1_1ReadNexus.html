<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Biodiverse: Biodiverse::ReadNexus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Biodiverse
   &#160;<span id="projectnumber">0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classBiodiverse_1_1ReadNexus.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classBiodiverse_1_1ReadNexus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Biodiverse::ReadNexus Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Biodiverse::ReadNexus:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBiodiverse_1_1ReadNexus__coll__graph.png" border="0" usemap="#Biodiverse_1_1ReadNexus_coll__map" alt="Collaboration graph"/></div>
<map name="Biodiverse_1_1ReadNexus_coll__map" id="Biodiverse_1_1ReadNexus_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a399ddb116ed550285db4bb0b4012c5bb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a399ddb116ed550285db4bb0b4012c5bb"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>RE_NUMBER</b></td></tr>
<tr class="separator:a399ddb116ed550285db4bb0b4012c5bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea93d63d26ae5ac4ceaf05272e8090d5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea93d63d26ae5ac4ceaf05272e8090d5"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>RE_QUOTED</b></td></tr>
<tr class="separator:aea93d63d26ae5ac4ceaf05272e8090d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b456ff36bf06bf9da9484d2ff240628"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9b456ff36bf06bf9da9484d2ff240628"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>RE_TEXT_IN_QUOTES</b></td></tr>
<tr class="separator:a9b456ff36bf06bf9da9484d2ff240628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae444e63f7dd2fa1fca825a56306f14e3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae444e63f7dd2fa1fca825a56306f14e3"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>EMPTY_STRING</b></td></tr>
<tr class="separator:ae444e63f7dd2fa1fca825a56306f14e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e0a2d86d92d8acd040338edd1b44a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae6e0a2d86d92d8acd040338edd1b44a5"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>re_text_in_brackets</b></td></tr>
<tr class="separator:ae6e0a2d86d92d8acd040338edd1b44a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70de15ceee8b8919abf982c099887a97"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70de15ceee8b8919abf982c099887a97"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>re_text_in_square_brackets</b></td></tr>
<tr class="separator:a70de15ceee8b8919abf982c099887a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Avaliable Methods</h2></td></tr>
<tr class="memitem:a4c636a89ad3b20e01a6eff484537fdbb"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a4c636a89ad3b20e01a6eff484537fdbb">get_tree_array</a> ()</td></tr>
<tr class="separator:a4c636a89ad3b20e01a6eff484537fdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac16f72d6e484889d0d8e8ebaf8838a83"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#ac16f72d6e484889d0d8e8ebaf8838a83">import_nexus</a> ()</td></tr>
<tr class="separator:ac16f72d6e484889d0d8e8ebaf8838a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258afc560ac07ba549f816bc3fd71c95"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a258afc560ac07ba549f816bc3fd71c95">import_newick</a> ()</td></tr>
<tr class="separator:a258afc560ac07ba549f816bc3fd71c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ed3758333e3bab3eb51e41113e2c9b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#af5ed3758333e3bab3eb51e41113e2c9b">read_whole_file</a> ()</td></tr>
<tr class="separator:af5ed3758333e3bab3eb51e41113e2c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9501fe58066c092e93ad3df1a9c540a2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a9501fe58066c092e93ad3df1a9c540a2">get_csv_object_for_tabular_tree_import</a> ()</td></tr>
<tr class="separator:a9501fe58066c092e93ad3df1a9c540a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09695bbaa9640cae23b0f92ee01b8160"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a09695bbaa9640cae23b0f92ee01b8160">process_unrooted_trees</a> ()</td></tr>
<tr class="separator:a09695bbaa9640cae23b0f92ee01b8160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71600be08fe7abdff7ac30ead3f31bc3"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a71600be08fe7abdff7ac30ead3f31bc3">import_phylip</a> ()</td></tr>
<tr class="separator:a71600be08fe7abdff7ac30ead3f31bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208954625c8cc2d2a3b714cd41bc190b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a208954625c8cc2d2a3b714cd41bc190b">process_zero_length_trees</a> ()</td></tr>
<tr class="separator:a208954625c8cc2d2a3b714cd41bc190b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a428a01d2e66d36bfdfce70d1150c58a1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a428a01d2e66d36bfdfce70d1150c58a1">add_tree</a> ()</td></tr>
<tr class="separator:a428a01d2e66d36bfdfce70d1150c58a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ee2726b454cfb916c1df568f3dedf6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a01ee2726b454cfb916c1df568f3dedf6">assign_parents_for_tabular_tree_import</a> ()</td></tr>
<tr class="separator:a01ee2726b454cfb916c1df568f3dedf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806b2eddd4f19932fe98de34480e6ea0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a806b2eddd4f19932fe98de34480e6ea0">numerically</a> ()</td></tr>
<tr class="separator:a806b2eddd4f19932fe98de34480e6ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337903aec0a356f16b1b5720049b31db"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a337903aec0a356f16b1b5720049b31db">parse_newick</a> ()</td></tr>
<tr class="separator:a337903aec0a356f16b1b5720049b31db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bbeec85aa09937f72f5424d3ea799fa"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a9bbeec85aa09937f72f5424d3ea799fa">new</a> ()</td></tr>
<tr class="separator:a9bbeec85aa09937f72f5424d3ea799fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327cc1d8cb432247d2394e8622307b0e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a327cc1d8cb432247d2394e8622307b0e">add_node_to_tree</a> ()</td></tr>
<tr class="separator:a327cc1d8cb432247d2394e8622307b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbcb87e41f5ad16229e873038fb8b9fc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#acbcb87e41f5ad16229e873038fb8b9fc">import_tabular_tree</a> ()</td></tr>
<tr class="separator:acbcb87e41f5ad16229e873038fb8b9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ee8e1bb121e9031796d13201201f0e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1ReadNexus.html#a10ee8e1bb121e9031796d13201201f0e">import_data</a> ()</td></tr>
<tr class="separator:a10ee8e1bb121e9031796d13201201f0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="ReadNexus_8pm_source.html#l00018">18</a> of file <a class="el" href="ReadNexus_8pm_source.html">ReadNexus.pm</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a327cc1d8cb432247d2394e8622307b0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::add_node_to_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_node_to_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_node_to_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_node_to_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_node_to_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_node_to_tree: 37</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a327cc1d8cb432247d2394e8622307b0e">add_node_to_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $tree   = $args{tree};</div>
<div class="line">    my $name   = $args{name};</div>
<div class="line">    my $length = $args{length};</div>
<div class="line">    my $boot   = $args{boot};</div>
<div class="line">    my $translate_hash = $args{translate_hash};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  ADD_NODE_TO_TREE:</div>
<div class="line">    my $node = eval {</div>
<div class="line">        $tree-&gt;add_node (</div>
<div class="line">            name   =&gt; $name,</div>
<div class="line">            length =&gt; $length,</div>
<div class="line">            boot   =&gt; $boot,</div>
<div class="line">        )</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordflow">if</span> (Biodiverse::Tree::NodeAlreadyExists-&gt;caught) {</div>
<div class="line">        my $e = $EVAL_ERROR;</div>
<div class="line">        my $prefix = $e-&gt;name;</div>
<div class="line">        $name = $tree-&gt;get_unique_name(</div>
<div class="line">            prefix  =&gt; $prefix,</div>
<div class="line">            exclude =&gt; $translate_hash,</div>
<div class="line">        );</div>
<div class="line">        <span class="keywordflow">goto</span> ADD_NODE_TO_TREE;</div>
<div class="line">    }</div>
<div class="line">    elsif ($EVAL_ERROR) {</div>
<div class="line">        croak $EVAL_ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $node;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  SWL: method to get the tree array.  Needed for GUI.</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a428a01d2e66d36bfdfce70d1150c58a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::add_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_tree: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a428a01d2e66d36bfdfce70d1150c58a1">add_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! defined $args{tree};</div>
<div class="line"></div>
<div class="line">    push @{$self-&gt;{TREE_ARRAY}}, $args{tree};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a01ee2726b454cfb916c1df568f3dedf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::assign_parents_for_tabular_tree_import </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-assign_parents_for_tabular_tree_import' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-assign_parents_for_tabular_tree_import-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-assign_parents_for_tabular_tree_import-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-assign_parents_for_tabular_tree_import-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in assign_parents_for_tabular_tree_import: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a01ee2726b454cfb916c1df568f3dedf6">assign_parents_for_tabular_tree_import</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $tree = $args{tree_ref};</div>
<div class="line">    my $node_hash = $args{node_hash};</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  now pass over the data again and assign parents</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $node_number (sort keys %$node_hash) {</div>
<div class="line">        my $node_name = $node_hash-&gt;{$node_number}{NAME};</div>
<div class="line">        my $node_ref  = $tree-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line"></div>
<div class="line">        my $parent_number = $node_hash-&gt;{$node_number}{PARENTNODE};</div>
<div class="line">        my $parent_name   = $node_hash-&gt;{$parent_number}{NAME};</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (defined $parent_name) {</div>
<div class="line">            my $parent_ref = $tree-&gt;get_node_ref (node =&gt; $parent_name);</div>
<div class="line">            $parent_ref-&gt;add_children(children =&gt; [$node_ref]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9501fe58066c092e93ad3df1a9c540a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::get_csv_object_for_tabular_tree_import </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_csv_object_for_tabular_tree_import' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_csv_object_for_tabular_tree_import-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_csv_object_for_tabular_tree_import-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_csv_object_for_tabular_tree_import-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_csv_object_for_tabular_tree_import: 39</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a9501fe58066c092e93ad3df1a9c540a2">get_csv_object_for_tabular_tree_import</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">        my $data = $args{data};</div>
<div class="line">    my @data = split (<span class="stringliteral">&quot;\n&quot;</span>, $data, 2);</div>
<div class="line">    my $header = $data[0];</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  need to get the csv params</span></div>
<div class="line"><span class="preprocessor"></span>    my $input_quote_char = $args{input_quote_char};</div>
<div class="line">    my $sep              = $args{input_sep_char};    </div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  boilerplate - refactor</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> (not defined $input_quote_char or $input_quote_char eq <span class="stringliteral">&#39;guess&#39;</span>) {</div>
<div class="line"><span class="preprocessor">        #  guess the quotes character</span></div>
<div class="line"><span class="preprocessor"></span>        $input_quote_char = $self-&gt;guess_quote_char (<span class="keywordtype">string</span> =&gt; $data);</div>
<div class="line"><span class="preprocessor">        #  if all else fails...</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (not defined $input_quote_char) {</div>
<div class="line">            $input_quote_char = $self-&gt;get_param (<span class="stringliteral">&#39;QUOTES&#39;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (not defined $sep or $sep eq <span class="stringliteral">&#39;guess&#39;</span>) {</div>
<div class="line">        $sep = $self-&gt;guess_field_separator (</div>
<div class="line">            <span class="keywordtype">string</span>     =&gt; $header,</div>
<div class="line">            quote_char =&gt; $input_quote_char,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">    my $eol = $self-&gt;guess_eol (<span class="keywordtype">string</span> =&gt; $header);</div>
<div class="line">    </div>
<div class="line">    my $csv_in = $self-&gt;get_csv_object (</div>
<div class="line">        sep_char =&gt; $sep,</div>
<div class="line">        quote_char =&gt; $input_quote_char,</div>
<div class="line">        eol =&gt; $eol,</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $csv_in;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4c636a89ad3b20e01a6eff484537fdbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::get_tree_array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_tree_array' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_tree_array-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_tree_array-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_tree_array-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_tree_array: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a4c636a89ad3b20e01a6eff484537fdbb">get_tree_array</a> {</div>
<div class="line">  my $self = shift;</div>
<div class="line">  <span class="keywordflow">return</span> wantarray ? @{$self-&gt;{TREE_ARRAY}} : $self-&gt;{TREE_ARRAY};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a10ee8e1bb121e9031796d13201201f0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::import_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_data' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-import_data-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_data-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_data-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in import_data: 49</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a10ee8e1bb121e9031796d13201201f0e">import_data</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $element_properties = $args{element_properties};</div>
<div class="line">    my $use_element_properties = exists $args{use_element_properties}  #  just a flag of convenience</div>
<div class="line">                                    ? $args{use_element_properties}</div>
<div class="line">                                    : defined $element_properties;</div>
<div class="line">    $self-&gt;set_param (ELEMENT_PROPERTIES =&gt; $element_properties);</div>
<div class="line">    $self-&gt;set_param (USE_ELEMENT_PROPERTIES =&gt; $use_element_properties);</div>
<div class="line">    </div>
<div class="line">    my @import_methods = qw /<a class="code" href="classBiodiverse_1_1ReadNexus.html#ac16f72d6e484889d0d8e8ebaf8838a83">import_nexus</a> <a class="code" href="classBiodiverse_1_1ReadNexus.html#a71600be08fe7abdff7ac30ead3f31bc3">import_phylip</a> <a class="code" href="classBiodiverse_1_1ReadNexus.html#acbcb87e41f5ad16229e873038fb8b9fc">import_tabular_tree</a>/;</div>
<div class="line">    <span class="keywordflow">if</span> (defined $args{file} &amp;&amp; $args{file} =~ /(txt|csv)$/) {  #  dirty hack</div>
<div class="line">        @import_methods = (<span class="stringliteral">&#39;import_tabular_tree&#39;</span>);</div>
<div class="line">    }</div>
<div class="line">    my $success;</div>
<div class="line">    </div>
<div class="line">  IMPORT_METHOD:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $method (@import_methods) {</div>
<div class="line">        eval {</div>
<div class="line">            $self-&gt;$method (%args);</div>
<div class="line">        };</div>
<div class="line">        <span class="keywordflow">if</span> ($EVAL_ERROR) {</div>
<div class="line">            <span class="keywordflow">if</span> (Biodiverse::ReadNexus::IncorrectFormat-&gt;caught) {</div>
<div class="line">                next IMPORT_METHOD;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                Biodiverse::ReadNexus::IncorrectFormat-&gt;throw (</div>
<div class="line">                    message =&gt; <span class="stringliteral">&quot;Unable to import data:\n&quot;</span> . $EVAL_ERROR,</div>
<div class="line">                    type    =&gt; <span class="stringliteral">&#39;generic&#39;</span>,</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        $success = 1;</div>
<div class="line">        last IMPORT_METHOD;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!$success) {</div>
<div class="line">        Biodiverse::ReadNexus::IncorrectFormat-&gt;throw (</div>
<div class="line">            message =&gt; <span class="stringliteral">&quot;Unable to import data&quot;</span>,</div>
<div class="line">            type    =&gt; <span class="stringliteral">&#39;generic&#39;</span>,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;process_zero_length_trees;</div>
<div class="line">    $self-&gt;process_unrooted_trees;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a258afc560ac07ba549f816bc3fd71c95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::import_newick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_newick' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-import_newick-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_newick-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_newick-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in import_newick: 31</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a258afc560ac07ba549f816bc3fd71c95">import_newick</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $newick = $args{data};</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Neither file nor data arg specified\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> not defined $newick and not defined $args{file};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (! defined $newick) {</div>
<div class="line">        $newick = $self-&gt;read_whole_file (file =&gt; $args{file});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $tree = Biodiverse::Tree-&gt;new (</div>
<div class="line">        NAME =&gt; $args{NAME}</div>
<div class="line">            || <span class="stringliteral">&#39;anonymous from newick&#39;</span></div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">    my $count = 0;</div>
<div class="line">    my $node_count = \$count;</div>
<div class="line"></div>
<div class="line">    $self-&gt;parse_newick (</div>
<div class="line">        <span class="keywordtype">string</span>          =&gt; $newick,</div>
<div class="line">        tree            =&gt; $tree,</div>
<div class="line">        node_count      =&gt; $node_count,</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    $self-&gt;add_tree (tree =&gt; $tree);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac16f72d6e484889d0d8e8ebaf8838a83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::import_nexus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_nexus' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-import_nexus-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_nexus-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_nexus-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in import_nexus: 156</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#ac16f72d6e484889d0d8e8ebaf8838a83">import_nexus</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $nexus = $args{data};</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Neither file nor data arg specified\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> not defined $nexus and not defined $args{file};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (! defined $nexus) {</div>
<div class="line">        $nexus = $self-&gt;read_whole_file (file =&gt; $args{file});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @nexus = split (/[\r\n]+/, $nexus);</div>
<div class="line">    my %translate;</div>
<div class="line">    my @newicks;</div>
<div class="line"></div>
<div class="line">    pos ($nexus) = 0;</div>
<div class="line">    my $in_trees_block = 0;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we extract the tree block</span></div>
<div class="line"><span class="preprocessor"></span>    BY_LINE:</div>
<div class="line">    <span class="keywordflow">while</span> (defined (my $line = shift @nexus)) {  #  haven<span class="stringliteral">&#39;t hit the end of the file yet</span></div>
<div class="line"><span class="stringliteral">        #print &quot;position is &quot; . pos ($nexus) . &quot;\n&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        # skip any lines before the tree block</span></div>
<div class="line"><span class="stringliteral">        if (not $in_trees_block and $line =~ m/\s*begin trees;/i) {</span></div>
<div class="line"><span class="stringliteral">            $in_trees_block = 1;</span></div>
<div class="line"><span class="stringliteral">            $line = shift @nexus;  #  get the next line now we&#39;</span>re in the trees block</div>
<div class="line">            next BY_LINE <span class="keywordflow">if</span> not defined $line;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        next BY_LINE <span class="keywordflow">if</span> not $in_trees_block;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #print &quot;$line\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">        #  drop out if we are at the end or endblock that closes the trees block</span></div>
<div class="line"><span class="preprocessor"></span>        last <span class="keywordflow">if</span> $line =~ m/\s*end(?:block)?;/i;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  now we are in the tree block, process the lines as appropriate</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        <span class="keywordflow">if</span> ($line =~ m/^\s*\[/) {  #  comment - munch to the end of the comment</div>
<div class="line">            next BY_LINE <span class="keywordflow">if</span> $line =~ /\]/;  #  comment closer is on <span class="keyword">this</span> line</div>
<div class="line">            <span class="keywordflow">while</span> (my $comment = shift @nexus) {</div>
<div class="line">                next unless $comment =~ /\]/;</div>
<div class="line">                next BY_LINE;  #  we hit the closing comment marker, move to the next line</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        elsif ($line =~ m/\s*Translate/i) {  #  translate block - munch to the end of it and store the translations</div>
<div class="line"></div>
<div class="line">            TRANSLATE_BLOCK:</div>
<div class="line">            <span class="keywordflow">while</span> (my $trans = shift @nexus) {</div>
<div class="line"><span class="preprocessor">                #print &quot;$trans\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>                my ($trans_code, $trans_name)</div>
<div class="line">                    = $trans =~  m{  \s*     #  zero or more whitespace chars</div>
<div class="line">                                    (\S+)    <span class="preprocessor">#  typically a number</span></div>
<div class="line"><span class="preprocessor"></span>                                     \s+     #  one or more whitespace chars</div>
<div class="line">                                    ($RE_QUOTED | \S+)    <span class="preprocessor">#  the label</span></div>
<div class="line"><span class="preprocessor"></span>                                  }x;</div>
<div class="line">                <span class="keywordflow">if</span> (defined $trans_code) {</div>
<div class="line"><span class="preprocessor">                    #  delete trailing comma or semicolon</span></div>
<div class="line"><span class="preprocessor"></span>                    $trans_name =~ s{ [,;]</div>
<div class="line">                                      \s*</div>
<div class="line">                                      \z</div>
<div class="line">                                    }</div>
<div class="line">                                    {}xms;</div>
<div class="line"><span class="preprocessor">                    #if ($trans_name =~ / ^\&#39; /) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                    #if (my @components = $trans_name =~ $RE_TEXT_IN_QUOTES) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                        #$trans_name = $1;</span></div>
<div class="line"><span class="preprocessor"></span>                        $trans_name =~ s/^<span class="stringliteral">&#39;//;  #  strip back the quotes</span></div>
<div class="line"><span class="stringliteral">                        $trans_name =~ s/&#39;</span>$<span class="comment">//;</span></div>
<div class="line">                        $trans_name =~ s/<span class="stringliteral">&#39;&#39;</span>/<span class="stringliteral">&#39;/g;</span></div>
<div class="line"><span class="stringliteral">                    #}</span></div>
<div class="line"><span class="stringliteral">                    $translate{$trans_code} = $trans_name;</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">                last TRANSLATE_BLOCK if $trans =~ /;\s*\z/;  #  semicolon marks the end</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        elsif ($line =~ m/^\s*tree/i) {  #  tree - extract it</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $nwk = $line;</span></div>
<div class="line"><span class="stringliteral">            if (not $line =~ m/;\s*$/) {  #  tree is not finished unless we end in a semi colon, maybe with some white space</span></div>
<div class="line"><span class="stringliteral">                </span></div>
<div class="line"><span class="stringliteral">                TREE_LINES:</span></div>
<div class="line"><span class="stringliteral">                while (my $tree_line = shift @nexus) {</span></div>
<div class="line"><span class="stringliteral">                    $tree_line =~ s{[\r\n]} {};  #  delete any newlines, although they should already be gone...</span></div>
<div class="line"><span class="stringliteral">                    $nwk .= $tree_line;</span></div>
<div class="line"><span class="stringliteral">                    last if $tree_line =~ m/;\s*$/;  #  ends in a semi-colon</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            push @newicks, $nwk;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    if (scalar @newicks == 0) {</span></div>
<div class="line"><span class="stringliteral">        Biodiverse::ReadNexus::IncorrectFormat-&gt;throw (</span></div>
<div class="line"><span class="stringliteral">            message =&gt; &#39;</span>Data has no trees in it, or is not Nexus format<span class="stringliteral">&#39;,</span></div>
<div class="line"><span class="stringliteral">            type    =&gt; &#39;</span>nexus<span class="stringliteral">&#39;,</span></div>
<div class="line"><span class="stringliteral">        );</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    $self-&gt;set_param (TRANSLATE_HASH =&gt; \%translate);  #  store for future use</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    foreach my $nwk (@newicks) {</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            #  remove trailing semi-colon</span></div>
<div class="line"><span class="stringliteral">            $nwk =~ s/;$//;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $tree_name = $EMPTY_STRING;</span></div>
<div class="line"><span class="stringliteral">            my $rooted    = $EMPTY_STRING;</span></div>
<div class="line"><span class="stringliteral">            my $rest      = $EMPTY_STRING;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            #  get the tree name and whether it is unrooted etc</span></div>
<div class="line"><span class="stringliteral">            if (my $x = $nwk =~ m/</span></div>
<div class="line"><span class="stringliteral">                                \s*</span></div>
<div class="line"><span class="stringliteral">                                tree\s+</span></div>
<div class="line"><span class="stringliteral">                                (.+?)       #  capture the name of the tree into $1</span></div>
<div class="line"><span class="stringliteral">                                \s*=\s*</span></div>
<div class="line"><span class="stringliteral">                                (\[..\])?  #  get the rooted unrooted bit</span></div>
<div class="line"><span class="stringliteral">                                \s*</span></div>
<div class="line"><span class="stringliteral">                                (.*)     #  get the rest</span></div>
<div class="line"><span class="stringliteral">                            /xgcsi</span></div>
<div class="line"><span class="stringliteral">            ) {</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                $tree_name = $1;</span></div>
<div class="line"><span class="stringliteral">                $rooted    = $2;</span></div>
<div class="line"><span class="stringliteral">                $rest      = $3;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            $tree_name =~ s/\s+$//;  #  trim trailing whitespace</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            print &quot;[ReadNexus] Processing tree $tree_name\n&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $tree = Biodiverse::Tree-&gt;new (NAME =&gt; $tree_name);</span></div>
<div class="line"><span class="stringliteral">            #$tree-&gt;set_param ()</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $count = 0;</span></div>
<div class="line"><span class="stringliteral">            my $node_count = \$count;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            $self-&gt;parse_newick (</span></div>
<div class="line"><span class="stringliteral">                string          =&gt; $rest,</span></div>
<div class="line"><span class="stringliteral">                tree            =&gt; $tree,</span></div>
<div class="line"><span class="stringliteral">                node_count      =&gt; $node_count,</span></div>
<div class="line"><span class="stringliteral">                translate_hash  =&gt; \%translate,</span></div>
<div class="line"><span class="stringliteral">            );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            $self-&gt;add_tree (tree =&gt; $tree);</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    #print &quot;&quot;;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    return 1;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">#  rough and ready - assumes a set structure</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a71600be08fe7abdff7ac30ead3f31bc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::import_phylip </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_phylip' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-import_phylip-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_phylip-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_phylip-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in import_phylip: 48</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a71600be08fe7abdff7ac30ead3f31bc3">import_phylip</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $data = $args{data};</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Neither file nor data arg specified\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> not defined $data and not defined $args{file};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (! defined $data) {</div>
<div class="line">        $data = $self-&gt;read_whole_file (file =&gt; $args{file});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  lazy split - does not allow for quoted semicolons</span></div>
<div class="line"><span class="preprocessor"></span>    my @newicks = split /;/, $data;</div>
<div class="line"></div>
<div class="line">    my $i = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $nwk (@newicks) {</div>
<div class="line">        next <span class="keywordflow">if</span> $nwk =~ /^[\s\n]*$/;</div>
<div class="line"></div>
<div class="line">        my $tree_name = <span class="stringliteral">&#39;anonymous_&#39;</span> . $i;</div>
<div class="line">        my $tree = Biodiverse::Tree-&gt;new (NAME =&gt; $tree_name);</div>
<div class="line"></div>
<div class="line">        my $count = 0;</div>
<div class="line">        my $node_count = \$count;</div>
<div class="line"></div>
<div class="line">        eval {</div>
<div class="line">            $self-&gt;parse_newick (</div>
<div class="line">                <span class="keywordtype">string</span>          =&gt; $nwk,</div>
<div class="line">                tree            =&gt; $tree,</div>
<div class="line">                node_count      =&gt; $node_count,</div>
<div class="line">            );</div>
<div class="line">        };</div>
<div class="line">        <span class="keywordflow">if</span> ($EVAL_ERROR) {  #  not sure <span class="keyword">this</span> will work</div>
<div class="line">            Biodiverse::ReadNexus::IncorrectFormat-&gt;throw (</div>
<div class="line">                message =&gt; <span class="stringliteral">&#39;Data has no trees in it, or is not Nexus format&#39;</span>,</div>
<div class="line">                type    =&gt; <span class="stringliteral">&#39;phylip&#39;</span>,</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $self-&gt;add_tree (tree =&gt; $tree);</div>
<div class="line"></div>
<div class="line">        $i ++;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="acbcb87e41f5ad16229e873038fb8b9fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::import_tabular_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-import_tabular_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-import_tabular_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-import_tabular_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-import_tabular_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in import_tabular_tree: 77</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#acbcb87e41f5ad16229e873038fb8b9fc">import_tabular_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $data = $args{data};</div>
<div class="line">    <span class="keywordflow">if</span> (! defined $data) {</div>
<div class="line">        $data = $self-&gt;read_whole_file (file =&gt; $args{file});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @data = split ($/, $data);</div>
<div class="line">    my $header = shift @data;</div>
<div class="line"></div>
<div class="line">    my $csv = $self-&gt;get_csv_object_for_tabular_tree_import (%args);</div>
<div class="line">    $csv-&gt;parse($header);</div>
<div class="line">    my @header = $csv-&gt;fields;</div>
<div class="line">    $csv-&gt;column_names (@header);</div>
<div class="line"></div>
<div class="line">    my $node_hash = {};</div>
<div class="line"></div>
<div class="line">    my @trees;</div>
<div class="line"></div>
<div class="line">    $csv-&gt;parse ($data[0]);</div>
<div class="line">    my @line_arr = $csv-&gt;fields;</div>
<div class="line">    my %line_h;</div>
<div class="line">    @line_h{@header} = @line_arr;</div>
<div class="line">    my $tree_name = $args{NAME} || $line_h{TREENAME} || <span class="stringliteral">&#39;TABULAR_TREE&#39;</span>;</div>
<div class="line">    my $tree = Biodiverse::Tree-&gt;new (NAME =&gt; $tree_name);</div>
<div class="line">    push @trees, $tree;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  process the data and generate the nodes</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $line (@data) {</div>
<div class="line">        $csv-&gt;parse ($line);</div>
<div class="line">        my @line_array = $csv-&gt;fields;</div>
<div class="line">        my %line_hash;</div>
<div class="line">        @line_hash{@header} = @line_array;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (defined $line_h{TREENAME} &amp;&amp; $tree_name ne $line_hash{TREENAME}) {  # we have started a <span class="keyword">new</span> tree</div>
<div class="line"><span class="preprocessor">            #  clean up the previous tree</span></div>
<div class="line"><span class="preprocessor"></span>            $self-&gt;assign_parents_for_tabular_tree_import (</div>
<div class="line">                tree_ref  =&gt; $tree,</div>
<div class="line">                node_hash =&gt; $node_hash,</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  and start afresh</span></div>
<div class="line"><span class="preprocessor"></span>            $tree_name = $line_hash{TREENAME};</div>
<div class="line">            $tree = Biodiverse::Tree-&gt;new (NAME =&gt; $tree_name);</div>
<div class="line">            push @trees, $tree;</div>
<div class="line">            $node_hash = {};</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        my $node_name = $line_hash{NAME};</div>
<div class="line">        <span class="keywordflow">if</span> (!defined $node_name) {</div>
<div class="line">            $node_name = $tree-&gt;get_free_internal_name;</div>
<div class="line">            $line_hash{NAME} = $node_name;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $tree-&gt;add_node (</div>
<div class="line">            name   =&gt; $node_name,</div>
<div class="line">            length =&gt; $line_hash{LENGTHTOPARENT},</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        my $node_number = $line_hash{NODE_NUMBER};</div>
<div class="line">        $node_hash-&gt;{$node_number} = \%line_hash;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;assign_parents_for_tabular_tree_import (</div>
<div class="line">        tree_ref  =&gt; $tree,</div>
<div class="line">        node_hash =&gt; $node_hash,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $tree_ref (@trees) {</div>
<div class="line">        $self-&gt;add_tree (tree =&gt; $tree_ref);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9bbeec85aa09937f72f5424d3ea799fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-new' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-new-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-new-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-new-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in new: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <span class="keyword">new</span> {</div>
<div class="line">    my $class = shift;</div>
<div class="line">    </div>
<div class="line">    my %PARAMS = (</div>
<div class="line">        JOIN_CHAR   =&gt; q{:},</div>
<div class="line">        QUOTES      =&gt; q{<span class="stringliteral">&#39;},</span></div>
<div class="line"><span class="stringliteral">    );</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    my $self = bless {</span></div>
<div class="line"><span class="stringliteral">        &#39;</span>TREE_ARRAY<span class="stringliteral">&#39; =&gt; [],</span></div>
<div class="line"><span class="stringliteral">    }, $class;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    $self-&gt;set_params (%PARAMS, @_);</span></div>
<div class="line"><span class="stringliteral">    $self-&gt;set_default_params;  #  and any user overrides</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    return $self;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a806b2eddd4f19932fe98de34480e6ea0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::numerically </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-numerically' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-numerically-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-numerically-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-numerically-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in numerically: 52</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a806b2eddd4f19932fe98de34480e6ea0">numerically</a> {$a &lt;=&gt; $b};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">__END__</div>
<div class="line"></div>
<div class="line">=head1 NAME</div>
<div class="line"></div>
<div class="line">Biodiverse::????</div>
<div class="line"></div>
<div class="line">=head1 SYNOPSIS</div>
<div class="line"></div>
<div class="line">  use Biodiverse::????;</div>
<div class="line">  $object = <a class="code" href="classBiodiverse_1_1Statistics.html">Biodiverse::Statistics</a>-&gt;<a class="code" href="classBiodiverse_1_1Statistics.html#a06fc6da973eebcb8a48cbd8ebcf90b9f">new</a>();</div>
<div class="line"></div>
<div class="line">=head1 DESCRIPTION</div>
<div class="line"></div>
<div class="line">TO BE FILLED IN</div>
<div class="line"></div>
<div class="line">=head1 METHODS</div>
<div class="line"></div>
<div class="line">=over</div>
<div class="line"></div>
<div class="line">=item INSERT METHODS</div>
<div class="line"></div>
<div class="line">=back</div>
<div class="line"></div>
<div class="line">=head1 REPORTING ERRORS</div>
<div class="line"></div>
<div class="line">Use the issue tracker at http:<span class="comment">//www.purl.org/biodiverse</span></div>
<div class="line"></div>
<div class="line">=head1 COPYRIGHT</div>
<div class="line"></div>
<div class="line">Copyright (c) 2010 Shawn Laffan. All rights reserved.  </div>
<div class="line"></div>
<div class="line">=head1 LICENSE</div>
<div class="line"></div>
<div class="line">This program is free software: you can redistribute it and/or modify</div>
<div class="line">it under the terms of the GNU General Public License as published by</div>
<div class="line">the Free Software Foundation, either version 3 of the License, or</div>
<div class="line">(at your option) any later version.</div>
<div class="line"></div>
<div class="line">This program is distributed in the hope that it will be useful,</div>
<div class="line">but WITHOUT ANY WARRANTY; without even the implied warranty of</div>
<div class="line">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</div>
<div class="line">GNU General Public License <span class="keywordflow">for</span> more details.</div>
<div class="line"></div>
<div class="line">For a full copy of the license see &lt;http:<span class="comment">//www.gnu.org/licenses/&gt;.</span></div>
<div class="line"></div>
<div class="line">=cut</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a337903aec0a356f16b1b5720049b31db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::parse_newick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-parse_newick' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-parse_newick-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-parse_newick-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-parse_newick-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in parse_newick: 243</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a337903aec0a356f16b1b5720049b31db">parse_newick</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $string = $args{<span class="keywordtype">string</span>};</div>
<div class="line">    my $str_len = length ($string);</div>
<div class="line">    my $tree = $args{tree};</div>
<div class="line">    my $tree_name = $tree-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line"></div>
<div class="line">    my $node_count             = $args{node_count};</div>
<div class="line">    my $translate_hash         = $args{translate_hash}</div>
<div class="line">                               || $self-&gt;get_param (<span class="stringliteral">&#39;TRANSLATE_HASH&#39;</span>);</div>
<div class="line">    my $element_properties     = $args{element_properties}</div>
<div class="line">                               || $self-&gt;get_param (<span class="stringliteral">&#39;ELEMENT_PROPERTIES&#39;</span>);</div>
<div class="line">    my $use_element_properties = $self-&gt;get_param (<span class="stringliteral">&#39;USE_ELEMENT_PROPERTIES&#39;</span>);</div>
<div class="line"></div>
<div class="line">    my $quote_char = $self-&gt;get_param (<span class="stringliteral">&#39;QUOTES&#39;</span>) || q{<span class="stringliteral">&#39;};</span></div>
<div class="line"><span class="stringliteral">    my $csv_obj    = $self-&gt;get_csv_object (quote_char =&gt; $quote_char);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $name;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $default_length = 0;</span></div>
<div class="line"><span class="stringliteral">    my $length = $default_length;</span></div>
<div class="line"><span class="stringliteral">    my $boot_value;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my @nodes_added;</span></div>
<div class="line"><span class="stringliteral">    my @children_of_current_node;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    pos ($string) = 0;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    while (not $string =~ m/ \G \z /xgcs) {  #  haven&#39;</span>t hit the end of line yet</div>
<div class="line"><span class="preprocessor">        #print &quot;\nParsing $string\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #print &quot;Nodecount is $$node_count\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">        #  march through any whitespace and newlines</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> ($string =~ m/ \G [\s\n\r]+ /xgcs) {  </div>
<div class="line"><span class="preprocessor">            #print &quot;found some whitespace\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  we have a comma or are at the end of the string, so we create this node and start a new one</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G (,)/xgcs) {  </div>
<div class="line"><span class="preprocessor">            #if ($1 =~ /,/) {  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            ##    #print &quot;found a comma\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #}</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #else {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #    #print &quot;hit the end of line\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #}</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> (not defined $name) {</div>
<div class="line">                $name = $tree-&gt;get_free_internal_name (</div>
<div class="line">                    exclude =&gt; $translate_hash,</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (exists $translate_hash-&gt;{$name}) {</div>
<div class="line">                $name = $translate_hash-&gt;{$name} ;</div>
<div class="line">            }</div>
<div class="line">            $name =~ s{^$quote_char} {};  #  strip any bounding quotes - let the next csv line decide</div>
<div class="line">            $name =~ s{$quote_char$} {};</div>
<div class="line"><span class="preprocessor">            #  and now we need to make the name use the CSV rules used everywhere else</span></div>
<div class="line"><span class="preprocessor"></span>            $name = $self-&gt;list2csv (csv_object =&gt; $csv_obj, list =&gt; [$name]);</div>
<div class="line">            <span class="keywordflow">if</span> ($use_element_properties) {</div>
<div class="line">                my $element = $element_properties-&gt;get_element_remapped (</div>
<div class="line">                    element =&gt; $name,</div>
<div class="line">                );</div>
<div class="line"></div>
<div class="line">                my $original_name = $name;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (defined $element) {</div>
<div class="line">                    $name = $element;</div>
<div class="line">                    print <span class="stringliteral">&quot;$tree_name: Remapped $original_name to $element\n&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #print &quot;Adding new node to tree, name is $name, length is $length\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            my $node = $self-&gt;add_node_to_tree (</div>
<div class="line">                tree   =&gt; $tree,</div>
<div class="line">                name   =&gt; $name,</div>
<div class="line">                length =&gt; $length,</div>
<div class="line">                boot   =&gt; $boot_value,</div>
<div class="line">                translate_hash =&gt; $translate_hash,</div>
<div class="line">            );</div>
<div class="line">            push @nodes_added, $node;</div>
<div class="line"><span class="preprocessor">            #  add any relevant children</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> (scalar @children_of_current_node) {</div>
<div class="line">                $node-&gt;add_children (children =&gt; \@children_of_current_node);</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">            #  reset name, length and children</span></div>
<div class="line"><span class="preprocessor"></span>            $$node_count ++;</div>
<div class="line">            $name = undef;</div>
<div class="line">            $length = undef;</div>
<div class="line">            @children_of_current_node = ();</div>
<div class="line">            $boot_value = undef;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  use positive look-ahead to find if we start with an opening bracket</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G (?= \( ) /xgcs) {  </div>
<div class="line"><span class="preprocessor">            #print &quot;found an open bracket\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            </div>
<div class="line">            <span class="keywordflow">if</span> ($string =~ m/\G \( ( $re_text_in_brackets) \) /xgcs) {</div>
<div class="line">                my $sub_newick = $1;</div>
<div class="line"><span class="preprocessor">                #print &quot;Eating to closing bracket\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>                </div>
<div class="line">                @children_of_current_node = $self-&gt;parse_newick (</div>
<div class="line">                    <span class="keywordtype">string</span> =&gt; $sub_newick,</div>
<div class="line">                    tree =&gt; $tree,</div>
<div class="line">                    node_count =&gt; $node_count,</div>
<div class="line">                    translate_hash =&gt; $translate_hash,</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                pos $string = 0;</div>
<div class="line">                my @left_side  = ($string =~ / \( /gx);</div>
<div class="line">                my @right_side = ($string =~ / \) /gx);</div>
<div class="line">                my $left_count  = scalar @left_side;</div>
<div class="line">                my $right_count = scalar @right_side;</div>
<div class="line">                croak <span class="stringliteral">&quot;Tree has unbalanced parentheses &quot;</span></div>
<div class="line">                      . <span class="stringliteral">&quot;(left is $left_count, &quot;</span></div>
<div class="line">                      . <span class="stringliteral">&quot;right is $right_count), &quot;</span></div>
<div class="line">                      . <span class="stringliteral">&quot;unable to parse\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  do we have a square bracket for bootstrap and other values?</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G (?= \[ ) /xgcs) {  </div>
<div class="line"><span class="preprocessor">            #print &quot;found an open square bracket\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            </div>
<div class="line">            $string =~ m/\G \[ ( .*? ) \] /xgcs;</div>
<div class="line"><span class="preprocessor">            #print &quot;Eating to closing square bracket\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            </div>
<div class="line">            $boot_value = $1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  we have found a quote char, match to the next quote</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G (?=<span class="stringliteral">&#39;) /xgcs) { </span></div>
<div class="line"><span class="stringliteral">            #print &quot;found a quote char\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            </span></div>
<div class="line"><span class="stringliteral">            #$string =~ m/\G (.*?) &#39;</span> (?!<span class="stringliteral">&#39;)/xgcs;  </span></div>
<div class="line"><span class="stringliteral">            $string =~ m/\G ($RE_QUOTED) /xgcs;  #  eat up to the next non-escaped quote</span></div>
<div class="line"><span class="stringliteral">            $name = $1;</span></div>
<div class="line"><span class="stringliteral">            $name =~ s/^&#39;</span><span class="comment">//;  #  strip ack the quotes</span></div>
<div class="line">            $name =~ s/<span class="stringliteral">&#39;$//;</span></div>
<div class="line"><span class="stringliteral">            $name =~ s/&#39;</span><span class="charliteral">&#39;/&#39;</span>/g;</div>
<div class="line"><span class="preprocessor">            #print &#39;&#39;;</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  next value is a length if we have a colon</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G :/xgcs) {  </div>
<div class="line"><span class="preprocessor">            #print &quot;found a length value\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">            #  get the number - assumes it is in standard decimal form</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #$string =~ m/\G (\d* \.? \d*) /xgcs;</span></div>
<div class="line"><span class="preprocessor"></span>            $string =~ m/\G ( $RE_NUMBER ) /xgcs;</div>
<div class="line"><span class="preprocessor">            #print &quot;length value is $1\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>            $length = $1;</div>
<div class="line">            <span class="keywordflow">if</span> (! looks_like_number $length) {</div>
<div class="line">                <span class="keywordflow">if</span> (!defined $length) {</div>
<div class="line">                    $length = q{};</div>
<div class="line">                }</div>
<div class="line">                croak <span class="stringliteral">&quot;Length &#39;$length&#39; does not look like a number\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            $length += 0;  #  make it numeric</div>
<div class="line">            my $x = $length;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  next value is a name, but it can be empty</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #elsif ($string =~ m/ \G ( [\w\d]* )  /xgcs) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  anything except special chars is fair game</span></div>
<div class="line"><span class="preprocessor"></span>        elsif ($string =~ m/ \G ( [^(),:<span class="stringliteral">&#39;\[\]]* )  /xgcs) {  </span></div>
<div class="line"><span class="stringliteral">            #print &quot;found a name value $1\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            #print &quot;\tbut it is anonymous\n&quot; if length ($1) == 0;</span></div>
<div class="line"><span class="stringliteral">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            </span></div>
<div class="line"><span class="stringliteral">            #$string =~ m/\G (.+?)\b /xgcs;  #  match to the next word boundary</span></div>
<div class="line"><span class="stringliteral">            $name = $1;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">        #  unexpected character found, or other failure - croak</span></div>
<div class="line"><span class="stringliteral">        else { </span></div>
<div class="line"><span class="stringliteral">            #print &quot;found nothing valid\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            #print &quot;$string\n&quot;;</span></div>
<div class="line"><span class="stringliteral">            $string =~ m/ \G ( . )  /xgcs;</span></div>
<div class="line"><span class="stringliteral">            my $char = $1;</span></div>
<div class="line"><span class="stringliteral">            my $posn = pos ($string);</span></div>
<div class="line"><span class="stringliteral">            croak &quot;[ReadNexus] Unexpected character &#39;</span>$char<span class="stringliteral">&#39; found at position $posn\n&quot;;</span></div>
<div class="line"><span class="stringliteral">        }  </span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    #print &quot;hit the end of line\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    #print &quot;Position is &quot; . (pos $string) . &quot; of $str_len\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    #  the following is a duplicate of code from above, but converting to a sub uses</span></div>
<div class="line"><span class="stringliteral">    #  almost as many lines as the two blocks combined</span></div>
<div class="line"><span class="stringliteral">    if (not defined $name) {</span></div>
<div class="line"><span class="stringliteral">        #print &quot;Tree is $tree&quot;;</span></div>
<div class="line"><span class="stringliteral">        $name = $tree-&gt;get_free_internal_name (exclude =&gt; $translate_hash);</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    if (exists $translate_hash-&gt;{$name}) {</span></div>
<div class="line"><span class="stringliteral">        $name = $translate_hash-&gt;{$name};</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    #  strip any quotes - let list2csv decide</span></div>
<div class="line"><span class="stringliteral">    if (my @components = $name =~ $RE_TEXT_IN_QUOTES) {</span></div>
<div class="line"><span class="stringliteral">        $name = $components[1];</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    #  and now we need to make the name use the CSV rules used everywhere else</span></div>
<div class="line"><span class="stringliteral">    $name = $self-&gt;list2csv (csv_object =&gt; $csv_obj, list =&gt; [$name]);</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    if ($use_element_properties) {</span></div>
<div class="line"><span class="stringliteral">        my $element = $element_properties-&gt;get_element_remapped (element =&gt; $name);</span></div>
<div class="line"><span class="stringliteral">        my $original_name = $name;</span></div>
<div class="line"><span class="stringliteral">        $name = $element if defined $element;</span></div>
<div class="line"><span class="stringliteral">        if (defined $element) {</span></div>
<div class="line"><span class="stringliteral">            print &quot;$tree_name: Remapped $original_name to $element\n&quot;;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $node = $self-&gt;add_node_to_tree (</span></div>
<div class="line"><span class="stringliteral">        tree   =&gt; $tree,</span></div>
<div class="line"><span class="stringliteral">        name   =&gt; $name,</span></div>
<div class="line"><span class="stringliteral">        length =&gt; $length,</span></div>
<div class="line"><span class="stringliteral">        boot   =&gt; $boot_value,</span></div>
<div class="line"><span class="stringliteral">        translate_hash =&gt; $translate_hash,</span></div>
<div class="line"><span class="stringliteral">    );</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    push @nodes_added, $node;</span></div>
<div class="line"><span class="stringliteral">    #  add any relevant children</span></div>
<div class="line"><span class="stringliteral">    $node-&gt;add_children (children =&gt; \@children_of_current_node) if scalar @children_of_current_node;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    return wantarray ? @nodes_added : \@nodes_added;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">#  add a node to the tree, avoiding duplicates as we go</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a09695bbaa9640cae23b0f92ee01b8160"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::process_unrooted_trees </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-process_unrooted_trees' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-process_unrooted_trees-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-process_unrooted_trees-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-process_unrooted_trees-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in process_unrooted_trees: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a09695bbaa9640cae23b0f92ee01b8160">process_unrooted_trees</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my @trees = $self-&gt;get_tree_array;</div>
<div class="line">    </div>
<div class="line">    BY_LOADED_TREE:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $tree (@trees) {</div>
<div class="line">        $tree-&gt;root_unrooted_tree;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a208954625c8cc2d2a3b714cd41bc190b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::process_zero_length_trees </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-process_zero_length_trees' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-process_zero_length_trees-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-process_zero_length_trees-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-process_zero_length_trees-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in process_zero_length_trees: 28</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#a208954625c8cc2d2a3b714cd41bc190b">process_zero_length_trees</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my @trees = $self-&gt;get_tree_array;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  now we check if the tree has all zero-length nodes.  Change these to length 1.</span></div>
<div class="line"><span class="preprocessor"></span>    BY_LOADED_TREE:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $tree (@trees) {</div>
<div class="line">        my %nodes = $tree-&gt;get_node_hash;</div>
<div class="line">        my $len_sum = 0;</div>
<div class="line"></div>
<div class="line">        LEN_SUM:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node (values %nodes) {</div>
<div class="line">            $len_sum += $node-&gt;get_length;</div>
<div class="line">            last LEN_SUM <span class="keywordflow">if</span> $len_sum;  #  drop out <span class="keywordflow">if</span> we have a non-zero length</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ($len_sum == 0) {</div>
<div class="line">            print <span class="stringliteral">&quot;[READNEXUS] All nodes are of length zero, converting all to length 1\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">foreach</span> my $node (values %nodes) {</div>
<div class="line">                $node-&gt;set_length (length =&gt; 1);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af5ed3758333e3bab3eb51e41113e2c9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::ReadNexus::read_whole_file </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-read_whole_file' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-read_whole_file-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-read_whole_file-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-read_whole_file-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in read_whole_file: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1ReadNexus.html#af5ed3758333e3bab3eb51e41113e2c9b">read_whole_file</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $file = $args{file};</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;file arg not specified\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> not defined $file;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we open the file and suck it al in</span></div>
<div class="line"><span class="preprocessor"></span>    my $fh;</div>
<div class="line">    open ($fh, <span class="stringliteral">&#39;&lt;:via(File::BOM)&#39;</span>, $file)</div>
<div class="line">      || croak <span class="stringliteral">&quot;[READNEXUS] cannot open $file for reading\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    local $/ = undef;</div>
<div class="line">    my $text = &lt;$fh&gt;;  #  suck the whole thing in</div>
<div class="line">    $fh-&gt;close || croak <span class="stringliteral">&quot;Cannot close $file\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $text;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  parse the sub tree into its component nodes</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/Biodiverse/<a class="el" href="ReadNexus_8pm_source.html">ReadNexus.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Biodiverse</b></li><li class="navelem"><a class="el" href="classBiodiverse_1_1ReadNexus.html">ReadNexus</a></li>
    <li class="footer">Generated on Tue Nov 5 2013 19:07:26 for Biodiverse by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
