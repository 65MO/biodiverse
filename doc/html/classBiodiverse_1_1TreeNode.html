<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Biodiverse: Biodiverse::TreeNode Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Biodiverse
   &#160;<span id="projectnumber">0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classBiodiverse_1_1TreeNode.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classBiodiverse_1_1TreeNode-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Biodiverse::TreeNode Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Biodiverse::TreeNode:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBiodiverse_1_1TreeNode__coll__graph.png" border="0" usemap="#Biodiverse_1_1TreeNode_coll__map" alt="Collaboration graph"/></div>
<map name="Biodiverse_1_1TreeNode_coll__map" id="Biodiverse_1_1TreeNode_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a572756a2daf2b183240c073420f1c3a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a572756a2daf2b183240c073420f1c3a3"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>EMPTY_STRING</b></td></tr>
<tr class="separator:a572756a2daf2b183240c073420f1c3a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c9e9f76fcdfbc579af1830044f3a4d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a48c9e9f76fcdfbc579af1830044f3a4d"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>SPACE</b></td></tr>
<tr class="separator:a48c9e9f76fcdfbc579af1830044f3a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec1338038a4fd090063b92ab08bd08c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaec1338038a4fd090063b92ab08bd08c"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>default_length</b></td></tr>
<tr class="separator:aaec1338038a4fd090063b92ab08bd08c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Avaliable Methods</h2></td></tr>
<tr class="memitem:aaea3e6e029396e83e5c59e1cb057a094"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aaea3e6e029396e83e5c59e1cb057a094">set_node_as_parent</a> ()</td></tr>
<tr class="separator:aaea3e6e029396e83e5c59e1cb057a094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72e23ff2d36d75dc8b14f50b03744202"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a72e23ff2d36d75dc8b14f50b03744202">set_parent</a> ()</td></tr>
<tr class="separator:a72e23ff2d36d75dc8b14f50b03744202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08174510e15cd79f1e9626bce61a69b7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a08174510e15cd79f1e9626bce61a69b7">print</a> ()</td></tr>
<tr class="separator:a08174510e15cd79f1e9626bce61a69b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f6e3eff11556006c6815bdca41984ef"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a6f6e3eff11556006c6815bdca41984ef">to_table_group_nodes</a> ()</td></tr>
<tr class="separator:a6f6e3eff11556006c6815bdca41984ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed08e40fb4e94a7758c9abd3acbf210"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9ed08e40fb4e94a7758c9abd3acbf210">delete_child</a> ()</td></tr>
<tr class="separator:a9ed08e40fb4e94a7758c9abd3acbf210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec865e88cabfeab7fac7c55158111f3d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aec865e88cabfeab7fac7c55158111f3d">reset_total_length_below</a> ()</td></tr>
<tr class="separator:aec865e88cabfeab7fac7c55158111f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39695d897dd9a71f0ae9aac8a78a4ad6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a39695d897dd9a71f0ae9aac8a78a4ad6">set_cached_value</a> ()</td></tr>
<tr class="separator:a39695d897dd9a71f0ae9aac8a78a4ad6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c303022408c802b7def25103f676eec"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a6c303022408c802b7def25103f676eec">get_length_below</a> ()</td></tr>
<tr class="separator:a6c303022408c802b7def25103f676eec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007984955fb02a39dad4f383143a0a00"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> ()</td></tr>
<tr class="separator:a007984955fb02a39dad4f383143a0a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a076df2cb30e18d04f2d355697b709d47"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a076df2cb30e18d04f2d355697b709d47">get_max_total_length</a> ()</td></tr>
<tr class="separator:a076df2cb30e18d04f2d355697b709d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c0d540ccd26715a550e0ddf6dd0330"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a94c0d540ccd26715a550e0ddf6dd0330">add_to_lists</a> ()</td></tr>
<tr class="separator:a94c0d540ccd26715a550e0ddf6dd0330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9fe561b2fe963b79ef1d6ddef0dd47"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a5b9fe561b2fe963b79ef1d6ddef0dd47">set_parents_below</a> ()</td></tr>
<tr class="separator:a5b9fe561b2fe963b79ef1d6ddef0dd47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a72ce41f3bba96cd75ddabc901c4e30"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a6a72ce41f3bba96cd75ddabc901c4e30">get_shared_ancestor</a> ()</td></tr>
<tr class="separator:a6a72ce41f3bba96cd75ddabc901c4e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaadbc4c044d9e3d0ac19ec79ae34f2ff"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aaadbc4c044d9e3d0ac19ec79ae34f2ff">add_children</a> ()</td></tr>
<tr class="separator:aaadbc4c044d9e3d0ac19ec79ae34f2ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1480555b85a512b4873ccea73cd6edd3"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a1480555b85a512b4873ccea73cd6edd3">get_depth</a> ()</td></tr>
<tr class="separator:a1480555b85a512b4873ccea73cd6edd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fdf52afedbced5c20a6165528f961f1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a3fdf52afedbced5c20a6165528f961f1">get_path_lengths_to_ancestral_node</a> ()</td></tr>
<tr class="separator:a3fdf52afedbced5c20a6165528f961f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1f63b59d01c1e0028a622eb788add66"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aa1f63b59d01c1e0028a622eb788add66">delete_lists_below</a> ()</td></tr>
<tr class="separator:aa1f63b59d01c1e0028a622eb788add66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3579a478345df4c7304e1f5de46d44"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9e3579a478345df4c7304e1f5de46d44">get_all_children</a> ()</td></tr>
<tr class="separator:a9e3579a478345df4c7304e1f5de46d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe73627180266dc072b96b14e4472f9"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a1fe73627180266dc072b96b14e4472f9">to_table</a> ()</td></tr>
<tr class="separator:a1fe73627180266dc072b96b14e4472f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5437821e81eb38a27b9631a219c5b8a0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a5437821e81eb38a27b9631a219c5b8a0">get_child_count</a> ()</td></tr>
<tr class="separator:a5437821e81eb38a27b9631a219c5b8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b2a3fa5dd2516b9d7a7b5041a772b2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a73b2a3fa5dd2516b9d7a7b5041a772b2">to_basestruct_group_nodes</a> ()</td></tr>
<tr class="separator:a73b2a3fa5dd2516b9d7a7b5041a772b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01577fe87d051ae4ad852d4c13eb8b9f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a01577fe87d051ae4ad852d4c13eb8b9f">get_terminal_elements</a> ()</td></tr>
<tr class="separator:a01577fe87d051ae4ad852d4c13eb8b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48bfa36ee3b53a984872331fee4e880"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ad48bfa36ee3b53a984872331fee4e880">get_lists</a> ()</td></tr>
<tr class="separator:ad48bfa36ee3b53a984872331fee4e880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d1ab5e7a7af87b3e701a6be99e07bc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a62d1ab5e7a7af87b3e701a6be99e07bc">get_cached_value</a> ()</td></tr>
<tr class="separator:a62d1ab5e7a7af87b3e701a6be99e07bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1921f0adcc85995c4a114ac50265621e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a1921f0adcc85995c4a114ac50265621e">get_length</a> ()</td></tr>
<tr class="separator:a1921f0adcc85995c4a114ac50265621e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad811725ab0f541dcaa5b5b78b5a0410d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ad811725ab0f541dcaa5b5b78b5a0410d">get_cached_value_keys</a> ()</td></tr>
<tr class="separator:ad811725ab0f541dcaa5b5b78b5a0410d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7190966890b224eaf62e63af51775b82"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a7190966890b224eaf62e63af51775b82">weaken_parent_ref</a> ()</td></tr>
<tr class="separator:a7190966890b224eaf62e63af51775b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ccc11788adc6555646c308383773d88"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a2ccc11788adc6555646c308383773d88">get_path_length_to_node</a> ()</td></tr>
<tr class="separator:a2ccc11788adc6555646c308383773d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64cc41196ccda14a66a08f7f244f8d80"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a64cc41196ccda14a66a08f7f244f8d80">get_list_names</a> ()</td></tr>
<tr class="separator:a64cc41196ccda14a66a08f7f244f8d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af37e9406baf74a91571caf9a0097dc40"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#af37e9406baf74a91571caf9a0097dc40">has_child</a> ()</td></tr>
<tr class="separator:af37e9406baf74a91571caf9a0097dc40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019663049283b52e6cffaea5e20cde71"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a019663049283b52e6cffaea5e20cde71">get_root_node</a> ()</td></tr>
<tr class="separator:a019663049283b52e6cffaea5e20cde71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b43ba24c8fa9904cc375cb8aa66f24"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a33b43ba24c8fa9904cc375cb8aa66f24">reset_total_length</a> ()</td></tr>
<tr class="separator:a33b43ba24c8fa9904cc375cb8aa66f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a319555f4f89dd5ea1e3e6c25dc79d668"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a319555f4f89dd5ea1e3e6c25dc79d668">is_root_node</a> ()</td></tr>
<tr class="separator:a319555f4f89dd5ea1e3e6c25dc79d668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b68f2e873d99e6d56f2753bdef3f9c4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9b68f2e873d99e6d56f2753bdef3f9c4">get_terminal_node_refs</a> ()</td></tr>
<tr class="separator:a9b68f2e873d99e6d56f2753bdef3f9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711d4e1f02124ce52acb39be56d85cea"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a711d4e1f02124ce52acb39be56d85cea">get_path_lengths_to_root_node</a> ()</td></tr>
<tr class="separator:a711d4e1f02124ce52acb39be56d85cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a518230b17251ae13d3d70099265ada"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9a518230b17251ae13d3d70099265ada">get_node_range</a> ()</td></tr>
<tr class="separator:a9a518230b17251ae13d3d70099265ada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2c12a4d75a4a2a243bdc4fd47cc320"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aec2c12a4d75a4a2a243bdc4fd47cc320">get_path_to_root_node</a> ()</td></tr>
<tr class="separator:aec2c12a4d75a4a2a243bdc4fd47cc320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01504743c6a467679553d3ca5d6d4dd"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aa01504743c6a467679553d3ca5d6d4dd">delete_cached_values</a> ()</td></tr>
<tr class="separator:aa01504743c6a467679553d3ca5d6d4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4d4cc44544f58f8eae3d21cd147f9e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#acb4d4cc44544f58f8eae3d21cd147f9e">flatten_tree</a> ()</td></tr>
<tr class="separator:acb4d4cc44544f58f8eae3d21cd147f9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690399043c7c8e24cd599dc0707a0c1f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a690399043c7c8e24cd599dc0707a0c1f">get_all_descendents</a> ()</td></tr>
<tr class="separator:a690399043c7c8e24cd599dc0707a0c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d6052e48f688fffa89ef39d4b4456c5"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a8d6052e48f688fffa89ef39d4b4456c5">is_internal_node</a> ()</td></tr>
<tr class="separator:a8d6052e48f688fffa89ef39d4b4456c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a6588a6d8f1177419c8fc96265f202"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a94a6588a6d8f1177419c8fc96265f202">get_value</a> ()</td></tr>
<tr class="separator:a94a6588a6d8f1177419c8fc96265f202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc8604a9d386c82d4c1fc7f97f8a238"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a8dc8604a9d386c82d4c1fc7f97f8a238">to_newick</a> ()</td></tr>
<tr class="separator:a8dc8604a9d386c82d4c1fc7f97f8a238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c47488d553f4bc9f82103672df0966"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ac5c47488d553f4bc9f82103672df0966">new</a> ()</td></tr>
<tr class="separator:ac5c47488d553f4bc9f82103672df0966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac01ac1ab997907327425cf29cee1aae9"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ac01ac1ab997907327425cf29cee1aae9">shuffle_terminal_names</a> ()</td></tr>
<tr class="separator:ac01ac1ab997907327425cf29cee1aae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6aadee926e54e61ca1b221daa2f59a5"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aa6aadee926e54e61ca1b221daa2f59a5">get_list_ref</a> ()</td></tr>
<tr class="separator:aa6aadee926e54e61ca1b221daa2f59a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abadfbcc04c2a8582d2d6fddee97f5107"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#abadfbcc04c2a8582d2d6fddee97f5107">group_nodes_below</a> ()</td></tr>
<tr class="separator:abadfbcc04c2a8582d2d6fddee97f5107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59219484b71c4e9c7bd819e9296c171"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ac59219484b71c4e9c7bd819e9296c171">get_child_count_below</a> ()</td></tr>
<tr class="separator:ac59219484b71c4e9c7bd819e9296c171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90c9c130174f695f74b95137e8088570"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a90c9c130174f695f74b95137e8088570">delete_lists</a> ()</td></tr>
<tr class="separator:a90c9c130174f695f74b95137e8088570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9633dfea5b69e188d92fe93839dd326e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9633dfea5b69e188d92fe93839dd326e">get_depth_below</a> ()</td></tr>
<tr class="separator:a9633dfea5b69e188d92fe93839dd326e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13a9568fb0350fb6eb5e3d97ef7aa4a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#af13a9568fb0350fb6eb5e3d97ef7aa4a">delete_children</a> ()</td></tr>
<tr class="separator:af13a9568fb0350fb6eb5e3d97ef7aa4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f61d5db5ca7e896de5b6cbc30e1370"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ad7f61d5db5ca7e896de5b6cbc30e1370">get_max_list_length_below</a> ()</td></tr>
<tr class="separator:ad7f61d5db5ca7e896de5b6cbc30e1370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352c588d819c23c5df68f29685408249"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a352c588d819c23c5df68f29685408249">number_terminal_nodes</a> ()</td></tr>
<tr class="separator:a352c588d819c23c5df68f29685408249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a622005b2d4f2049e03322fa406e0999b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a622005b2d4f2049e03322fa406e0999b">set_depth</a> ()</td></tr>
<tr class="separator:a622005b2d4f2049e03322fa406e0999b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6675a788ae058c6ff8c59b8cdf9cc256"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a6675a788ae058c6ff8c59b8cdf9cc256">get_length_above</a> ()</td></tr>
<tr class="separator:a6675a788ae058c6ff8c59b8cdf9cc256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2602a98611e5846f9f818b01eff1dcd0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a2602a98611e5846f9f818b01eff1dcd0">set_length</a> ()</td></tr>
<tr class="separator:a2602a98611e5846f9f818b01eff1dcd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1beafa86a12ef6d3fa3c38f990ab84e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aa1beafa86a12ef6d3fa3c38f990ab84e">get_list_names_below</a> ()</td></tr>
<tr class="separator:aa1beafa86a12ef6d3fa3c38f990ab84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbff741d922dc2b93ac607eadf31879a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#abbff741d922dc2b93ac607eadf31879a">get_hash_lists</a> ()</td></tr>
<tr class="separator:abbff741d922dc2b93ac607eadf31879a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08bbcbc836e949798dcf182ff8925d93"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a08bbcbc836e949798dcf182ff8925d93">get_total_length</a> ()</td></tr>
<tr class="separator:a08bbcbc836e949798dcf182ff8925d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd4ec9e659ea524c785d064faf0fec2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#aefd4ec9e659ea524c785d064faf0fec2">get_children</a> ()</td></tr>
<tr class="separator:aefd4ec9e659ea524c785d064faf0fec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae110f3fb87a8b0af0544d3cc615f15a0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ae110f3fb87a8b0af0544d3cc615f15a0">get_parent</a> ()</td></tr>
<tr class="separator:ae110f3fb87a8b0af0544d3cc615f15a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80041d7fbcba44fdcb73a44dfeacf34f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a80041d7fbcba44fdcb73a44dfeacf34f">set_name</a> ()</td></tr>
<tr class="separator:a80041d7fbcba44fdcb73a44dfeacf34f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a7b1d41395e6992538d8ed45e712281"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a4a7b1d41395e6992538d8ed45e712281">raise_zerolength_children</a> ()</td></tr>
<tr class="separator:a4a7b1d41395e6992538d8ed45e712281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09b9d34ce3ea7aa5ee3611dac93dde33"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a09b9d34ce3ea7aa5ee3611dac93dde33">get_hash_lists_below</a> ()</td></tr>
<tr class="separator:a09b9d34ce3ea7aa5ee3611dac93dde33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7147deb32993fe0adfeb4d2fa33080a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ad7147deb32993fe0adfeb4d2fa33080a">get_path_to_node</a> ()</td></tr>
<tr class="separator:ad7147deb32993fe0adfeb4d2fa33080a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a7b7337c9ffc622d7b83a80b24b5b0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a81a7b7337c9ffc622d7b83a80b24b5b0">to_nexus</a> ()</td></tr>
<tr class="separator:a81a7b7337c9ffc622d7b83a80b24b5b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd9c6c27a5a22a1080258c8f92f397c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a7dd9c6c27a5a22a1080258c8f92f397c">set_child_lengths</a> ()</td></tr>
<tr class="separator:a7dd9c6c27a5a22a1080258c8f92f397c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a735d84e7d8099e5df68cc5f8f959a983"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a735d84e7d8099e5df68cc5f8f959a983">is_tree_node</a> ()</td></tr>
<tr class="separator:a735d84e7d8099e5df68cc5f8f959a983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab623255d96270bf75f348d827c0f43e8"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ab623255d96270bf75f348d827c0f43e8">get_terminal_element_count</a> ()</td></tr>
<tr class="separator:ab623255d96270bf75f348d827c0f43e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d8b85fb25f2ce0553fc401cd4b6ed2b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a8d8b85fb25f2ce0553fc401cd4b6ed2b">get_all_descendents_and_self</a> ()</td></tr>
<tr class="separator:a8d8b85fb25f2ce0553fc401cd4b6ed2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31747198a40223638a233424f87f0562"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a31747198a40223638a233424f87f0562">is_terminal_node</a> ()</td></tr>
<tr class="separator:a31747198a40223638a233424f87f0562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a090d2fbc41a416b473f1e446800bf0f0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a090d2fbc41a416b473f1e446800bf0f0">assign_plot_coords</a> ()</td></tr>
<tr class="separator:a090d2fbc41a416b473f1e446800bf0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101b25a1590e6584267eaa340a12d2f1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a101b25a1590e6584267eaa340a12d2f1">delete_values</a> ()</td></tr>
<tr class="separator:a101b25a1590e6584267eaa340a12d2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651b377b67bb88e68b3d73ffd9e03b53"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a651b377b67bb88e68b3d73ffd9e03b53">assign_plot_coords_inner</a> ()</td></tr>
<tr class="separator:a651b377b67bb88e68b3d73ffd9e03b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d95ff2056fd8428e1f843df59cf947"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#ab5d95ff2056fd8428e1f843df59cf947">number_nodes</a> ()</td></tr>
<tr class="separator:ab5d95ff2056fd8428e1f843df59cf947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e983565cba18161c6c44de25b0f18c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a97e983565cba18161c6c44de25b0f18c">set_value</a> ()</td></tr>
<tr class="separator:a97e983565cba18161c6c44de25b0f18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07218aa5a8874c4eb14e782f60cab750"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a07218aa5a8874c4eb14e782f60cab750">delete_cached_values_below</a> ()</td></tr>
<tr class="separator:a07218aa5a8874c4eb14e782f60cab750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3c3c8f80494a90bb8612eb96689532"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1TreeNode.html#a9b3c3c8f80494a90bb8612eb96689532">get_name</a> ()</td></tr>
<tr class="separator:a9b3c3c8f80494a90bb8612eb96689532"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="TreeNode_8pm_source.html#l00016">16</a> of file <a class="el" href="TreeNode_8pm_source.html">TreeNode.pm</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aaadbc4c044d9e3d0ac19ec79ae34f2ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::add_children </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_children' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_children-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_children-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_children-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_children: 41</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aaadbc4c044d9e3d0ac19ec79ae34f2ff">add_children</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! exists ($args{children});  #  should croak</div>
<div class="line">    </div>
<div class="line">    croak <span class="stringliteral">&quot;TreeNode WARNING: children argument not an array ref\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> ref($args{children}) !~ /ARRAY/;</div>
<div class="line"></div>
<div class="line">    CHILD:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@{$args{children}}) {</div>
<div class="line">        next <span class="keywordflow">if</span> $self-&gt;has_child (node_ref =&gt; $child);  #  don<span class="stringliteral">&#39;t re-add our own child</span></div>
<div class="line"><span class="stringliteral">        if ($self-&gt;is_tree_node(node =&gt; $child)) {</span></div>
<div class="line"><span class="stringliteral">            if (defined $child-&gt;get_parent) {  #  too many parents - this is a single parent system</span></div>
<div class="line"><span class="stringliteral">                if ($args{warn}) {</span></div>
<div class="line"><span class="stringliteral">                    print &#39;</span>TreeNode WARNING: child <span class="stringliteral">&#39;</span></div>
<div class="line"><span class="stringliteral">                          . $self-&gt;get_name .</span></div>
<div class="line"><span class="stringliteral">                          &quot; already has parent, resetting\n&quot;;</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral">                $child-&gt;get_parent-&gt;delete_child (child =&gt; $child);</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        #  not a tree node, and not a ref, so make it one</span></div>
<div class="line"><span class="stringliteral">        my $tmp;</span></div>
<div class="line"><span class="stringliteral">        if (! $self-&gt;is_tree_node(node =&gt; $child)) {</span></div>
<div class="line"><span class="stringliteral">            if (! ref($child)) {</span></div>
<div class="line"><span class="stringliteral">                $tmp = Biodiverse::TreeNode-&gt;new(name =&gt; $child);</span></div>
<div class="line"><span class="stringliteral">                $child = $tmp;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">            else {</span></div>
<div class="line"><span class="stringliteral">                croak &quot;Warning: Cannot add $child as a child - already a blessed object\n&quot;;</span></div>
<div class="line"><span class="stringliteral">                next CHILD;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        push @{$self-&gt;{_CHILDREN}}, $child;</span></div>
<div class="line"><span class="stringliteral">        $child-&gt;set_parent(parent =&gt; $self);</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    return;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a94c0d540ccd26715a550e0ddf6dd0330"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::add_to_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-add_to_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-add_to_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-add_to_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-add_to_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in add_to_lists: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a94c0d540ccd26715a550e0ddf6dd0330">add_to_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  create the list if not already there and then add to it</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">while</span> (my ($list, $values) = each %args) {    </div>
<div class="line">        <span class="keywordflow">if</span> ((ref $values) =~ /HASH/) {</div>
<div class="line">            $self-&gt;{$list} = {} <span class="keywordflow">if</span> ! exists $self-&gt;{$list};</div>
<div class="line">            next <span class="keywordflow">if</span> ! scalar keys %$values;</div>
<div class="line">            @{$self-&gt;{$list}}{keys %$values} = values %$values;  #  add <span class="keyword">using</span> a slice</div>
<div class="line">        }</div>
<div class="line">        elsif ((ref $values) =~ /ARRAY/) {</div>
<div class="line">            $self-&gt;{$list} = [] <span class="keywordflow">if</span> ! exists $self-&gt;{$list};</div>
<div class="line">            next <span class="keywordflow">if</span> ! scalar @$values;</div>
<div class="line">            push @{$self-&gt;{$list}}, @$values;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            carp <span class="stringliteral">&quot;add_to_lists warning, no valid list ref passed\n&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  delete a set of lists at this node</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a090d2fbc41a416b473f1e446800bf0f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::assign_plot_coords </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-assign_plot_coords' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-assign_plot_coords-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-assign_plot_coords-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-assign_plot_coords-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in assign_plot_coords: 28</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a090d2fbc41a416b473f1e446800bf0f0">assign_plot_coords</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    $self-&gt;get_root_node-&gt;number_terminal_nodes;</div>
<div class="line"></div>
<div class="line">    my $y_len = $self-&gt;get_terminal_element_count;</div>
<div class="line">    my $x_len = $self-&gt;get_max_total_length;</div>
<div class="line">    my $scale_factor = $args{plot_coords_scale_factor};</div>
<div class="line">    <span class="keywordflow">if</span> (not $scale_factor or $scale_factor &lt; 0) {</div>
<div class="line"><span class="preprocessor">        #$scale_factor =</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #    $y_len &lt; $x_len</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  ? $y_len / $x_len</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  : $x_len / $y_len;</span></div>
<div class="line"><span class="preprocessor"></span>        $scale_factor = $x_len / $y_len;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $max_y = $self-&gt;get_value(<span class="stringliteral">&#39;TERMINAL_NODE_LAST&#39;</span>);</div>
<div class="line"></div>
<div class="line">    $self-&gt;assign_plot_coords_inner (</div>
<div class="line">        scale_factor =&gt; $scale_factor,</div>
<div class="line">        max_y        =&gt; $max_y,</div>
<div class="line">        plot_coords_left_to_right =&gt; $args{plot_coords_left_to_right},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a651b377b67bb88e68b3d73ffd9e03b53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::assign_plot_coords_inner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-assign_plot_coords_inner' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-assign_plot_coords_inner-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-assign_plot_coords_inner-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-assign_plot_coords_inner-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in assign_plot_coords_inner: 73</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a651b377b67bb88e68b3d73ffd9e03b53">assign_plot_coords_inner</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $scale_factor  = $args{scale_factor} || 1;</div>
<div class="line">    my $max_y         = $args{max_y} || 0;</div>
<div class="line">    my $left_to_right = $args{plot_coords_left_to_right};</div>
<div class="line"></div>
<div class="line">    my ($y1, $y2, $y_pos);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_terminal_node) {</div>
<div class="line">        $y1 = $max_y - $self-&gt;get_value(<span class="stringliteral">&#39;TERMINAL_NODE_FIRST&#39;</span>);</div>
<div class="line">        $y2 = $max_y - $self-&gt;get_value(<span class="stringliteral">&#39;TERMINAL_NODE_LAST&#39;</span>);</div>
<div class="line">        $y_pos = $scale_factor * ($y1 + $y2) / 2;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        my @ch_y_pos;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $child (@{$self-&gt;get_children}) {</div>
<div class="line">            $child-&gt;assign_plot_coords_inner (%args);</div>
<div class="line">            my $coords = $child-&gt;get_list_ref (list =&gt; <span class="stringliteral">&#39;PLOT_COORDS&#39;</span>);</div>
<div class="line">            push @ch_y_pos, $coords-&gt;{plot_y1};</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $y1 = List::Util::max (@ch_y_pos);</div>
<div class="line">        $y2 = List::Util::min (@ch_y_pos);</div>
<div class="line">        $y_pos = ($y1 + $y2) / 2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  all dists relative to max length of the tree</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  have to compensate for get_length_above including this node</span></div>
<div class="line"><span class="preprocessor"></span>    my $end_x   = $self-&gt;get_root_node-&gt;get_max_total_length - $self-&gt;get_length_above + $self-&gt;get_length;</div>
<div class="line">    my $start_x = $end_x - $self-&gt;get_length;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my $vx = $start_x &lt; $end_x  #  need this before the correction, but looks overcomplicated to be honest</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  ? $start_x  #  monotonic case</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  : $end_x;   #  reversal case</span></div>
<div class="line"><span class="preprocessor"></span>    my $vx = $start_x;</div>
<div class="line"><span class="preprocessor">    # kludge - need to clean up total_length calcs?</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    # Or create abs_pos subs to account for negative node lengths</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #if ($self-&gt;get_length &lt; 0) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    $end_x   += $self-&gt;get_length;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    $start_x += $self-&gt;get_length;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($left_to_right) {</div>
<div class="line">        $vx      *= -1;</div>
<div class="line">        $end_x   *= -1;</div>
<div class="line">        $start_x *= -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %coords = (</div>
<div class="line">        plot_y1 =&gt; $y_pos,</div>
<div class="line">        plot_y2 =&gt; $y_pos,</div>
<div class="line">        plot_x1 =&gt; $start_x,</div>
<div class="line">        plot_x2 =&gt; $end_x,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %vert_coords = (</div>
<div class="line">        vplot_y1 =&gt; $y1,</div>
<div class="line">        vplot_y2 =&gt; $y2,</div>
<div class="line">        vplot_x1 =&gt; $vx,</div>
<div class="line">        vplot_x2 =&gt; $vx,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    $self-&gt;add_to_lists(</div>
<div class="line">        PLOT_COORDS      =&gt; \%coords,</div>
<div class="line">        PLOT_COORDS_VERT =&gt; \%vert_coords,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  number the nodes below this one based on the terminal nodes</span></div>
<div class="line"><span class="preprocessor">#  this allows us to export to CSV and retain some of the topology</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa01504743c6a467679553d3ca5d6d4dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_cached_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_cached_values' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_cached_values-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_cached_values-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_cached_values-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_cached_values: 29</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aa01504743c6a467679553d3ca5d6d4dd">delete_cached_values</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! exists $self-&gt;{_cache};</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #no warnings &#39;uninitialized&#39;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #if ((blessed $self-&gt;{_cache}{_cluster_colour}) =~ /Gtk2/) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    print Data::Dumper::Dumper ($self-&gt;{_cache}{_cluster_colour});</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    my $keys = $args{keys} || $self-&gt;get_cached_value_keys;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> not defined $keys or scalar @$keys == 0;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">delete</span> @{$self-&gt;{_cache}}{@$keys};</div>
<div class="line">    <span class="keyword">delete</span> $self-&gt;{_cache} <span class="keywordflow">if</span> scalar keys %{$self-&gt;{_cache}} == 0;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #warn &quot;Cache deletion problem at node &quot; . $self-&gt;get_name . &quot;\n$EVAL_ERROR\n&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  if $EVAL_ERROR;</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line"><span class="preprocessor">    #warn &quot;XXXXXXX &quot;  . $self-&gt;get_name . &quot;\n&quot; if exists $self-&gt;{_cache};</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  was trying to avoid memory leaks, to no avail</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#use Sub::Current;  </span></div>
<div class="line"><span class="preprocessor">#use feature &#39;current_sub&#39;;</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a07218aa5a8874c4eb14e782f60cab750"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_cached_values_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_cached_values_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_cached_values_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_cached_values_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_cached_values_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_cached_values_below: 15</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a07218aa5a8874c4eb14e782f60cab750">delete_cached_values_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  this approach seems to avoid memory leaks</span></div>
<div class="line"><span class="preprocessor"></span>    my %descendents = $self-&gt;get_all_descendents (cache =&gt; 0);</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node (values %descendents) {</div>
<div class="line">        $node-&gt;delete_cached_values (%args);</div>
<div class="line">    }</div>
<div class="line">    $self-&gt;delete_cached_values (%args);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9ed08e40fb4e94a7758c9abd3acbf210"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_child </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_child' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_child-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_child-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_child-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_child: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9ed08e40fb4e94a7758c9abd3acbf210">delete_child</a> {  #  <span class="keyword">remove</span> a child from a list.</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $i = 0;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        <span class="keywordflow">if</span> ($child eq $args{child}) {</div>
<div class="line">            splice (@{$self-&gt;{_CHILDREN}}, $i, 1);</div>
<div class="line">            $child-&gt;delete_cached_values_below;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        $i++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;  #  <span class="keywordflow">return</span> undefined <span class="keywordflow">if</span> nothing removed</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af13a9568fb0350fb6eb5e3d97ef7aa4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_children </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_children' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_children-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_children-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_children-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_children: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#af13a9568fb0350fb6eb5e3d97ef7aa4a">delete_children</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    croak <span class="stringliteral">&quot;children argument not specified or not an array ref&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> ! defined $args{children} || ! ref ($args{children}) =~ /ARRAY/;</div>
<div class="line">    my $count = 0;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@{$args{children}}) {</div>
<div class="line"><span class="preprocessor">        #  function returns 1 if it deletes something, undef otherwise</span></div>
<div class="line"><span class="preprocessor"></span>        $count ++ <span class="keywordflow">if</span> (defined $self-&gt;delete_child (child =&gt; $child));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> $count;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a90c9c130174f695f74b95137e8088570"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_lists: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a90c9c130174f695f74b95137e8088570">delete_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $lists = $args{lists};</div>
<div class="line">    croak <span class="stringliteral">&quot;argument &#39;lists&#39; not defined or not an array\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> not defined $lists or (ref $lists) !~ /ARRAY/;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $list (@$lists) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! exists $self-&gt;{$list};</div>
<div class="line">        $self-&gt;{$list} = undef;</div>
<div class="line">        <span class="keyword">delete</span> $self-&gt;{$list};</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  delete a set of lists at this node, and all its descendents</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa1f63b59d01c1e0028a622eb788add66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_lists_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_lists_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_lists_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_lists_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_lists_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_lists_below: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aa1f63b59d01c1e0028a622eb788add66">delete_lists_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    $self-&gt;delete_lists (@_);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        $child-&gt;delete_lists_below (@_);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a101b25a1590e6584267eaa340a12d2f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::delete_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-delete_values' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-delete_values-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-delete_values-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-delete_values-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in delete_values: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a101b25a1590e6584267eaa340a12d2f1">delete_values</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    <span class="keyword">delete</span> $self-&gt;{NODE_VALUES}{keys %args};</div>
<div class="line"><span class="preprocessor">    #foreach my $key (@{$args{keys}}) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    delete $self-&gt;{NODE_VALUES}{$key};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="acb4d4cc44544f58f8eae3d21cd147f9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::flatten_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-flatten_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-flatten_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-flatten_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-flatten_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in flatten_tree: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#acb4d4cc44544f58f8eae3d21cd147f9e">flatten_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $iter = 0;</div>
<div class="line">    my $count = 1;</div>
<div class="line">    my @empty_nodes;</div>
<div class="line">    print <span class="stringliteral">&quot;[TREENODE] FLATTENING TREE.  &quot;</span>;</div>
<div class="line">    <span class="keywordflow">while</span> ($count &gt; 0) {</div>
<div class="line">        my %raised = $self-&gt;raise_zerolength_children;</div>
<div class="line">        print <span class="stringliteral">&quot; Raised $raised{raised_count},&quot;</span>;</div>
<div class="line">        $iter ++;</div>
<div class="line">        push @empty_nodes, @{$raised{empty_node_names}};</div>
<div class="line">        $count = $raised{raised_count};</div>
<div class="line">    }</div>
<div class="line">    print <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @empty_nodes : \@empty_nodes;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  raise any zero length children to be children of the parents (siblings of this node).</span></div>
<div class="line"><span class="preprocessor">#  return a hash containing the count of the children raised and an array of any now empty nodes</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9e3579a478345df4c7304e1f5de46d44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_all_children </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_all_children' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_all_children-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_all_children-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_all_children-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_all_children: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9e3579a478345df4c7304e1f5de46d44">get_all_children</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_all_descendents (@_);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a690399043c7c8e24cd599dc0707a0c1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_all_descendents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_all_descendents' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_all_descendents-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_all_descendents-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_all_descendents-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_all_descendents: 43</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a690399043c7c8e24cd599dc0707a0c1f">get_all_descendents</a> { #  <span class="keyword">get</span> all the nodes (whether terminal or not) which are descendants of a node</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (</div>
<div class="line">        cache =&gt; 1, #  cache unless told otherwise</div>
<div class="line">        @_,</div>
<div class="line">    );  </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_terminal_node) {</div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? () : {};  #  empty hash by <span class="keywordflow">default</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  we have cached values from a previous pass - return them unless told not to</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        my $cached_hash = $self-&gt;get_cached_value(<span class="stringliteral">&#39;DESCENDENTS&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ($cached_hash) {  # <span class="keywordflow">return</span> copies to avoid later pollution</div>
<div class="line">            <span class="keywordflow">return</span> wantarray ? %$cached_hash : {%$cached_hash};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @list;</div>
<div class="line">    push @list, $self-&gt;get_children;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@list) {</div>
<div class="line">        push @list, $child-&gt;get_children;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">    #  the values are really a hash, and need to be coerced into one when used</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  hashes save memory when using globally repeated keys and are more flexible</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my @hash_list;</span></div>
<div class="line"><span class="preprocessor"></span>    my %list;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node (@list) {</div>
<div class="line">        my $name = $node-&gt;get_name;</div>
<div class="line">        $list{$name} = $node;</div>
<div class="line">        weaken $list{$name};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value(DESCENDENTS =&gt; \%list);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  make sure we return copies to avoid pollution by other subs</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span> wantarray ? %list : {%list};</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  while loop cleaner than recursion</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8d8b85fb25f2ce0553fc401cd4b6ed2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_all_descendents_and_self </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_all_descendents_and_self' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_all_descendents_and_self-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_all_descendents_and_self-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_all_descendents_and_self-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_all_descendents_and_self: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a8d8b85fb25f2ce0553fc401cd4b6ed2b">get_all_descendents_and_self</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %descendents = $self-&gt;get_all_descendents(@_);</div>
<div class="line">    my $name = $self-&gt;get_name;</div>
<div class="line">    $descendents{$name} = $self;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_name (keys %descendents) {</div>
<div class="line">        <span class="keywordflow">if</span> (! isweak $descendents{$node_name}) {</div>
<div class="line">            weaken $descendents{$node_name};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %descendents : \%descendents;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  a left over - here just in case </span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a62d1ab5e7a7af87b3e701a6be99e07bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_cached_value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_cached_value' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_cached_value-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_cached_value-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_cached_value-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_cached_value: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a62d1ab5e7a7af87b3e701a6be99e07bc">get_cached_value</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $key = shift;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! exists $self-&gt;{_cache};</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{_cache}{$key} <span class="keywordflow">if</span> exists $self-&gt;{_cache}{$key};</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad811725ab0f541dcaa5b5b78b5a0410d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_cached_value_keys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_cached_value_keys' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_cached_value_keys-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_cached_value_keys-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_cached_value_keys-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_cached_value_keys: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ad811725ab0f541dcaa5b5b78b5a0410d">get_cached_value_keys</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! exists $self-&gt;{_cache};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray</div>
<div class="line">        ? keys %{$self-&gt;{_cache}}</div>
<div class="line">        : [keys %{$self-&gt;{_cache}}];</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5437821e81eb38a27b9631a219c5b8a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_child_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_child_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_child_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_child_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_child_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_child_count: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a5437821e81eb38a27b9631a219c5b8a0">get_child_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> $#{$self-&gt;{_CHILDREN}} + 1;</div>
<div class="line">}</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor"># should be get_terminal_node_count</span></div>
<div class="line"><span class="preprocessor"># same as get_terminal_element_count, so just pass it on</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac59219484b71c4e9c7bd819e9296c171"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_child_count_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_child_count_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_child_count_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_child_count_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_child_count_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_child_count_below: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ac59219484b71c4e9c7bd819e9296c171">get_child_count_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_terminal_element_count (@_);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get a hash of the nodes below this one based on length</span></div>
<div class="line"><span class="preprocessor">#  accounts for recursion in the tree</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aefd4ec9e659ea524c785d064faf0fec2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_children </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_children' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_children-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_children-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_children-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_children: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aefd4ec9e659ea524c785d064faf0fec2">get_children</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> not defined $self-&gt;{_CHILDREN};</div>
<div class="line">    my @children = @{$self-&gt;{_CHILDREN}}; #  messy, but seeing <span class="keywordflow">if</span> we can avoid mem leaks</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @children : \@children;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a1480555b85a512b4873ccea73cd6edd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_depth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_depth' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_depth-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_depth-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_depth-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_depth: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a1480555b85a512b4873ccea73cd6edd3">get_depth</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #return $self-&gt;{DEPTH} if defined $self-&gt;{DEPTH}; # overwrite as needed - saves messing about with cached values</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_root_node) {</div>
<div class="line">        $self-&gt;set_depth(depth =&gt; 0);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="preprocessor">        #  recursively search up the tree</span></div>
<div class="line"><span class="preprocessor"></span>        $self-&gt;set_depth(depth =&gt; ($self-&gt;get_parent-&gt;get_depth + 1));</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{NODE_VALUES}{DEPTH};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9633dfea5b69e188d92fe93839dd326e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_depth_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_depth_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_depth_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_depth_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_depth_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_depth_below: 21</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9633dfea5b69e188d92fe93839dd326e">get_depth_below</a> {  #  gets the deepest depth below the caller in total tree units</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_depth <span class="keywordflow">if</span> $self-&gt;is_terminal_node;  # no elements, <span class="keywordflow">return</span> its depth</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {  #  lots of conditions, but should save a little number crunching overall.</div>
<div class="line">        my $cached_value = $self-&gt;get_cached_value (<span class="stringliteral">&#39;DEPTH_BELOW&#39;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> $cached_value <span class="keywordflow">if</span> defined $cached_value;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $maxDepthBelow = 0;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@{$self-&gt;get_children}) {</div>
<div class="line">        my $depthBelowChild = $child-&gt;get_depth_below;</div>
<div class="line">        $maxDepthBelow = $depthBelowChild <span class="keywordflow">if</span> $depthBelowChild &gt; $maxDepthBelow;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    $self-&gt;set_cached_value (DEPTH_BELOW =&gt; $maxDepthBelow) <span class="keywordflow">if</span> $args{cache};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $maxDepthBelow;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abbff741d922dc2b93ac607eadf31879a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_hash_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_hash_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_hash_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_hash_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_hash_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_hash_lists: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#abbff741d922dc2b93ac607eadf31879a">get_hash_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my @list;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $tmp (keys %{$self}) {</div>
<div class="line">        next <span class="keywordflow">if</span> $tmp =~ /^_/;  #  skip the internals</div>
<div class="line">        push @list, $tmp <span class="keywordflow">if</span> ref($self-&gt;{$tmp}) =~ /HASH/;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> @list <span class="keywordflow">if</span> wantarray;</div>
<div class="line">    <span class="keywordflow">return</span> \@list;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a09b9d34ce3ea7aa5ee3611dac93dde33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_hash_lists_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_hash_lists_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_hash_lists_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_hash_lists_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_hash_lists_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_hash_lists_below: 17</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a09b9d34ce3ea7aa5ee3611dac93dde33">get_hash_lists_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my @list = $self-&gt;get_hash_lists;</div>
<div class="line">    my %hash_list;</div>
<div class="line">    @hash_list{@list} = undef;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@{$self-&gt;get_children}) {</div>
<div class="line">        my $list_below = $child-&gt;get_hash_lists_below;</div>
<div class="line">        @hash_list{@$list_below} = undef;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray</div>
<div class="line">        ? keys %hash_list</div>
<div class="line">        : [keys %hash_list];</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a1921f0adcc85995c4a114ac50265621e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_length: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a1921f0adcc85995c4a114ac50265621e">get_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> defined $self-&gt;{NODE_VALUES}{LENGTH} ? $self-&gt;{NODE_VALUES}{LENGTH} : $default_length;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  loop through all the parent nodes and sum their lengths up to a target node (root by default)</span></div>
<div class="line"><span class="preprocessor">#  should be renamed to get_length_to_root</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6675a788ae058c6ff8c59b8cdf9cc256"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_length_above </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_length_above' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_length_above-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_length_above-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_length_above-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_length_above: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a6675a788ae058c6ff8c59b8cdf9cc256">get_length_above</a> {  </div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    no warnings qw /uninitialized/;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_length</div>
<div class="line">        <span class="keywordflow">if</span> $self-&gt;is_root_node</div>
<div class="line">            || $self eq $args{target_ref}</div>
<div class="line">            || $self-&gt;get_name eq $args{target_node};    </div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_length</div>
<div class="line">            + $self-&gt;get_parent-&gt;get_length_above (%args);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6c303022408c802b7def25103f676eec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_length_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_length_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_length_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_length_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_length_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_length_below: 31</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a6c303022408c802b7def25103f676eec">get_length_below</a> {  </div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);  #  defaults to caching</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_length <span class="keywordflow">if</span> $self-&gt;is_terminal_node;  # no children</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {  #  lots of conditions, but should save a little number crunching overall.</div>
<div class="line">        my $cached_length = $self-&gt;get_cached_value (<span class="stringliteral">&#39;LENGTH_BELOW&#39;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> $cached_length <span class="keywordflow">if</span> defined $cached_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $max_length_below = 0;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        my $length_below_child = $child-&gt;get_length_below (%args) || 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ($length_below_child &gt; $max_length_below) {</div>
<div class="line">            $max_length_below = $length_below_child;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $length = $self-&gt;get_length + $max_length_below;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value (LENGTH_BELOW =&gt; $length);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $length;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a64cc41196ccda14a66a08f7f244f8d80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_list_names </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_list_names' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_list_names-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_list_names-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_list_names-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_list_names: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a64cc41196ccda14a66a08f7f244f8d80">get_list_names</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? keys %$self : [keys %$self];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get a list of all the lists contained in the tree below and including this node</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa1beafa86a12ef6d3fa3c38f990ab84e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_list_names_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_list_names_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_list_names_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_list_names_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_list_names_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_list_names_below: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aa1beafa86a12ef6d3fa3c38f990ab84e">get_list_names_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my %list_hash;</div>
<div class="line">    my $lists = $self-&gt;get_list_names;</div>
<div class="line">    @list_hash{@$lists} = 1 x scalar @$lists;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        $lists = $child-&gt;get_list_names_below (%args);</div>
<div class="line">        @list_hash{@$lists} = 1 x scalar @$lists;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (! $args{show_hidden_lists}) {  # a bit of repeated cleanup, but we need to guarantee we <span class="keyword">get</span> them <span class="keywordflow">if</span> needed</div>
<div class="line">        <span class="keywordflow">foreach</span> my $key (keys %list_hash) {</div>
<div class="line">            <span class="keyword">delete</span> $list_hash{$key} <span class="keywordflow">if</span> $key =~ /^_/;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? keys %list_hash : [keys %list_hash];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  how long are the lists below?</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa6aadee926e54e61ca1b221daa2f59a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_list_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_list_ref' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_list_ref-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_list_ref-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_list_ref-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_list_ref: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aa6aadee926e54e61ca1b221daa2f59a5">get_list_ref</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{list};</div>
<div class="line">    exists $self-&gt;{$list} ? $self-&gt;{$list} : undef;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad48bfa36ee3b53a984872331fee4e880"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_lists: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ad48bfa36ee3b53a984872331fee4e880">get_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? values %$self : [values %$self];</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad7f61d5db5ca7e896de5b6cbc30e1370"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_max_list_length_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_max_list_length_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_max_list_length_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_max_list_length_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_max_list_length_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_max_list_length_below: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ad7f61d5db5ca7e896de5b6cbc30e1370">get_max_list_length_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list_name = $args{list};</div>
<div class="line">    </div>
<div class="line">    my $length;</div>
<div class="line">    </div>
<div class="line">    my $list_ref = $self-&gt;get_list_ref (%args);</div>
<div class="line">    <span class="keywordflow">if</span> ((ref $list_ref) =~ /ARRAY/) {</div>
<div class="line">        $length = scalar @$list_ref;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {  #  must be a hash</div>
<div class="line">        $length = scalar keys %$list_ref;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        my $ch_length = $child-&gt;get_max_list_length_below (%args);</div>
<div class="line">        $length = $ch_length <span class="keywordflow">if</span> $ch_length &gt; $length;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $length;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a076df2cb30e18d04f2d355697b709d47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_max_total_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_max_total_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_max_total_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_max_total_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_max_total_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_max_total_length: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a076df2cb30e18d04f2d355697b709d47">get_max_total_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_total_length <span class="keywordflow">if</span> $self-&gt;is_terminal_node;  # no children</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {  #  lots of conditions, but should save a little number crunching overall.</div>
<div class="line">        my $cached_length = $self-&gt;get_cached_value (<span class="stringliteral">&#39;MAX_TOTAL_LENGTH&#39;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> $cached_length <span class="keywordflow">if</span> defined $cached_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $max_length = $self-&gt;get_total_length;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@{$self-&gt;get_children}) {</div>
<div class="line">        my $child_length = $child-&gt;get_max_total_length (%args) || 0;  #  pass on the args</div>
<div class="line"></div>
<div class="line">        $max_length = $child_length <span class="keywordflow">if</span> $child_length &gt; $max_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value (MAX_TOTAL_LENGTH =&gt; $max_length);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $max_length;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  includes the length of the current node, so totalLength = lengthBelow+lengthAbove-selfLength</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9b3c3c8f80494a90bb8612eb96689532"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_name' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_name-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_name: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9b3c3c8f80494a90bb8612eb96689532">get_name</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"><span class="preprocessor">    #my %args = @_;</span></div>
<div class="line"><span class="preprocessor"></span>    croak <span class="stringliteral">&quot;name parameter missing\n&quot;</span> <span class="keywordflow">if</span> not exists ($self-&gt;{NODE_VALUES}{NAME});</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{NODE_VALUES}{NAME};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9a518230b17251ae13d3d70099265ada"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_node_range </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_range' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_range-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_range-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_range-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_range: 35</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9a518230b17251ae13d3d70099265ada">get_node_range</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $bd = $args{basedata_ref} || croak <span class="stringliteral">&quot;argument basedata_ref not provided\n&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  need to apply some caching using the $bd ref in the key</span></div>
<div class="line"><span class="preprocessor"></span>    my $cache_key = <span class="stringliteral">&#39;NODE_RANGE_&#39;</span> . $bd;</div>
<div class="line">    my $cached_range = $self-&gt;get_cached_value ($cache_key);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $cached_range <span class="keywordflow">if</span> defined $cached_range;</div>
<div class="line"></div>
<div class="line">    my @labels   = ($self-&gt;get_name);</div>
<div class="line">    my $children =  $self-&gt;get_all_descendents;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  collect the set of non-internal (named) nodes</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  Possibly should only work with terminals</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  which would simplify things.</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $name (keys %$children) {</div>
<div class="line">        next <span class="keywordflow">if</span> $children-&gt;{$name}-&gt;is_internal_node;</div>
<div class="line">        push (@labels, $name);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @range = $bd-&gt;get_range_union (labels =&gt; \@labels);</div>
<div class="line"></div>
<div class="line">    my $range = scalar @range;</div>
<div class="line"></div>
<div class="line">    $self-&gt;set_cached_value ($cache_key =&gt; $range);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $range;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  Could do as a Biodiverse::Tree method, but this allows us to work</span></div>
<div class="line"><span class="preprocessor">#  with clades within the tree.  B::Tree just has to modify its node hash.</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae110f3fb87a8b0af0544d3cc615f15a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_parent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_parent' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_parent-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_parent-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_parent-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_parent: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ae110f3fb87a8b0af0544d3cc615f15a0">get_parent</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{_PARENT};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a2ccc11788adc6555646c308383773d88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_path_length_to_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_length_to_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_length_to_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_length_to_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_length_to_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_length_to_node: 35</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a2ccc11788adc6555646c308383773d88">get_path_length_to_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (</div>
<div class="line">        cache =&gt; 1, #  cache unless told otherwise</div>
<div class="line">        @_,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $target = $args{node};</div>
<div class="line">    my $target_name = $target-&gt;get_name;</div>
<div class="line">    my $from_name = $self-&gt;get_name;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  maybe should make this a little more complex as a nested data structure?  Maybe a matrix?</span></div>
<div class="line"><span class="preprocessor"></span>    my $cache_list = <span class="stringliteral">&#39;LENGTH_TO_&#39;</span> . $target_name;  </div>
<div class="line"></div>
<div class="line">    my $length;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  we have cached values from a previous pass - return them unless told not to</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $length = $self-&gt;get_cached_value ($cache_list);</div>
<div class="line">        <span class="keywordflow">return</span> $length <span class="keywordflow">if</span> defined $length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $path = $self-&gt;get_path_to_node (@_);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $node (values %$path) {</div>
<div class="line">        $length += $node-&gt;get_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value ($cache_list =&gt; $length);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $length;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a3fdf52afedbced5c20a6165528f961f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_path_lengths_to_ancestral_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_lengths_to_ancestral_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_lengths_to_ancestral_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_lengths_to_ancestral_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_lengths_to_ancestral_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_lengths_to_ancestral_node: 41</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a3fdf52afedbced5c20a6165528f961f1">get_path_lengths_to_ancestral_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);</div>
<div class="line"></div>
<div class="line">    my $ancestor = $args{ancestral_node} or croak <span class="stringliteral">&quot;ancestral_node not defined\n&quot;</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_root_node) {</div>
<div class="line">        my %result = ($self-&gt;get_name, $self-&gt;get_length);</div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? %result : \%result;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  don&#39;t cache internals</span></div>
<div class="line"><span class="preprocessor"></span>    my $use_cache = $self-&gt;is_internal_node ? 0 : $args{cache};</div>
<div class="line"></div>
<div class="line">    my $cache_name;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $cache_name = <span class="stringliteral">&#39;PATH_LENGTHS_TO_ANCESTRAL_NODE:&#39;</span> . $ancestor-&gt;get_name;</div>
<div class="line">        my $path = $self-&gt;get_cached_value($cache_name);</div>
<div class="line">        <span class="keywordflow">return</span> (wantarray ? %$path : $path) <span class="keywordflow">if</span> $path;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %path_lengths;</div>
<div class="line">    my $node = $self;</div>
<div class="line">    <span class="keywordflow">while</span> ($node) {  #  undef when root node</div>
<div class="line">        $path_lengths{$node-&gt;get_name} = $node-&gt;get_length;</div>
<div class="line">        last <span class="keywordflow">if</span> $node eq $ancestor;</div>
<div class="line">        $node = $node-&gt;get_parent;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $self-&gt;set_cached_value ($cache_name =&gt; \%path_lengths);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %path_lengths : \%path_lengths;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  find a shared ancestor for a node</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  it will be the first parent node that shares one or more terminal elements</span></div>
<div class="line"><span class="preprocessor">#  Need to modify to use get_path_to_root_node and then get the segments that differ</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a711d4e1f02124ce52acb39be56d85cea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_path_lengths_to_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_lengths_to_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_lengths_to_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_lengths_to_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_lengths_to_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_lengths_to_root_node: 36</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a711d4e1f02124ce52acb39be56d85cea">get_path_lengths_to_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #if ($self-&gt;is_root_node) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    my %result = ($self-&gt;get_name, $self-&gt;get_length);</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    return wantarray ? %result : \%result;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #  don&#39;t cache internals</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my $use_cache = $self-&gt;is_internal_node ? 0 : $args{cache};</span></div>
<div class="line"><span class="preprocessor"></span>    my $use_cache = $args{cache};  #  cache internals</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        my $path = $self-&gt;get_cached_value(<span class="stringliteral">&#39;PATH_LENGTHS_TO_ROOT_NODE&#39;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> (wantarray ? %$path : $path) <span class="keywordflow">if</span> $path;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %path_lengths;</div>
<div class="line">    $path_lengths{$self-&gt;get_name} = $self-&gt;get_length;</div>
<div class="line"></div>
<div class="line">    my $node = $self-&gt;get_parent;</div>
<div class="line">    <span class="keywordflow">while</span> ($node) {  #  undef when root node</div>
<div class="line">        $path_lengths{$node-&gt;get_name} = $node-&gt;get_length;</div>
<div class="line">        $node = $node-&gt;get_parent;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $self-&gt;set_cached_value (PATH_LENGTHS_TO_ROOT_NODE =&gt; \%path_lengths);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %path_lengths : \%path_lengths;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get all the nodes along a path from self to another node,</span></div>
<div class="line"><span class="preprocessor">#  including self and other, and the shared ancestor</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad7147deb32993fe0adfeb4d2fa33080a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_path_to_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_to_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_to_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_to_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_to_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_to_node: 84</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ad7147deb32993fe0adfeb4d2fa33080a">get_path_to_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (</div>
<div class="line">        cache =&gt; 1, #  cache unless told otherwise</div>
<div class="line">        @_,</div>
<div class="line">    );  </div>
<div class="line">    </div>
<div class="line">    my $target = $args{node};</div>
<div class="line">    my $target_name = $target-&gt;get_name;</div>
<div class="line">    my $from_name = $self-&gt;get_name;</div>
<div class="line">    my $use_cache = $args{cache};</div>
<div class="line"><span class="preprocessor">    ##  don&#39;t cache internals to reduce memory footprint</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #if ($self-&gt;is_internal_node) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    $use_cache = 0;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $return_lengths = $args{return_lengths};  #  node refs or their lengths?</div>
<div class="line"></div>
<div class="line">    my $cache_pfx = $return_lengths ? <span class="stringliteral">&#39;PATH_LENGTHS_FROM::&#39;</span> : <span class="stringliteral">&#39;PATH_FROM::&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  maybe should make this a little more complex as a nested data structure?  Maybe a matrix?</span></div>
<div class="line"><span class="preprocessor"></span>    my $cache_list_name = $cache_pfx . $from_name . <span class="stringliteral">&#39;::TO::&#39;</span> . $target_name;  </div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  we have cached values from a previous pass - return them unless told not to</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        my $cached_path = $self-&gt;get_cached_value ($cache_list_name);</div>
<div class="line">        <span class="keywordflow">if</span> (not defined $cached_path ) {  #  <span class="keywordflow">try</span> the reverse, as they are the same</div>
<div class="line">            $cache_list_name = $cache_pfx . $target_name . <span class="stringliteral">&#39;::TO::&#39;</span> . $from_name;</div>
<div class="line">            $cached_path     = $self-&gt;get_cached_value ($cache_list_name);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (defined $cached_path ) {</div>
<div class="line">            <span class="keywordflow">return</span> wantarray ? %$cached_path : $cached_path;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $path = {};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  add ourselves to the path</span></div>
<div class="line"><span class="preprocessor"></span>    $path-&gt;{$from_name} = $return_lengths ? $self-&gt;get_length : $self;  #  we weaken $self ref below</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  THIS IS REALLY INEFFICIENT -</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  need to get path to root node for each of self and target</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  and then choose the section before and including the shared ancestor</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  using List::MoreUtils::before_incl</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($target_name ne $from_name) {</div>
<div class="line"><span class="preprocessor">        #  check if the target is one of our descendents</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  if yes then get the path downwards</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  else go up to the parent and try it from there</span></div>
<div class="line"><span class="preprocessor"></span>        my $descendents = $self-&gt;get_all_descendents;</div>
<div class="line">        <span class="keywordflow">if</span> (exists $descendents-&gt;{$target_name}) {</div>
<div class="line">            <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">                my $child_name = $child-&gt;get_name;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">                #  use the child or the child that is an ancestor of the target </span></div>
<div class="line"><span class="preprocessor"></span>                my $ch_descendents = $child-&gt;get_all_descendents;</div>
<div class="line">                <span class="keywordflow">if</span> ($child_name eq $target_name or exists $ch_descendents-&gt;{$target_name}) {  #  follow <span class="keyword">this</span> one</div>
<div class="line">                    my $sub_path = $child-&gt;get_path_to_node (@_);</div>
<div class="line">                    @$path{keys %$sub_path} = values %$sub_path;</div>
<div class="line">                    last;  #  and check no more children</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            my $sub_path = $self-&gt;get_parent-&gt;get_path_to_node (@_);</div>
<div class="line">            @$path{keys %$sub_path} = values %$sub_path;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">    #  make sure they are weak refs to ensure proper destruction when required</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> (not $return_lengths) {</div>
<div class="line">        <span class="keywordflow">foreach</span> my $value (values %$path) {</div>
<div class="line">            weaken $value <span class="keywordflow">if</span> ! isweak $value;</div>
<div class="line"><span class="preprocessor">            #print &quot;NOT WEAK $value\n&quot; if ! isweak $value;</span></div>
<div class="line"><span class="preprocessor"></span>        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $self-&gt;set_cached_value ($cache_list_name =&gt; $path);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %$path : $path;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get the length of the path to another node</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aec2c12a4d75a4a2a243bdc4fd47cc320"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_path_to_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_to_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_to_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_to_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_to_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_to_root_node: 35</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aec2c12a4d75a4a2a243bdc4fd47cc320">get_path_to_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);  #  cache unless told not to</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #return wantarray ? ($self) : [$self] if $self-&gt;is_root_node;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #  don&#39;t cache internals </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my $use_cache = $self-&gt;is_internal_node ? 0 : $args{cache};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my $use_cache = 1; # - override</span></div>
<div class="line"><span class="preprocessor"></span>    my $use_cache = $args{cache};</div>
<div class="line"></div>
<div class="line">    my $path;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $path = $self-&gt;get_cached_value(<span class="stringliteral">&#39;PATH_TO_ROOT_NODE&#39;</span>);</div>
<div class="line"><span class="preprocessor">        #print (&quot;using cache for &quot; . $self-&gt;get_name . &quot;\n&quot;) if $path;</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> wantarray ? @$path : $path</div>
<div class="line">          <span class="keywordflow">if</span> $path;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #$path = $self-&gt;get_parent-&gt;get_path_to_root_node (@_);</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #unshift @$path, $self;  #  used when recursing - needed to unwind</span></div>
<div class="line"><span class="preprocessor"></span>    my $node = $self;</div>
<div class="line">    <span class="keywordflow">while</span> ($node) {  #  undef when root node</div>
<div class="line">        push @$path, $node;</div>
<div class="line">        $node = $node-&gt;get_parent;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_cache) {</div>
<div class="line">        $self-&gt;set_cached_value (PATH_TO_ROOT_NODE =&gt; $path);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @$path : $path;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a019663049283b52e6cffaea5e20cde71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_root_node: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a019663049283b52e6cffaea5e20cde71">get_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self <span class="keywordflow">if</span> $self-&gt;is_root_node;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_parent-&gt;get_root_node;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  assign some plot coords to the nodes to allow reconstruction of</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  the dendrogram from a table</span></div>
<div class="line"><span class="preprocessor">#  need to assign terminal y-values in order, and the parents take the average of the terminal y values.  </span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6a72ce41f3bba96cd75ddabc901c4e30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_shared_ancestor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_shared_ancestor' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_shared_ancestor-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_shared_ancestor-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_shared_ancestor-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_shared_ancestor: 43</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a6a72ce41f3bba96cd75ddabc901c4e30">get_shared_ancestor</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (</div>
<div class="line">        cache =&gt; 1,</div>
<div class="line">        @_,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $compare = $args{node};</div>
<div class="line">    </div>
<div class="line">    my $cache_name = <span class="stringliteral">&#39;SHARED_ANCESTOR::&#39;</span> . $self . <span class="stringliteral">&#39;::TO::&#39;</span> . $compare;</div>
<div class="line">    <span class="keywordflow">if</span> (1) {  #  always use the cache <span class="keywordflow">if</span> it is available</div>
<div class="line">        my $cached_ancestor = $self-&gt;get_cached_value ($cache_name);</div>
<div class="line">        <span class="keywordflow">if</span> (not defined $cached_ancestor) {  #  <span class="keywordflow">try</span> the reverse, as they are the same</div>
<div class="line">            my $cache_name2  = <span class="stringliteral">&#39;SHARED_ANCESTOR::&#39;</span> . $compare . <span class="stringliteral">&#39;::TO::&#39;</span> . $self;</div>
<div class="line">            $cached_ancestor = $self-&gt;get_cached_value ($cache_name2);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (defined $cached_ancestor) {</div>
<div class="line">            <span class="keywordflow">return</span> wantarray ? %$cached_ancestor : $cached_ancestor;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %children = $self-&gt;get_terminal_elements;</div>
<div class="line">    my $count = scalar keys %children;</div>
<div class="line">    my %comp_children = $compare-&gt;get_terminal_elements;</div>
<div class="line">    <span class="keyword">delete</span> @children{keys %comp_children};  #  <span class="keyword">delete</span> shared keys</div>
<div class="line">    my $count2 = scalar keys %children;</div>
<div class="line"></div>
<div class="line">    my $shared;</div>
<div class="line">    <span class="keywordflow">if</span> ($count != $count2) {</div>
<div class="line">        $shared = $self;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        $shared = $self-&gt;get_parent-&gt;get_shared_ancestor (@_);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value ($cache_name =&gt; $shared);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $shared;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get the list of hashes in the nodes</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab623255d96270bf75f348d827c0f43e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_terminal_element_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_element_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_element_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_element_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_element_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_element_count: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ab623255d96270bf75f348d827c0f43e8">get_terminal_element_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $hash = $self-&gt;get_terminal_elements (@_);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> scalar keys %$hash;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a01577fe87d051ae4ad852d4c13eb8b9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_terminal_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_elements' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_elements-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_elements-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_elements-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_elements: 34</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a01577fe87d051ae4ad852d4c13eb8b9f">get_terminal_elements</a> { #  <span class="keyword">get</span> all the elements in the terminal nodes</div>
<div class="line"><span class="preprocessor">    #  need to add a cache option to reduce the amount of tree walking</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  - use  hash for this, but return the keys</span></div>
<div class="line"><span class="preprocessor"></span>    my $self = shift;</div>
<div class="line">    my %args = (cache =&gt; 1, @_);  #  cache unless told otherwise</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  we have cached values from a previous pass - return them unless told not to</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        my $cache_ref = $self-&gt;get_cached_value (<span class="stringliteral">&#39;TERMINAL_ELEMENTS&#39;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? %$cache_ref : $cache_ref</div>
<div class="line">          <span class="keywordflow">if</span> defined $cache_ref;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    my @list;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_terminal_node) {</div>
<div class="line">        push @list, ($self-&gt;get_name, 1);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">            push @list, $child-&gt;get_terminal_elements (%args);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  the values are really a hash, and need to be coerced into one when used</span></div>
<div class="line"><span class="preprocessor"></span>    my %list = @list;</div>
<div class="line">    <span class="keywordflow">if</span> ($args{cache}) {</div>
<div class="line">        $self-&gt;set_cached_value (TERMINAL_ELEMENTS =&gt; \%list);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %list : \%list;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9b68f2e873d99e6d56f2753bdef3f9c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_terminal_node_refs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_terminal_node_refs' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_terminal_node_refs-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_terminal_node_refs-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_terminal_node_refs-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_terminal_node_refs: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a9b68f2e873d99e6d56f2753bdef3f9c4">get_terminal_node_refs</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my %descendents = $self-&gt;get_all_descendents;</div>
<div class="line"></div>
<div class="line">    my %terminals;</div>
<div class="line">    <span class="keywordflow">while</span> (my ($name, $node_ref) = each %descendents) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! $node_ref-&gt;is_terminal_node;</div>
<div class="line">        $terminals{$name} = $node_ref;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %terminals : \%terminals;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a08bbcbc836e949798dcf182ff8925d93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_total_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_total_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_total_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_total_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_total_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_total_length: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a08bbcbc836e949798dcf182ff8925d93">get_total_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  use the stored value if exists</span></div>
<div class="line"><span class="preprocessor"></span>    my $tmp = $self-&gt;get_value (<span class="stringliteral">&#39;TOTAL_LENGTH&#39;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> $tmp <span class="keywordflow">if</span> defined $tmp;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_length_below;  #  calculate total length otherwise</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get the maximum tree node position from zero</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a94a6588a6d8f1177419c8fc96265f202"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::get_value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_value' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_value-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_value-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_value-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_value: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a94a6588a6d8f1177419c8fc96265f202">get_value</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $key = shift;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> exists $self-&gt;{NODE_VALUES}{$key}</div>
<div class="line">        ? $self-&gt;{NODE_VALUES}{$key}</div>
<div class="line">        : undef;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abadfbcc04c2a8582d2d6fddee97f5107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::group_nodes_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-group_nodes_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-group_nodes_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-group_nodes_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-group_nodes_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in group_nodes_below: 129</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#abadfbcc04c2a8582d2d6fddee97f5107">group_nodes_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $groups_needed = $args{num_clusters} || $self-&gt;get_child_count_below;</div>
<div class="line">    my %search_hash;</div>
<div class="line">    my %final_hash;</div>
<div class="line"></div>
<div class="line">    my $use_depth = $args{group_by_depth};  #  alternative is by length</div>
<div class="line"><span class="preprocessor">    #  a second method by which it may be passed</span></div>
<div class="line"><span class="preprocessor"></span>    $use_depth = 1 <span class="keywordflow">if</span> defined $args{type} &amp;&amp; $args{type} eq <span class="stringliteral">&#39;depth&#39;</span>;</div>
<div class="line"><span class="preprocessor">    #print &quot;[TREENODE] Grouping by &quot;, $use_depth ? &quot;depth&quot; : &quot;length&quot;, &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $target_value = $args{target_value};</div>
<div class="line"><span class="preprocessor">    #$target_value = 1 if defined $target_value;  #  for debugging</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #print &quot;[TREENODE] Target is $target_value\n&quot; if defined $target_value;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    $final_hash{$self-&gt;get_name} = $self;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_terminal_node) {</div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? %final_hash : \%final_hash;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my @current_nodes = ($self);</span></div>
<div class="line"><span class="preprocessor"></span>    my @current_nodes;</div>
<div class="line"></div>
<div class="line">    my $upper_value = $use_depth ? $self-&gt;get_depth : $self-&gt;get_length_below;</div>
<div class="line">    my $lower_value = $use_depth ? $self-&gt;get_depth + 1 : $self-&gt;get_length_below - $self-&gt;get_length;</div>
<div class="line">    ($lower_value, $upper_value) = sort <a class="code" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> ($lower_value, $upper_value) <span class="keywordflow">if</span> ! $use_depth; </div>
<div class="line">    $search_hash{$lower_value}{$upper_value}{$self-&gt;get_name} = $self;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (defined $target_value) {  #  check <span class="keywordflow">if</span> we have all we need</div>
<div class="line">        <span class="keywordflow">if</span> ($use_depth &amp;&amp; $target_value &lt;= $lower_value &amp;&amp; $target_value &gt;= $upper_value) {</div>
<div class="line">            <span class="keywordflow">return</span> wantarray ? %final_hash : \%final_hash;</div>
<div class="line">        }</div>
<div class="line">        elsif ($target_value &gt; $lower_value &amp;&amp; $target_value &lt;= $upper_value) {</div>
<div class="line">            <span class="keywordflow">return</span> wantarray ? %final_hash : \%final_hash;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    my $group_count = 1;</div>
<div class="line">    NODE_SEARCH: <span class="keywordflow">while</span> ($group_count &lt; $groups_needed) {</div>
<div class="line">        @current_nodes = values %{$search_hash{$lower_value}{$upper_value}};</div>
<div class="line"><span class="preprocessor">        #print &quot;check $i $upper_value\n&quot;; </span></div>
<div class="line"><span class="preprocessor"></span>        my $current_node_string = join ($EMPTY_STRING, sort @current_nodes);</div>
<div class="line">        <span class="keywordflow">foreach</span> my $current_node (@current_nodes) {</div>
<div class="line">            my @children = $current_node-&gt;get_children;</div>
<div class="line"></div>
<div class="line">            CNODE: <span class="keywordflow">foreach</span> my $child (@children) {</div>
<div class="line">                my $include_in_search = 1;  #  flag to include <span class="keyword">this</span> child in further searching</div>
<div class="line">                my ($upper_bound, $lower_bound);</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">if</span> ($child-&gt;is_terminal_node) {</div>
<div class="line">                    $include_in_search = 0;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> {  #  only consider length <span class="keywordflow">if</span> it has children</div>
<div class="line"><span class="preprocessor">                    #  and that length is from its children</span></div>
<div class="line"><span class="preprocessor"></span>                    <span class="keywordflow">if</span> ($use_depth) {</div>
<div class="line">                        $upper_bound = $child-&gt;get_depth;</div>
<div class="line">                        $lower_bound = $upper_bound + 1;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> {</div>
<div class="line">                        $upper_bound = $child-&gt;get_cached_value (<span class="stringliteral">&#39;UPPER_BOUND_LENGTH&#39;</span>);</div>
<div class="line">                        <span class="keywordflow">if</span> (defined $upper_bound) {</div>
<div class="line">                            $lower_bound = $child-&gt;get_cached_value (<span class="stringliteral">&#39;LOWER_BOUND_LENGTH&#39;</span>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> {</div>
<div class="line">                            my $length = $child-&gt;get_length;</div>
<div class="line">                            <span class="keywordflow">if</span> ($length &lt; 0) {  # recursion</div>
<div class="line">                                my $parent = $child-&gt;get_parent;</div>
<div class="line"><span class="preprocessor">                                #  parent_pos is wherever its children begin</span></div>
<div class="line"><span class="preprocessor"></span>                                my $parent_pos = $parent-&gt;get_length_below - $parent-&gt;get_length;</div>
<div class="line">                                $upper_bound = min ($parent_pos, $child-&gt;get_length_below);</div>
<div class="line">                                $lower_bound = min ($parent_pos, $child-&gt;get_length_below - $length);</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">else</span> {</div>
<div class="line">                                $upper_bound = $child-&gt;get_length_below;</div>
<div class="line">                                $lower_bound = $child-&gt;get_length_below - $length;</div>
<div class="line">                            }</div>
<div class="line">                            $child-&gt;set_cached_value (UPPER_BOUND_LENGTH =&gt; $upper_bound);</div>
<div class="line">                            $child-&gt;set_cached_value (LOWER_BOUND_LENGTH =&gt; $lower_bound);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">                            #  swap them if they are inverted (eg for depth)</span></div>
<div class="line"><span class="preprocessor"></span>                            ($lower_bound, $upper_bound) = sort <a class="code" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> ($lower_bound, $upper_bound);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">                    #  don&#39;t add to search hash if we&#39;re happy with this one</span></div>
<div class="line"><span class="preprocessor"></span>                    <span class="keywordflow">if</span> (defined $target_value) {</div>
<div class="line">                        <span class="keywordflow">if</span> ($use_depth &amp;&amp; $target_value &lt;= $lower_bound &amp;&amp; $target_value &gt;= $upper_bound) {</div>
<div class="line">                            $include_in_search = 0;</div>
<div class="line">                        }</div>
<div class="line">                        elsif ($target_value &gt; $lower_bound &amp;&amp; $target_value &lt;= $upper_bound) {</div>
<div class="line">                            $include_in_search = 0;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> ($include_in_search) {</div>
<div class="line"><span class="preprocessor">                    #  add to the values hash if it bounds the target value or it is not specified</span></div>
<div class="line"><span class="preprocessor"></span>                    $search_hash{$lower_bound}{$upper_bound}{$child-&gt;get_name} = $child;</div>
<div class="line">                }    </div>
<div class="line"></div>
<div class="line">                $final_hash{$child-&gt;get_name} = $child;  #  add <span class="keyword">this</span> child node to the tracking hashes        </div>
<div class="line">                <span class="keyword">delete</span> $final_hash{$child-&gt;get_parent-&gt;get_name};</div>
<div class="line"><span class="preprocessor">                #  clear parent from length consideration</span></div>
<div class="line"><span class="preprocessor"></span>                <span class="keyword">delete</span> $search_hash{$lower_value}{$upper_value}{$current_node-&gt;get_name};</div>
<div class="line">            }</div>
<div class="line">            <span class="keyword">delete</span> $search_hash{$lower_value}{$upper_value} <span class="keywordflow">if</span> ! scalar keys %{$search_hash{$lower_value}{$upper_value}};</div>
<div class="line">            <span class="keyword">delete</span> $search_hash{$lower_value} <span class="keywordflow">if</span> ! scalar keys %{$search_hash{$lower_value}};</div>
<div class="line">        }</div>
<div class="line">        last <span class="keywordflow">if</span> ! scalar keys %search_hash;  #  drop out - they must all be terminal nodes</div>
<div class="line"></div>
<div class="line">        $lower_value = (reverse sort <a class="code" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> keys %search_hash)[0];</div>
<div class="line">        $upper_value = (reverse sort <a class="code" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> keys %{$search_hash{$lower_value}})[0];</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #print scalar keys %final_hash, &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        $group_count = scalar keys %final_hash;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #print scalar keys %final_hash, &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">return</span> wantarray ? %final_hash : \%final_hash;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  reduce the number of tree nodes by promoting children with zero length difference</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  from their parents</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># potentially inefficient, as it starts from the top several times, but does avoid</span></div>
<div class="line"><span class="preprocessor">#  deep recursion this way (unless the tree really is that deep...)</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af37e9406baf74a91571caf9a0097dc40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::has_child </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-has_child' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-has_child-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-has_child-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-has_child-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in has_child: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#af37e9406baf74a91571caf9a0097dc40">has_child</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $node_ref = $args{node_ref} || croak <span class="stringliteral">&quot;missing node_ref argument\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my @children = $self-&gt;get_children;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $child (@children) {</div>
<div class="line">        <span class="keywordflow">return</span> 1 <span class="keywordflow">if</span> $child eq $node_ref;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8d6052e48f688fffa89ef39d4b4456c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::is_internal_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_internal_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_internal_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_internal_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_internal_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_internal_node: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a8d6052e48f688fffa89ef39d4b4456c5">is_internal_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> ($self-&gt;get_name) =~ /___$/;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a319555f4f89dd5ea1e3e6c25dc79d668"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::is_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_root_node: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a319555f4f89dd5ea1e3e6c25dc79d668">is_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">return</span> defined $self-&gt;get_parent ? 0 : 1;  #  <span class="keywordflow">if</span> it<span class="stringliteral">&#39;s undef then it&#39;</span>s a root node</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a31747198a40223638a233424f87f0562"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::is_terminal_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_terminal_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_terminal_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_terminal_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_terminal_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_terminal_node: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a31747198a40223638a233424f87f0562">is_terminal_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $children = $self-&gt;get_children;</div>
<div class="line">    <span class="keywordflow">return</span> !scalar @$children;  #  terminal <span class="keywordflow">if</span> it has no children</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  check if it is a &quot;named&quot; node, or internal (name ends in three underscores)</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a735d84e7d8099e5df68cc5f8f959a983"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::is_tree_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_tree_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_tree_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_tree_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_tree_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_tree_node: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a735d84e7d8099e5df68cc5f8f959a983">is_tree_node</a> {  #  check <span class="keywordflow">if</span> a node is a TreeNode - used to check children <span class="keywordflow">for</span> terminal entries</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! defined $args{node};</div>
<div class="line">    <span class="keywordflow">return</span> 1 <span class="keywordflow">if</span> ref($args{node}) =~ /::TreeNode/;  #  should really use devel::symdump to allow abstraction</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac5c47488d553f4bc9f82103672df0966"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-new' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-new-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-new-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-new-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in new: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <span class="keyword">new</span> {</div>
<div class="line">    my $class = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my %params = ( _CHILDREN =&gt; [] );</div>
<div class="line">    my $self = \%params;</div>
<div class="line"></div>
<div class="line">    bless $self, $class;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we loop through and add any specified arguments</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;set_length(%args);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (exists $args{parent}) {</div>
<div class="line">        $self-&gt;set_parent(%args);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (exists $args{children}) {</div>
<div class="line">        $self-&gt;add_children(%args);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;set_name(%args);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab5d95ff2056fd8428e1f843df59cf947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::number_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-number_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-number_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-number_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-number_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in number_nodes: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ab5d95ff2056fd8428e1f843df59cf947">number_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $number = ($args{number} || 0) + 1;  #  increment the number to ensure it is different</div>
<div class="line">    </div>
<div class="line">    $self-&gt;set_value (NODE_NUMBER =&gt; $number);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        $number = $child-&gt;number_nodes (number =&gt; $number);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> $number;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  convert the entire tree to a table structure, using a basestruct object as an intermediate</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a352c588d819c23c5df68f29685408249"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::number_terminal_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-number_terminal_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-number_terminal_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-number_terminal_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-number_terminal_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in number_terminal_nodes: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a352c588d819c23c5df68f29685408249">number_terminal_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  get an array of the terminal elements (this will also cache them)</span></div>
<div class="line"><span class="preprocessor"></span>    my @te = keys %{$self-&gt;get_terminal_elements};</div>
<div class="line"></div>
<div class="line">    my $prevChildElements = $args{count_sofar} || 1;</div>
<div class="line">    $self-&gt;set_value (TERMINAL_NODE_FIRST =&gt; $prevChildElements);</div>
<div class="line">    $self-&gt;set_value (TERMINAL_NODE_LAST =&gt; $prevChildElements + $#te);</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        my $count = $child-&gt;number_terminal_nodes (<span class="stringliteral">&#39;count_sofar&#39;</span> =&gt; $prevChildElements);</div>
<div class="line">        $prevChildElements += $count;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $#te + 1;  #  <span class="keywordflow">return</span> the number of terminal elements below <span class="keyword">this</span> node</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  Assign a unique number to all nodes below this one.  It does not matter who gets what.</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a007984955fb02a39dad4f383143a0a00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::numerically </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-numerically' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-numerically-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-numerically-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-numerically-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in numerically: 65</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a007984955fb02a39dad4f383143a0a00">numerically</a> {$a &lt;=&gt; $b}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#sub DESTROY {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    my $self = shift;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    #my $name = $self-&gt;get_name;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    #print &quot;DESTROYING $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    $self-&gt;{_PARENT} = undef;  #  free the parent</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    #  destroy the children</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    foreach my $child ($self-&gt;get_children) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#        $child-&gt;DESTROY if defined $child;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    }</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    $self-&gt;{_CHILDREN} = undef;  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    #print &quot;DESTROYED $name\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#    #  perl can handle the rest</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">1;</div>
<div class="line"></div>
<div class="line">__END__</div>
<div class="line"></div>
<div class="line">=head1 NAME</div>
<div class="line"></div>
<div class="line">Biodiverse::????</div>
<div class="line"></div>
<div class="line">=head1 SYNOPSIS</div>
<div class="line"></div>
<div class="line">  use Biodiverse::????;</div>
<div class="line">  $object = <a class="code" href="classBiodiverse_1_1Statistics.html">Biodiverse::Statistics</a>-&gt;<a class="code" href="classBiodiverse_1_1Statistics.html#a06fc6da973eebcb8a48cbd8ebcf90b9f">new</a>();</div>
<div class="line"></div>
<div class="line">=head1 DESCRIPTION</div>
<div class="line"></div>
<div class="line">TO BE FILLED IN</div>
<div class="line"></div>
<div class="line">=head1 METHODS</div>
<div class="line"></div>
<div class="line">=over</div>
<div class="line"></div>
<div class="line">=item INSERT METHODS</div>
<div class="line"></div>
<div class="line">=back</div>
<div class="line"></div>
<div class="line">=head1 REPORTING ERRORS</div>
<div class="line"></div>
<div class="line">Use the issue tracker at http:<span class="comment">//www.purl.org/biodiverse</span></div>
<div class="line"></div>
<div class="line">=head1 COPYRIGHT</div>
<div class="line"></div>
<div class="line">Copyright (c) 2010 Shawn Laffan. All rights reserved.  </div>
<div class="line"></div>
<div class="line">=head1 LICENSE</div>
<div class="line"></div>
<div class="line">This program is free software: you can redistribute it and/or modify</div>
<div class="line">it under the terms of the GNU General Public License as published by</div>
<div class="line">the Free Software Foundation, either version 3 of the License, or</div>
<div class="line">(at your option) any later version.</div>
<div class="line"></div>
<div class="line">This program is distributed in the hope that it will be useful,</div>
<div class="line">but WITHOUT ANY WARRANTY; without even the implied warranty of</div>
<div class="line">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</div>
<div class="line">GNU General Public License <span class="keywordflow">for</span> more details.</div>
<div class="line"></div>
<div class="line">For a full copy of the license see &lt;http:<span class="comment">//www.gnu.org/licenses/&gt;.</span></div>
<div class="line"></div>
<div class="line">=cut</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a08174510e15cd79f1e9626bce61a69b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::print </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-print' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-print-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-print-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-print-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in print: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub print { # prints out the tree (<span class="keywordflow">for</span> debugging)</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $space = shift || $EMPTY_STRING;</div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;$space &quot;</span> . $self-&gt;get_name() . <span class="stringliteral">&quot;\t\t\t&quot;</span> . $self-&gt;get_length . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">            $child-&gt;print($space . $SPACE);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">*add_to_list = \&amp;<a class="code" href="classBiodiverse_1_1TreeNode.html#a94c0d540ccd26715a550e0ddf6dd0330">add_to_lists</a>;</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4a7b1d41395e6992538d8ed45e712281"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::raise_zerolength_children </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-raise_zerolength_children' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-raise_zerolength_children-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-raise_zerolength_children-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-raise_zerolength_children-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in raise_zerolength_children: 63</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a4a7b1d41395e6992538d8ed45e712281">raise_zerolength_children</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my %results = (empty_node_names =&gt; [],</div>
<div class="line">                   raised_count =&gt; 0,</div>
<div class="line">                  );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ($self-&gt;is_terminal_node) {</div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    my $child_count = $#{$self-&gt;get_children} + 1;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (! $self-&gt;is_root_node) {</div>
<div class="line"><span class="preprocessor">        #  raise all children with length zero to be children of the parent node</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  no - make that those with the same total length as their parent</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line"><span class="preprocessor">            #$child_count ++;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #next if $self-&gt;is_root_node;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #if ($child-&gt;get_length == 0) {</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> ($child-&gt;get_total_length == $self-&gt;get_total_length) {</div>
<div class="line"><span class="preprocessor">                #  add_children takes care of the parent refs</span></div>
<div class="line"><span class="preprocessor"></span>                $self-&gt;get_parent-&gt;add_children(children =&gt; [$child]);</div>
<div class="line"><span class="preprocessor">                #  the length will be the same as this node - no it will not.  </span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                #$child-&gt;set_length(&#39;length&#39; =&gt; $self-&gt;get_length);</span></div>
<div class="line"><span class="preprocessor"></span>                $results{raised_count} ++;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  delete the node from the parent&#39;s list of children if all have been raised</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">if</span> ($results{raised_count} == $child_count) {</div>
<div class="line">        $self-&gt;get_parent-&gt;delete_child (child =&gt; $self);</div>
<div class="line">        push @{$results{empty_node_names}}, $self-&gt;get_name;  #  add to list of names deleted</div>
<div class="line">        <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">    #  one child left - raise it and recalculate the length.  It is not healthy to be an only child.</span></div>
<div class="line"><span class="preprocessor"></span>    elsif (! $self-&gt;is_root_node &amp;&amp; $results{raised_count} == ($child_count - 1)) {</div>
<div class="line">        </div>
<div class="line">        my $child = shift @{$self-&gt;get_children};</div>
<div class="line"><span class="preprocessor">        #print &quot;Raising child &quot; . $child-&gt;get_name . &quot;from parent &quot; . $self-&gt;get_name .</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #      &quot; to &quot; . $self-&gt;get_parent-&gt;get_name . &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>        $self-&gt;get_parent-&gt;add_children (children =&gt; [$child]);</div>
<div class="line">        $child-&gt;set_length (length =&gt; $self-&gt;get_length + $child-&gt;get_length);</div>
<div class="line">        $self-&gt;get_parent-&gt;delete_child (child =&gt; $self);</div>
<div class="line">        $results{raised_count} ++;</div>
<div class="line">        push @{$results{empty_node_names}}, $self-&gt;get_name;  #  add to list of names deleted</div>
<div class="line">        <span class="keywordflow">return</span> %results <span class="keywordflow">if</span> wantarray;</div>
<div class="line">        <span class="keywordflow">return</span> \%results;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  now loop through any children and flatten them</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        my %res = $child-&gt;raise_zerolength_children;</div>
<div class="line">        $results{raised_count} += $res{raised_count};</div>
<div class="line">        push @{$results{empty_node_names}}, @{$res{empty_node_names}};</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> %results <span class="keywordflow">if</span> wantarray;</div>
<div class="line">    <span class="keywordflow">return</span> \%results;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  a bit inefficient, but should work</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a33b43ba24c8fa9904cc375cb8aa66f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::reset_total_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-reset_total_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-reset_total_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_total_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_total_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in reset_total_length: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a33b43ba24c8fa9904cc375cb8aa66f24">reset_total_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    $self-&gt;set_value (TOTAL_LENGTH =&gt; undef);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aec865e88cabfeab7fac7c55158111f3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::reset_total_length_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-reset_total_length_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-reset_total_length_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_total_length_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_total_length_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in reset_total_length_below: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aec865e88cabfeab7fac7c55158111f3d">reset_total_length_below</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    $self-&gt;reset_total_length;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        $child-&gt;reset_total_length;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a39695d897dd9a71f0ae9aac8a78a4ad6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_cached_value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_cached_value' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_cached_value-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_cached_value-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_cached_value-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_cached_value: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a39695d897dd9a71f0ae9aac8a78a4ad6">set_cached_value</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    @{$self-&gt;{_cache}}{keys %args} = values %args;</div>
<div class="line"><span class="preprocessor">    #foreach my $key (keys %args) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    $self-&gt;{_cache}{$key} = $args{$key};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7dd9c6c27a5a22a1080258c8f92f397c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_child_lengths </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_child_lengths' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_child_lengths-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_child_lengths-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_child_lengths-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_child_lengths: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a7dd9c6c27a5a22a1080258c8f92f397c">set_child_lengths</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $minValue = $args{total_length};</div>
<div class="line">    defined $minValue || croak <span class="stringliteral">&quot;[TREENODE] argument total_length not specified\n&quot;</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line"><span class="preprocessor">        #if ($child-&gt;get_total_length != $minValue) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #    print &quot;Length already defined, node &quot;, $child-&gt;get_name, &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #}</span></div>
<div class="line"><span class="preprocessor"></span>        $child-&gt;set_value (TOTAL_LENGTH =&gt; $minValue);</div>
<div class="line">        <span class="keywordflow">if</span> ($child-&gt;is_terminal_node) {</div>
<div class="line">            $child-&gt;set_length (length =&gt; $minValue);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            my $grandChild = @{$child-&gt;get_children}[0];  #ERROR ERROR???</div>
<div class="line">            $child-&gt;set_length (length =&gt; $minValue - $grandChild-&gt;get_total_length);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  sometimes we need to reset the total length value, eg after cutting a tree</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a622005b2d4f2049e03322fa406e0999b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_depth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_depth' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_depth-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_depth-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_depth-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_depth: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a622005b2d4f2049e03322fa406e0999b">set_depth</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> ! exists ($args{depth});</div>
<div class="line">    $self-&gt;{NODE_VALUES}{DEPTH} = $args{depth};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a2602a98611e5846f9f818b01eff1dcd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_length' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_length-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_length-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_length-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_length: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a2602a98611e5846f9f818b01eff1dcd0">set_length</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"><span class="preprocessor">    #croak &#39;length argument missing&#39; if not exists ($args{length});</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;{NODE_VALUES}{LENGTH} = $args{length} <span class="comment">// $default_length;</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a80041d7fbcba44fdcb73a44dfeacf34f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_name' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_name-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_name-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_name-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_name: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a80041d7fbcba44fdcb73a44dfeacf34f">set_name</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    croak <span class="stringliteral">&quot;name argument missing\n&quot;</span> <span class="keywordflow">if</span> not exists ($args{name});</div>
<div class="line"><span class="preprocessor">    #$self-&gt;{0name_for_debug} = $args{name}; #  temporary</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;{NODE_VALUES}{NAME} = $args{name};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aaea3e6e029396e83e5c59e1cb057a094"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_node_as_parent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_node_as_parent' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_node_as_parent-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_node_as_parent-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_node_as_parent-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_node_as_parent: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#aaea3e6e029396e83e5c59e1cb057a094">set_node_as_parent</a> {  #  loop through the children and <span class="keyword">set</span> <span class="keyword">this</span> node as the parent</div>
<div class="line">    my $self = shift;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $child ($self-&gt;get_children) {</div>
<div class="line">        <span class="keywordflow">if</span> ($self-&gt;is_tree_node(node =&gt; $child)) {</div>
<div class="line">            $child-&gt;set_parent(parent =&gt; $self);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a72e23ff2d36d75dc8b14f50b03744202"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_parent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_parent' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_parent-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_parent-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_parent-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_parent: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a72e23ff2d36d75dc8b14f50b03744202">set_parent</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;argument &#39;parent&#39; not specified\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> ! exists ($args{parent});</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;Reference not type Biodiverse::TreeNode\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> (defined $args{parent}</div>
<div class="line">            &amp;&amp; ! ref($args{parent}) =~ /Biodiverse::Treenode/</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line">    $self-&gt;{_PARENT} = $args{parent};</div>
<div class="line"><span class="preprocessor">    #  avoid potential memory leakage caused by circular refs</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #weaken ($self-&gt;{_PARENT});  </span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;weaken_parent_ref;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5b9fe561b2fe963b79ef1d6ddef0dd47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_parents_below </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_parents_below' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_parents_below-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_parents_below-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_parents_below-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_parents_below: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a5b9fe561b2fe963b79ef1d6ddef0dd47">set_parents_below</a> {  #  sometimes the parents aren<span class="stringliteral">&#39;t set properly by extension subs</span></div>
<div class="line"><span class="stringliteral">    my $self = shift;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    foreach my $child ($self-&gt;get_children) {</span></div>
<div class="line"><span class="stringliteral">        $child-&gt;set_parent (parent =&gt; $self);</span></div>
<div class="line"><span class="stringliteral">        $child-&gt;set_parents_below;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    return;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a97e983565cba18161c6c44de25b0f18c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::set_value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_value' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_value-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_value-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_value-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_value: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a97e983565cba18161c6c44de25b0f18c">set_value</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    @{$self-&gt;{NODE_VALUES}}{keys %args} = values %args;</div>
<div class="line"><span class="preprocessor">    #foreach my $key (keys %args) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #    $self-&gt;{NODE_VALUES}{$key} = $args{$key};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #}</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac01ac1ab997907327425cf29cee1aae9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::shuffle_terminal_names </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-shuffle_terminal_names' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-shuffle_terminal_names-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-shuffle_terminal_names-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-shuffle_terminal_names-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in shuffle_terminal_names: 25</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#ac01ac1ab997907327425cf29cee1aae9">shuffle_terminal_names</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $prng = $args{rand_object} <span class="comment">// $self-&gt;initialise_rand (%args);</span></div>
<div class="line"></div>
<div class="line">    my %terminals = $self-&gt;get_terminal_node_refs;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Get names in consistent order for replication purposes</span></div>
<div class="line"><span class="preprocessor"></span>    my @names = sort keys %terminals;</div>
<div class="line">    my @shuffled_names = @names;</div>
<div class="line">    $prng-&gt;shuffle(\@shuffled_names);  #  in-place re-ordering</div>
<div class="line"></div>
<div class="line">    my %reordered;</div>
<div class="line">    @reordered{@names} = @shuffled_names;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_ref (values %terminals) {</div>
<div class="line">        my $name = $node_ref-&gt;get_name;</div>
<div class="line">        $node_ref-&gt;set_name (name =&gt; $reordered{$name});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %reordered : \%reordered;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a73b2a3fa5dd2516b9d7a7b5041a772b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::to_basestruct_group_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_basestruct_group_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_basestruct_group_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_basestruct_group_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_basestruct_group_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_basestruct_group_nodes: 105</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a73b2a3fa5dd2516b9d7a7b5041a772b2">to_basestruct_group_nodes</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">delete</span> $args{target_value} <span class="keywordflow">if</span> ! $args{use_target_value};</div>
<div class="line">    </div>
<div class="line">    $self-&gt;number_nodes <span class="keywordflow">if</span> ! defined $self-&gt;get_value (<span class="stringliteral">&#39;NODE_NUMBER&#39;</span>);  #  assign unique labels to nodes <span class="keywordflow">if</span> needed</div>
<div class="line">    </div>
<div class="line">    my $num_classes = $args{use_target_value} ? q{} : $args{num_clusters};</div>
<div class="line"></div>
<div class="line">    croak <span class="stringliteral">&quot;One of args num_classes or use_target_value must be specified\n&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> ! ($num_classes || $args{use_target_value});</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # build a BaseStruct object and set it up to contain the terminal elements</span></div>
<div class="line"><span class="preprocessor"></span>    my $bs = <a class="code" href="classBiodiverse_1_1BaseStruct.html">Biodiverse::BaseStruct</a>-&gt;<a class="code" href="classBiodiverse_1_1BaseStruct.html#a6b5273b9f543e241a229cd1c97504d5e">new</a> (</div>
<div class="line">        NAME =&gt; <span class="stringliteral">&#39;TEMP&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $get_node_method = $args{terminals_only} ? <span class="stringliteral">&#39;get_terminal_elements&#39;</span> : <span class="stringliteral">&#39;get_all_descendents_and_self&#39;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $element (sort keys %{$self-&gt;$get_node_method}) {</div>
<div class="line">        $bs-&gt;add_element (element =&gt; $element);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #print &quot;[TREE] Writing $num_classes clusters, grouped by &quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #      . $args{group_by_depth} ? &quot;depth.&quot; : &quot;length.&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    <span class="keywordflow">if</span> (defined $args{target_value}) {</div>
<div class="line">        print <span class="stringliteral">&quot;  Target value is $args{target_value}.  &quot;</span> ;</div>
<div class="line">    }</div>
<div class="line">    print <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my %target_nodes = $self-&gt;group_nodes_below (</div>
<div class="line">        %args,</div>
<div class="line">        num_clusters =&gt; $num_classes</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (defined $args{sub_list} &amp;&amp; $args{sub_list} !~ /(no list)/) {</div>
<div class="line">        print <span class="stringliteral">&quot;[TREE] Adding values from sub list $args{sub_list} to each node\n&quot;</span>;</div>
<div class="line">    } </div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[TREE] Actual number of groups identified is &quot;</span> . scalar (keys %target_nodes) . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $max_sublist_digits</div>
<div class="line">        = defined $args{sub_list}</div>
<div class="line">            ? length (</div>
<div class="line">                $self-&gt;get_max_list_length_below (</div>
<div class="line">                    list =&gt; $args{sub_list}</div>
<div class="line">                ) - 1</div>
<div class="line">            )</div>
<div class="line">            : undef;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # we have what we need, so flesh out the BaseStruct object</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $node (values %target_nodes) {</div>
<div class="line">        my %data = (NAME =&gt; $node-&gt;get_name);</div>
<div class="line">        <span class="keywordflow">if</span> ($args{include_node_data}) {</div>
<div class="line">            my %node_data = (</div>
<div class="line">                LENGTH             =&gt; $node-&gt;get_length,</div>
<div class="line">                LENGTH_TOTAL       =&gt; $node-&gt;get_length_below,</div>
<div class="line">                DEPTH              =&gt; $node-&gt;get_depth,</div>
<div class="line">                CHILD_COUNT        =&gt; $node-&gt;get_child_count,</div>
<div class="line">                CHILD_COUNT_TOTAL  =&gt; $node-&gt;get_child_count_below,</div>
<div class="line">                TNODE_FIRST        =&gt; $node-&gt;get_value(<span class="stringliteral">&#39;TERMINAL_NODE_FIRST&#39;</span>),</div>
<div class="line">                TNODE_LAST         =&gt; $node-&gt;get_value(<span class="stringliteral">&#39;TERMINAL_NODE_LAST&#39;</span>),</div>
<div class="line">            );</div>
<div class="line">            @data{keys %node_data} = values %node_data;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  get the additional list data if requested</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #  should really allow arrays here - convert to hashes?</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (defined $args{sub_list} &amp;&amp; $args{sub_list} !~ /(no list)/) {</div>
<div class="line">            my $sub_list_ref = $node-&gt;get_list_ref (list =&gt; $args{sub_list});</div>
<div class="line">            <span class="keywordflow">if</span> (defined $sub_list_ref) {</div>
<div class="line">                <span class="keywordflow">if</span> ((ref $sub_list_ref) =~ /ARRAY/) {</div>
<div class="line">                    $sub_list_ref = $self-&gt;array_to_hash_values (</div>
<div class="line">                        list =&gt; $sub_list_ref,</div>
<div class="line">                        prefix =&gt; $args{sub_list},</div>
<div class="line">                        num_digits =&gt; $max_sublist_digits,</div>
<div class="line">                        sort_array_lists =&gt; $args{sort_array_lists},</div>
<div class="line">                    );</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> ((ref $sub_list_ref) =~ /HASH/) {</div>
<div class="line">                    @data{keys %$sub_list_ref} = (values %$sub_list_ref);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  loop through all the terminal elements in this cluster and assign the values</span></div>
<div class="line"><span class="preprocessor"></span>        my @elements = keys %{$node-&gt;$get_node_method};</div>
<div class="line">        <span class="keywordflow">foreach</span> my $element (sort @elements) {</div>
<div class="line">            $bs-&gt;add_to_hash_list (</div>
<div class="line">                element =&gt; $element,</div>
<div class="line">                list    =&gt; <span class="stringliteral">&#39;data&#39;</span>,</div>
<div class="line">                %data,</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $bs;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  print the tree out to a nexus format file.</span></div>
<div class="line"><span class="preprocessor">#  basically builds a taxon block and then passes that through to to_newick</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8dc8604a9d386c82d4c1fc7f97f8a238"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::to_newick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_newick' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_newick-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_newick-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_newick-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_newick: 63</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a8dc8604a9d386c82d4c1fc7f97f8a238">to_newick</a> {   #  convert the tree to a newick format.  Based on the NEXUS library</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (use_internal_names =&gt; 1, @_);</div>
<div class="line"></div>
<div class="line">    my $use_int_names = $args{use_internal_names};</div>
<div class="line">    my $boot_name = $args{boot} || <span class="stringliteral">&#39;boot&#39;</span>;</div>
<div class="line"><span class="preprocessor">    #my $string = $self-&gt;is_terminal_node ? $EMPTY_STRING : &#39;(&#39;;  #  no brackets around terminals</span></div>
<div class="line"><span class="preprocessor"></span>    my $string = $EMPTY_STRING;</div>
<div class="line"></div>
<div class="line">    my $remap = $args{remap} || {};</div>
<div class="line">    my $name = $self-&gt;get_name;</div>
<div class="line">    my $remapped = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (defined $remap-&gt;{$name}) {</div>
<div class="line">        $name = $remap-&gt;{$name}; #  use remap <span class="keywordflow">if</span> present</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        my $quote_char = q{<span class="stringliteral">&#39;};</span></div>
<div class="line"><span class="stringliteral">        my $csv_obj = $self-&gt;get_csv_object (</span></div>
<div class="line"><span class="stringliteral">            quote_char   =&gt; $quote_char,</span></div>
<div class="line"><span class="stringliteral">            escape_char  =&gt; $quote_char,</span></div>
<div class="line"><span class="stringliteral">            always_quote =&gt; 1,</span></div>
<div class="line"><span class="stringliteral">        );</span></div>
<div class="line"><span class="stringliteral">        $name = $self-&gt;list2csv (csv_object =&gt; $csv_obj, list =&gt; [$name]);</span></div>
<div class="line"><span class="stringliteral">        #$name = &quot;&#39;</span>$name<span class="stringliteral">&#39;&quot;;  #  quote otherwise</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    if (! $self-&gt;is_terminal_node) {   #  not a terminal node</span></div>
<div class="line"><span class="stringliteral">        $string .= &quot;(&quot;;</span></div>
<div class="line"><span class="stringliteral">        foreach my $child ($self-&gt;get_children) { # internal nodes</span></div>
<div class="line"><span class="stringliteral">            $string .= $child-&gt;to_newick(%args);</span></div>
<div class="line"><span class="stringliteral">            #$string .= &#39;</span>)<span class="stringliteral">&#39; if ! $child-&gt;is_internal_node;</span></div>
<div class="line"><span class="stringliteral">            $string .= &#39;</span>,<span class="stringliteral">&#39;;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        chop $string;  # remove trailing comma</span></div>
<div class="line"><span class="stringliteral">        $string .= &quot;)&quot;;</span></div>
<div class="line"><span class="stringliteral">        </span></div>
<div class="line"><span class="stringliteral">        if (defined ($name) &amp;&amp; $use_int_names ) {</span></div>
<div class="line"><span class="stringliteral">            $string .= $name;  </span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        if (defined $self-&gt;get_length) {</span></div>
<div class="line"><span class="stringliteral">            $string .= &quot;:&quot; . $self-&gt;get_length;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        if (defined $self-&gt;get_value($boot_name)) {</span></div>
<div class="line"><span class="stringliteral">            $string .= &quot;[&quot; . $self-&gt;get_value($boot_name) . &quot;]&quot;;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        </span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    else { # terminal nodes</span></div>
<div class="line"><span class="stringliteral">        #$string .= &quot;&#39;</span><span class="stringliteral">&quot; . $name . &quot;</span><span class="stringliteral">&#39;&quot;;</span></div>
<div class="line"><span class="stringliteral">        $string .= $name;</span></div>
<div class="line"><span class="stringliteral">        if (defined $self-&gt;get_length) { </span></div>
<div class="line"><span class="stringliteral">            $string .= &quot;:&quot; . $self-&gt;get_length;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        if (defined $self-&gt;get_value($boot_name)) { # state at nodes sometimes put as bootstrap values</span></div>
<div class="line"><span class="stringliteral">            $string .= &quot;[&quot; . $self-&gt;get_value($boot_name) . &quot;]&quot;;</span></div>
<div class="line"><span class="stringliteral">        }</span></div>
<div class="line"><span class="stringliteral">        #$string .= &quot;,&quot;;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    return $string;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a81a7b7337c9ffc622d7b83a80b24b5b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::to_nexus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_nexus' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_nexus-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_nexus-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_nexus-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_nexus: 68</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a81a7b7337c9ffc622d7b83a80b24b5b0">to_nexus</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (@_);</div>
<div class="line">    my $string;</div>
<div class="line">    my $tree_name = $args{tree_name} || $self-&gt;get_param (<span class="stringliteral">&#39;NAME&#39;</span>) || <span class="stringliteral">&#39;Biodiverse_tree&#39;</span>;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  first, build a hash of the label names for the taxon block, unless told not to</span></div>
<div class="line"><span class="preprocessor"></span>    my %remap;  #  create a remap table unless one is already specified in the args</div>
<div class="line">    <span class="keywordflow">if</span> (! defined $args{remap} &amp;&amp; ! $args{no_remap}) {</div>
<div class="line"><span class="preprocessor">        #  get a hash of all the nodes in the tree.</span></div>
<div class="line"><span class="preprocessor"></span>        my %nodes = ($self-&gt;get_name() =&gt; $self, $self-&gt;get_all_descendents);</div>
<div class="line"></div>
<div class="line">        my $i = 0;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node (values %nodes) {</div>
<div class="line"><span class="preprocessor">            #  no remap for internals - TreeView does not like it</span></div>
<div class="line"><span class="preprocessor"></span>            next <span class="keywordflow">if</span> ! $args{use_internal_names} &amp;&amp; $node-&gt;is_internal_node;  </div>
<div class="line">            $remap{$node-&gt;get_name} = $i;</div>
<div class="line">            $i++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    my %reverse_remap;</div>
<div class="line">    @reverse_remap{values %remap} = (keys %remap);</div>
<div class="line"></div>
<div class="line">    my $translate_table;</div>
<div class="line">    my $quote_char = q{<span class="stringliteral">&#39;};</span></div>
<div class="line"><span class="stringliteral">    my $csv_obj = $self-&gt;get_csv_object (</span></div>
<div class="line"><span class="stringliteral">        quote_char  =&gt; $quote_char,</span></div>
<div class="line"><span class="stringliteral">        escape_char =&gt; $quote_char,</span></div>
<div class="line"><span class="stringliteral">        quote_space =&gt; 1,</span></div>
<div class="line"><span class="stringliteral">    );</span></div>
<div class="line"><span class="stringliteral">    my $j = 0;</span></div>
<div class="line"><span class="stringliteral">    foreach my $mapped_key (sort numerically keys %reverse_remap) {</span></div>
<div class="line"><span class="stringliteral">        my $remapped = $self-&gt;list2csv (</span></div>
<div class="line"><span class="stringliteral">            csv_object =&gt; $csv_obj,</span></div>
<div class="line"><span class="stringliteral">            list       =&gt; [$reverse_remap{$mapped_key}],</span></div>
<div class="line"><span class="stringliteral">        );</span></div>
<div class="line"><span class="stringliteral">        $translate_table .= &quot;\t\t$mapped_key $remapped,\n&quot;;</span></div>
<div class="line"><span class="stringliteral">        $j++;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    chop $translate_table;  #  strip the last two characters - cheaper than checking for them in the loop</span></div>
<div class="line"><span class="stringliteral">    chop $translate_table;</span></div>
<div class="line"><span class="stringliteral">    $translate_table .= &quot;\n\t\t;&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    my $type = blessed $self;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    #  clean up quoting</span></div>
<div class="line"><span class="stringliteral">    if ($tree_name =~ /^&#39;</span>/ and $tree_name =~ /<span class="stringliteral">&#39;$/) {</span></div>
<div class="line"><span class="stringliteral">        $tree_name =~ s/^&#39;</span><span class="comment">//;</span></div>
<div class="line">        $tree_name =~ s/<span class="stringliteral">&#39;$//;</span></div>
<div class="line"><span class="stringliteral">    }</span></div>
<div class="line"><span class="stringliteral">    $tree_name = $self-&gt;list2csv(  #  quote tree name if needed</span></div>
<div class="line"><span class="stringliteral">        csv_object =&gt; $csv_obj,</span></div>
<div class="line"><span class="stringliteral">        list       =&gt; [$tree_name],</span></div>
<div class="line"><span class="stringliteral">    );</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;#NEXUS\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;[ID: $tree_name]\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;begin trees;\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;\t[Export of a $type tree using Biodiverse::TreeNode version $VERSION]\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;\tTranslate \n$translate_table\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;\tTree $tree_name = &quot; . $self-&gt;to_newick (remap =&gt; \%remap, %args) . &quot;;\n&quot;;</span></div>
<div class="line"><span class="stringliteral">    $string .= &quot;end;\n\n&quot;;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    #print $EMPTY_STRING;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">    return $string;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a1fe73627180266dc072b96b14e4472f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::to_table </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_table' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_table-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_table-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_table-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_table: 85</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a1fe73627180266dc072b96b14e4472f9">to_table</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $treename = $args{name} || <span class="stringliteral">&quot;TREE&quot;</span>;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  assign unique ID numbers if not already done</span></div>
<div class="line"><span class="preprocessor"></span>    defined ($self-&gt;get_value (<span class="stringliteral">&#39;NODE_NUMBER&#39;</span>)) || $self-&gt;number_nodes;</div>
<div class="line">    </div>
<div class="line">    #  create the plot coords <span class="keywordflow">if</span> requested</div>
<div class="line">    if ($args{include_plot_coords}) {</div>
<div class="line">        $self-&gt;assign_plot_coords (</div>
<div class="line">            plot_coords_scale_factor  =&gt; $args{plot_coords_scale_factor},</div>
<div class="line">            plot_coords_left_to_right =&gt; $args{plot_coords_left_to_right},</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    # create a BaseStruct object to contain the table</span></div>
<div class="line"><span class="preprocessor"></span>    my $bs = <a class="code" href="classBiodiverse_1_1BaseStruct.html">Biodiverse::BaseStruct</a>-&gt;<a class="code" href="classBiodiverse_1_1BaseStruct.html#a6b5273b9f543e241a229cd1c97504d5e">new</a> (</div>
<div class="line">        NAME =&gt; $treename,</div>
<div class="line">    );  #  may need to specify some other params</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    my @header = qw /TREENAME NODE_NUMBER PARENTNODE LENGTHTOPARENT NAME/;</div>
<div class="line"><span class="preprocessor">#    push @$data, \@header;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my ($parent_num, $taxon_name);</div>
<div class="line">    </div>
<div class="line">    my $max_sublist_digits = defined $args{sub_list}</div>
<div class="line">                            ? length ($self-&gt;get_max_list_length_below (list =&gt; $args{sub_list}) - 1)</div>
<div class="line">                            : undef;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    my %children = $self-&gt;get_all_descendents;  #   all descendents below <span class="keyword">this</span> node</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node ($self, values %children) {  # maybe sort by child depth?</div>
<div class="line">        $parent_num = $node-&gt;is_root_node</div>
<div class="line">                        ? 0</div>
<div class="line">                        : $node-&gt;get_parent-&gt;get_value (<span class="stringliteral">&#39;NODE_NUMBER&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!$node-&gt;is_internal_node || $args{use_internal_names}) {</div>
<div class="line">            $taxon_name = $node-&gt;get_name;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            $taxon_name = $EMPTY_STRING;</div>
<div class="line">        }</div>
<div class="line">        my $number = $node-&gt;get_value (<span class="stringliteral">&#39;NODE_NUMBER&#39;</span>);</div>
<div class="line">        my %data;</div>
<div class="line"><span class="preprocessor">        #  add to the basestruct object</span></div>
<div class="line"><span class="preprocessor"></span>        @data{@header} = ($treename, $number, $parent_num, $node-&gt;get_length || 0, $taxon_name);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  get the additional list data if requested</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (defined $args{sub_list} &amp;&amp; $args{sub_list} !~ /(no list)/) {</div>
<div class="line">            my $sub_list_ref = $node-&gt;get_list_ref (list =&gt; $args{sub_list});</div>
<div class="line">            <span class="keywordflow">if</span> (defined $sub_list_ref) {</div>
<div class="line">                <span class="keywordflow">if</span> ((ref $sub_list_ref) =~ /ARRAY/) {</div>
<div class="line">                    $sub_list_ref = $self-&gt;array_to_hash_values (</div>
<div class="line">                        list             =&gt; $sub_list_ref,</div>
<div class="line">                        prefix           =&gt; $args{sub_list},</div>
<div class="line">                        num_digits       =&gt; $max_sublist_digits,</div>
<div class="line">                        sort_array_lists =&gt; $args{sort_array_lists},</div>
<div class="line">                    );</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> ((ref $sub_list_ref) =~ /HASH/) {</div>
<div class="line">                    @data{keys %$sub_list_ref} = (values %$sub_list_ref);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> ($args{include_plot_coords}) {</div>
<div class="line">            my $plot_coords_ref = $node-&gt;get_list_ref (list =&gt; <span class="stringliteral">&#39;PLOT_COORDS&#39;</span>);</div>
<div class="line">            @data{keys %$plot_coords_ref} = (values %$plot_coords_ref);</div>
<div class="line">            my $vert_plot_coords_ref = $node-&gt;get_list_ref (list =&gt; <span class="stringliteral">&#39;PLOT_COORDS_VERT&#39;</span>);</div>
<div class="line">            @data{keys %$vert_plot_coords_ref} = (values %$vert_plot_coords_ref);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $bs-&gt;add_element (element =&gt; $number);</div>
<div class="line">        $bs-&gt;add_to_hash_list (</div>
<div class="line">            element =&gt; $number,</div>
<div class="line">            list    =&gt; <span class="stringliteral">&#39;data&#39;</span>,</div>
<div class="line">            %data,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $bs-&gt;to_table (%args, list =&gt; <span class="stringliteral">&#39;data&#39;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  print the tree out as a table structure</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6f6e3eff11556006c6815bdca41984ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::to_table_group_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-to_table_group_nodes' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-to_table_group_nodes-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-to_table_group_nodes-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-to_table_group_nodes-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in to_table_group_nodes: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a6f6e3eff11556006c6815bdca41984ef">to_table_group_nodes</a> {  #  export to table by grouping the nodes</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Marginally inefficient, as we loop over the data three times this way (once here, twice in write_table).</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  However, write_table takes care of the output and list types (symmetric/asymmetric) and saves code duplication</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $bs = $self-&gt;to_basestruct_group_nodes(%args);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $bs-&gt;to_table (@_, list =&gt; <span class="stringliteral">&#39;data&#39;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7190966890b224eaf62e63af51775b82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::TreeNode::weaken_parent_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-weaken_parent_ref' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-weaken_parent_ref-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-weaken_parent_ref-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-weaken_parent_ref-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in weaken_parent_ref: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1TreeNode.html#a7190966890b224eaf62e63af51775b82">weaken_parent_ref</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (! exists ($self-&gt;{_PARENT}) || ! defined ($self-&gt;{_PARENT})) {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    elsif (not isweak ($self-&gt;{_PARENT})) {</div>
<div class="line"><span class="preprocessor">        #print &quot;Tree weakening parent ref\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">return</span> weaken ($self-&gt;{_PARENT});</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/Biodiverse/<a class="el" href="TreeNode_8pm_source.html">TreeNode.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Biodiverse</b></li><li class="navelem"><a class="el" href="classBiodiverse_1_1TreeNode.html">TreeNode</a></li>
    <li class="footer">Generated on Tue Nov 5 2013 19:07:31 for Biodiverse by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
