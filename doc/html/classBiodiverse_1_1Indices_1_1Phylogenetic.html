<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Biodiverse: Biodiverse::Indices::Phylogenetic Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Biodiverse
   &#160;<span id="projectnumber">0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classBiodiverse_1_1Indices_1_1Phylogenetic.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classBiodiverse_1_1Indices_1_1Phylogenetic-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Biodiverse::Indices::Phylogenetic Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Biodiverse::Indices::Phylogenetic:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBiodiverse_1_1Indices_1_1Phylogenetic__coll__graph.png" border="0" usemap="#Biodiverse_1_1Indices_1_1Phylogenetic_coll__map" alt="Collaboration graph"/></div>
<map name="Biodiverse_1_1Indices_1_1Phylogenetic_coll__map" id="Biodiverse_1_1Indices_1_1Phylogenetic_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a4790e3e612211269eece05dd375f798d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4790e3e612211269eece05dd375f798d"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>stats_package</b></td></tr>
<tr class="separator:a4790e3e612211269eece05dd375f798d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a0468a860dc9d954b816b256c912d0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a74a0468a860dc9d954b816b256c912d0"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>mx_class_for_trees</b></td></tr>
<tr class="separator:a74a0468a860dc9d954b816b256c912d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54cde510bc05bc96962a2a659105233e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a54cde510bc05bc96962a2a659105233e"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>webb_et_al_ref</b></td></tr>
<tr class="separator:a54cde510bc05bc96962a2a659105233e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad810dba52bc8bfefd62cde8560d50689"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad810dba52bc8bfefd62cde8560d50689"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>_calc_phylo_abc_precision</b></td></tr>
<tr class="separator:ad810dba52bc8bfefd62cde8560d50689"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Avaliable Methods</h2></td></tr>
<tr class="memitem:a48f963ddb07aeb8ce09bcab34658f910"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a48f963ddb07aeb8ce09bcab34658f910">_calc_taxonomic_distinctness</a> ()</td></tr>
<tr class="separator:a48f963ddb07aeb8ce09bcab34658f910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5a00ccb8e1d8e5c2fc7747061b5ae1"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a5f5a00ccb8e1d8e5c2fc7747061b5ae1">_calc_pe</a> ()</td></tr>
<tr class="separator:a5f5a00ccb8e1d8e5c2fc7747061b5ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac19d73da74f42de683a05682d03a1993"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac19d73da74f42de683a05682d03a1993">_calc_pd</a> ()</td></tr>
<tr class="separator:ac19d73da74f42de683a05682d03a1993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8b992a802e1766f68623daf4785788"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#afd8b992a802e1766f68623daf4785788">_calc_phylo_aed_t</a> ()</td></tr>
<tr class="separator:afd8b992a802e1766f68623daf4785788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554090ce5a90ab9024a3765458a71b69"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a554090ce5a90ab9024a3765458a71b69">_calc_phylo_abc</a> ()</td></tr>
<tr class="separator:a554090ce5a90ab9024a3765458a71b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e64479299544c61f7a04df535d329a2"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a1e64479299544c61f7a04df535d329a2">_calc_phylo_mpd_mntd</a> ()</td></tr>
<tr class="separator:a1e64479299544c61f7a04df535d329a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a514dacbbfc1d00493f725622837f83f7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a514dacbbfc1d00493f725622837f83f7">get_metadata_calc_phylo_sorenson</a> ()</td></tr>
<tr class="separator:a514dacbbfc1d00493f725622837f83f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81f534d26abd7ae149f9efb3cb88986"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac81f534d26abd7ae149f9efb3cb88986">get_metadata__calc_phylo_aed_t</a> ()</td></tr>
<tr class="separator:ac81f534d26abd7ae149f9efb3cb88986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642069c10bb3902416b8d76e9931f6fe"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a642069c10bb3902416b8d76e9931f6fe">get_metadata_calc_phylo_mpd_mntd3</a> ()</td></tr>
<tr class="separator:a642069c10bb3902416b8d76e9931f6fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c93c235022d8aefedfb53e17849a4c6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2c93c235022d8aefedfb53e17849a4c6">calc_pd</a> ()</td></tr>
<tr class="separator:a2c93c235022d8aefedfb53e17849a4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada1e0945b1a543ed47e08d70ed6ce364"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ada1e0945b1a543ed47e08d70ed6ce364">calc_phylo_aed_t_wtlists</a> ()</td></tr>
<tr class="separator:ada1e0945b1a543ed47e08d70ed6ce364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a192d525b6e5de0dcc29289bbb53393ba"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a192d525b6e5de0dcc29289bbb53393ba">get_metadata_calc_phylo_aed_t_wtlists</a> ()</td></tr>
<tr class="separator:a192d525b6e5de0dcc29289bbb53393ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58eef8581208290e26a44a9ca338267d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a58eef8581208290e26a44a9ca338267d">calc_pe_lists</a> ()</td></tr>
<tr class="separator:a58eef8581208290e26a44a9ca338267d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec57fa7b2fc3ec002df8bee3bcfe5c24"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aec57fa7b2fc3ec002df8bee3bcfe5c24">get_metadata_calc_taxonomic_distinctness</a> ()</td></tr>
<tr class="separator:aec57fa7b2fc3ec002df8bee3bcfe5c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0e09968e4e1f16ba9c3d1abeb71d24"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8c0e09968e4e1f16ba9c3d1abeb71d24">get_node_abundance_global</a> ()</td></tr>
<tr class="separator:a8c0e09968e4e1f16ba9c3d1abeb71d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a1520401f99b57f3cb7c6404c33a5d3"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2a1520401f99b57f3cb7c6404c33a5d3">get_aed_scores</a> ()</td></tr>
<tr class="separator:a2a1520401f99b57f3cb7c6404c33a5d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8fc3311834bcc58c4ee9940f52f423"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aaa8fc3311834bcc58c4ee9940f52f423">get_metadata_calc_phylo_s2</a> ()</td></tr>
<tr class="separator:aaa8fc3311834bcc58c4ee9940f52f423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a58e46fc1f91f3b09f2ab3e2b4a869"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ae4a58e46fc1f91f3b09f2ab3e2b4a869">get_node_range_hash</a> ()</td></tr>
<tr class="separator:ae4a58e46fc1f91f3b09f2ab3e2b4a869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542c95486798e604d7d82a672850f4f0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a542c95486798e604d7d82a672850f4f0">calc_phylo_mpd_mntd3</a> ()</td></tr>
<tr class="separator:a542c95486798e604d7d82a672850f4f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f17003eef7301bfbd90a577ced22a7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa9f17003eef7301bfbd90a577ced22a7">calc_pd_node_list</a> ()</td></tr>
<tr class="separator:aa9f17003eef7301bfbd90a577ced22a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107ceadcbecc1f5c8c5440df42d84533"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a107ceadcbecc1f5c8c5440df42d84533">get_metadata_calc_pd_node_list</a> ()</td></tr>
<tr class="separator:a107ceadcbecc1f5c8c5440df42d84533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c43f5eb013442c1b0f9e3c4a98b168"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a11c43f5eb013442c1b0f9e3c4a98b168">get_metadata_calc_phylo_jaccard</a> ()</td></tr>
<tr class="separator:a11c43f5eb013442c1b0f9e3c4a98b168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6507228e59a22fbedbe1543d3812c315"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a6507228e59a22fbedbe1543d3812c315">calc_phylo_abc</a> ()</td></tr>
<tr class="separator:a6507228e59a22fbedbe1543d3812c315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ebb2beebb4ff2a71bec5b6ac0f1ac4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a04ebb2beebb4ff2a71bec5b6ac0f1ac4">get_node_range_hash_as_lists</a> ()</td></tr>
<tr class="separator:a04ebb2beebb4ff2a71bec5b6ac0f1ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689436af93945fc331ec13537d8af167"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a689436af93945fc331ec13537d8af167">calc_phylo_aed_t</a> ()</td></tr>
<tr class="separator:a689436af93945fc331ec13537d8af167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7222556869ce6b0d39b5178d0a16cc2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ab7222556869ce6b0d39b5178d0a16cc2">get_metadata_get_trimmed_tree</a> ()</td></tr>
<tr class="separator:ab7222556869ce6b0d39b5178d0a16cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7c83a3afd6a4041e28c15ce2803b92"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ada7c83a3afd6a4041e28c15ce2803b92">calc_phylo_s2</a> ()</td></tr>
<tr class="separator:ada7c83a3afd6a4041e28c15ce2803b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f42f2748f0c1027154266d1e9f589b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a10f42f2748f0c1027154266d1e9f589b">get_labels_not_on_tree</a> ()</td></tr>
<tr class="separator:a10f42f2748f0c1027154266d1e9f589b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92310db284ce699990dd5271b0f0768c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a92310db284ce699990dd5271b0f0768c">calc_phylo_aed</a> ()</td></tr>
<tr class="separator:a92310db284ce699990dd5271b0f0768c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44984ab0e02ece193ea6dd8e7284d0d4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a44984ab0e02ece193ea6dd8e7284d0d4">get_metadata_calc_pd_terminal_node_list</a> ()</td></tr>
<tr class="separator:a44984ab0e02ece193ea6dd8e7284d0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449c3e28e0f7ad2a2d053ca74b0e69a1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a449c3e28e0f7ad2a2d053ca74b0e69a1">get_metadata_calc_pe</a> ()</td></tr>
<tr class="separator:a449c3e28e0f7ad2a2d053ca74b0e69a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e694952ad3536e6a0a08af88e39648"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a04e694952ad3536e6a0a08af88e39648">default_mpd_mntd_results</a> ()</td></tr>
<tr class="separator:a04e694952ad3536e6a0a08af88e39648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affaad19b3b28612d8a842a7e02ca8791"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#affaad19b3b28612d8a842a7e02ca8791">get_metadata_get_global_node_abundance_hash</a> ()</td></tr>
<tr class="separator:affaad19b3b28612d8a842a7e02ca8791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8974fc6e847c02b4050224d19874435"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa8974fc6e847c02b4050224d19874435">calc_taxonomic_distinctness</a> ()</td></tr>
<tr class="separator:aa8974fc6e847c02b4050224d19874435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b67172500dbfe4f092bfaeb9de12c9"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a64b67172500dbfe4f092bfaeb9de12c9">calc_pe</a> ()</td></tr>
<tr class="separator:a64b67172500dbfe4f092bfaeb9de12c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4149e499fa48ba742a650a28adc6c0e2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4149e499fa48ba742a650a28adc6c0e2">get_metadata_calc_phylo_corrected_weighted_rarity</a> ()</td></tr>
<tr class="separator:a4149e499fa48ba742a650a28adc6c0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6683836a9ba2da2e87f0e88ec71e41a5"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a6683836a9ba2da2e87f0e88ec71e41a5">calc_phylo_sorenson</a> ()</td></tr>
<tr class="separator:a6683836a9ba2da2e87f0e88ec71e41a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d843eb6cf1a3d27d568d6de8e3e716f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8d843eb6cf1a3d27d568d6de8e3e716f">get_metadata_calc_pd_endemism</a> ()</td></tr>
<tr class="separator:a8d843eb6cf1a3d27d568d6de8e3e716f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5876cc4ea13b5fbbe67f9666499bd0"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aee5876cc4ea13b5fbbe67f9666499bd0">calc_phylo_mpd_mntd2</a> ()</td></tr>
<tr class="separator:aee5876cc4ea13b5fbbe67f9666499bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e6ae5f5a5fca162084505f4e6a4da7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a64e6ae5f5a5fca162084505f4e6a4da7">get_metadata_get_pe_element_cache</a> ()</td></tr>
<tr class="separator:a64e6ae5f5a5fca162084505f4e6a4da7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf2ef7dd0ca00d62184cf54607d583bd"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aaf2ef7dd0ca00d62184cf54607d583bd">get_metadata_calc_phylo_mpd_mntd1</a> ()</td></tr>
<tr class="separator:aaf2ef7dd0ca00d62184cf54607d583bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb0bf74f229d6aab22fafe1bbcd57c2d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#acb0bf74f229d6aab22fafe1bbcd57c2d">get_metadata_calc_taxonomic_distinctness_binary</a> ()</td></tr>
<tr class="separator:acb0bf74f229d6aab22fafe1bbcd57c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f5df0a04ff5c23b1d8e3c2919f7a5c5"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8f5df0a04ff5c23b1d8e3c2919f7a5c5">get_path_lengths_to_root_node</a> ()</td></tr>
<tr class="separator:a8f5df0a04ff5c23b1d8e3c2919f7a5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f31ed20a5b18f039b37d859b81a782"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a25f31ed20a5b18f039b37d859b81a782">calc_labels_not_on_tree</a> ()</td></tr>
<tr class="separator:a25f31ed20a5b18f039b37d859b81a782"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33a257fcafabfc96d56910cf3caa0cc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ad33a257fcafabfc96d56910cf3caa0cc">get_metadata_get_aed_scores</a> ()</td></tr>
<tr class="separator:ad33a257fcafabfc96d56910cf3caa0cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d095a4cd76acb6e483fd3c03dcaf90"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ab8d095a4cd76acb6e483fd3c03dcaf90">get_node_range</a> ()</td></tr>
<tr class="separator:ab8d095a4cd76acb6e483fd3c03dcaf90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1323b6818c6b5c3f28b6dd82decde20"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af1323b6818c6b5c3f28b6dd82decde20">get_mpd_mntd_metadata</a> ()</td></tr>
<tr class="separator:af1323b6818c6b5c3f28b6dd82decde20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe948113b1c178099a81f9ede7ee94f9"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#abe948113b1c178099a81f9ede7ee94f9">get_metadata_get_labels_not_on_tree</a> ()</td></tr>
<tr class="separator:abe948113b1c178099a81f9ede7ee94f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116b76363c525f76ff421f752c023ffd"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a116b76363c525f76ff421f752c023ffd">calc_pd_terminal_node_list</a> ()</td></tr>
<tr class="separator:a116b76363c525f76ff421f752c023ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d08257cc9e58fa3049ffbe9e8c56de"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a83d08257cc9e58fa3049ffbe9e8c56de">get_metadata_calc_phylo_aed_t</a> ()</td></tr>
<tr class="separator:a83d08257cc9e58fa3049ffbe9e8c56de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76da673e32cfa6fedf5ee81b3102631b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a76da673e32cfa6fedf5ee81b3102631b">calc_labels_on_tree</a> ()</td></tr>
<tr class="separator:a76da673e32cfa6fedf5ee81b3102631b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3cc9576e2cda52efc5c9aebfc0fb209"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af3cc9576e2cda52efc5c9aebfc0fb209">get_metadata__calc_pe</a> ()</td></tr>
<tr class="separator:af3cc9576e2cda52efc5c9aebfc0fb209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743a9a06da367cf468ad4cd8fc3eb755"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a743a9a06da367cf468ad4cd8fc3eb755">get_metadata_calc_labels_on_tree</a> ()</td></tr>
<tr class="separator:a743a9a06da367cf468ad4cd8fc3eb755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74aaae25e3217dedea64204e6d8ea60f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a74aaae25e3217dedea64204e6d8ea60f">get_trimmed_tree</a> ()</td></tr>
<tr class="separator:a74aaae25e3217dedea64204e6d8ea60f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a242c401cd29d200f45196fb8f78d2140"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a242c401cd29d200f45196fb8f78d2140">get_path_length_cache</a> ()</td></tr>
<tr class="separator:a242c401cd29d200f45196fb8f78d2140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c5a178a5538aee3e4c81f9af95e38d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a06c5a178a5538aee3e4c81f9af95e38d">get_global_node_abundance_hash</a> ()</td></tr>
<tr class="separator:a06c5a178a5538aee3e4c81f9af95e38d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a8a91c9e5fc69602b24f8cf34bb1e1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a20a8a91c9e5fc69602b24f8cf34bb1e1">get_metadata_calc_pe_lists</a> ()</td></tr>
<tr class="separator:a20a8a91c9e5fc69602b24f8cf34bb1e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadd771887dac28834a9ef774cd51adc4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aadd771887dac28834a9ef774cd51adc4">get_metadata_calc_phylo_abc</a> ()</td></tr>
<tr class="separator:aadd771887dac28834a9ef774cd51adc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66952c05ab3d8382776a840aa19ec3e2"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a66952c05ab3d8382776a840aa19ec3e2">get_metadata_get_path_lengths_to_root_node</a> ()</td></tr>
<tr class="separator:a66952c05ab3d8382776a840aa19ec3e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22399970061a4799f9b84c4d5b34953e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a22399970061a4799f9b84c4d5b34953e">get_metadata_get_phylo_mpd_mntd_matrix</a> ()</td></tr>
<tr class="separator:a22399970061a4799f9b84c4d5b34953e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb71ecea709d59c994a40c887c55418"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4fb71ecea709d59c994a40c887c55418">get_metadata_calc_pe_single</a> ()</td></tr>
<tr class="separator:a4fb71ecea709d59c994a40c887c55418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aed3c2b5292759e8042899894be19c8"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8aed3c2b5292759e8042899894be19c8">get_metadata_calc_pd</a> ()</td></tr>
<tr class="separator:a8aed3c2b5292759e8042899894be19c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d392a516bde6a56713a368d3bc246f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac0d392a516bde6a56713a368d3bc246f">get_metadata_calc_labels_not_on_tree</a> ()</td></tr>
<tr class="separator:ac0d392a516bde6a56713a368d3bc246f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e2211da03a97e8ffe3dd0b24f24bcb"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a54e2211da03a97e8ffe3dd0b24f24bcb">get_metadata__calc_pd</a> ()</td></tr>
<tr class="separator:a54e2211da03a97e8ffe3dd0b24f24bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c769609093626177369f59ec8bd00ec"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a0c769609093626177369f59ec8bd00ec">get_metadata_get_node_range_hash</a> ()</td></tr>
<tr class="separator:a0c769609093626177369f59ec8bd00ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed4743cdb2a7e49c59f75802751745c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4ed4743cdb2a7e49c59f75802751745c">get_metadata_get_node_range_hash_as_lists</a> ()</td></tr>
<tr class="separator:a4ed4743cdb2a7e49c59f75802751745c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef9ec33b8880de4d7a1227228c5a0e7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a0ef9ec33b8880de4d7a1227228c5a0e7">get_metadata_get_trimmed_tree_as_matrix</a> ()</td></tr>
<tr class="separator:a0ef9ec33b8880de4d7a1227228c5a0e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a6ce9e061f978c0a8d8750d82975b4"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af6a6ce9e061f978c0a8d8750d82975b4">get_trimmed_tree_as_matrix</a> ()</td></tr>
<tr class="separator:af6a6ce9e061f978c0a8d8750d82975b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c34083719a3d5caf763ed065fc8326"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a43c34083719a3d5caf763ed065fc8326">get_metadata_calc_phylo_mpd_mntd2</a> ()</td></tr>
<tr class="separator:a43c34083719a3d5caf763ed065fc8326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa28e7c7454b6747f3b4bdfa39a2b53c7"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa28e7c7454b6747f3b4bdfa39a2b53c7">calc_phylo_corrected_weighted_endemism</a> ()</td></tr>
<tr class="separator:aa28e7c7454b6747f3b4bdfa39a2b53c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15c996d950da88aebd24eb3489e1826c"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a15c996d950da88aebd24eb3489e1826c">get_metadata_calc_phylo_aed</a> ()</td></tr>
<tr class="separator:a15c996d950da88aebd24eb3489e1826c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a192ace354325740fbb3c1879ff46c5cb"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a192ace354325740fbb3c1879ff46c5cb">calc_pe_single</a> ()</td></tr>
<tr class="separator:a192ace354325740fbb3c1879ff46c5cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3911885c5ea540cf08d754ba847efc53"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a3911885c5ea540cf08d754ba847efc53">calc_taxonomic_distinctness_binary</a> ()</td></tr>
<tr class="separator:a3911885c5ea540cf08d754ba847efc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f4b66cfd7e10dddfa92dfec12fcf62"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a23f4b66cfd7e10dddfa92dfec12fcf62">calc_pd_endemism</a> ()</td></tr>
<tr class="separator:a23f4b66cfd7e10dddfa92dfec12fcf62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95666a1d09854d55caf95b970f6fb943"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a95666a1d09854d55caf95b970f6fb943">get_metadata_get_path_length_cache</a> ()</td></tr>
<tr class="separator:a95666a1d09854d55caf95b970f6fb943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3399d7275e08d4a146d0a1e508541bc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ad3399d7275e08d4a146d0a1e508541bc">calc_phylo_corrected_weighted_rarity</a> ()</td></tr>
<tr class="separator:ad3399d7275e08d4a146d0a1e508541bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed787eefc553576a2e017bbd52dcfa13"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aed787eefc553576a2e017bbd52dcfa13">get_pe_element_cache</a> ()</td></tr>
<tr class="separator:aed787eefc553576a2e017bbd52dcfa13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ab698c19d8593cae1d50e29f9cf682"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a33ab698c19d8593cae1d50e29f9cf682">calc_phylo_mpd_mntd1</a> ()</td></tr>
<tr class="separator:a33ab698c19d8593cae1d50e29f9cf682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7f04f5cb6f8b74b7842313421b67fe"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a5f7f04f5cb6f8b74b7842313421b67fe">get_metadata_calc_phylo_corrected_weighted_endemism</a> ()</td></tr>
<tr class="separator:a5f7f04f5cb6f8b74b7842313421b67fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63741a662d99cc0224f1e9d1e3c13b7e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a63741a662d99cc0224f1e9d1e3c13b7e">get_phylo_mpd_mntd_matrix</a> ()</td></tr>
<tr class="separator:a63741a662d99cc0224f1e9d1e3c13b7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e163442c3ec88f7e8de614683b50a47"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a7e163442c3ec88f7e8de614683b50a47">calc_phylo_jaccard</a> ()</td></tr>
<tr class="separator:a7e163442c3ec88f7e8de614683b50a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="NAME"></a>
NAME</h1>
<p><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html">Biodiverse::Indices::Phylogenetic</a></p>
<h1><a class="anchor" id="SYNOPSIS"></a>
SYNOPSIS</h1>
<pre>  use <a class="el" href="classBiodiverse_1_1Indices.html">Biodiverse::Indices</a>;</pre><h1><a class="anchor" id="DESCRIPTION"></a>
DESCRIPTION</h1>
<p><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html">Phylogenetic</a> indices for the Biodiverse system. It is inherited by <a class="el" href="classBiodiverse_1_1Indices.html">Biodiverse::Indices</a> and not to be used on it own.</p>
<p>See <a href="http://code.google.com/p/biodiverse/wiki/Indices">http://code.google.com/p/biodiverse/wiki/Indices</a> for more details.</p>
<h1><a class="anchor" id="METHODS"></a>
METHODS</h1>
<ul>
<li>
<a class="anchor" id="item_INSERT_METHODS"></a><b>INSERT METHODS</b>  </li>
</ul>
<h1><a class="anchor" id="REPORTING_ERRORS"></a>
REPORTING ERRORS</h1>
<p>Use the issue tracker at <a href="http://www.purl.org/biodiverse">http://www.purl.org/biodiverse</a></p>
<h1><a class="anchor" id="COPYRIGHT"></a>
COPYRIGHT</h1>
<p>Copyright (c) 2010 Shawn Laffan. All rights reserved.</p>
<h1><a class="anchor" id="LICENSE"></a>
LICENSE</h1>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>For a full copy of the license see &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>

<p>Definition at line <a class="el" href="Phylogenetic_8pm_source.html#l00053">53</a> of file <a class="el" href="Phylogenetic_8pm_source.html">Phylogenetic.pm</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac19d73da74f42de683a05682d03a1993"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_pd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_pd' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_pd-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_pd-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_pd-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_pd: 43</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac19d73da74f42de683a05682d03a1993">_calc_pd</a> { #  calculate the phylogenetic diversity of the species in the central elements only</div>
<div class="line"><span class="preprocessor">              #  this function expects a tree reference as an argument.</span></div>
<div class="line"><span class="preprocessor"></span>    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $tree_ref   = $args{tree_ref};</div>
<div class="line">    my $label_list = $args{PHYLO_LABELS_ON_TREE};</div>
<div class="line">    my $richness   = scalar keys %$label_list;</div>
<div class="line"></div>
<div class="line">    my $nodes_in_path = $self-&gt;get_path_lengths_to_root_node (</div>
<div class="line">        @_,</div>
<div class="line">        labels =&gt; $label_list,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $PD_score = sum values %$nodes_in_path;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  need to use node length instead of 1</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #my %included_nodes;</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #@included_nodes{keys %$nodes_in_path} = (1) x scalar keys %$nodes_in_path;</span></div>
<div class="line"><span class="preprocessor"></span>    my %included_nodes = %$nodes_in_path;</div>
<div class="line"></div>
<div class="line">    my ($PD_P, $PD_per_taxon, $PD_P_per_taxon);</div>
<div class="line">    {</div>
<div class="line">        no warnings <span class="stringliteral">&#39;uninitialized&#39;</span>;</div>
<div class="line">        <span class="keywordflow">if</span> ($PD_score) {  # only <span class="keywordflow">if</span> we have some PD</div>
<div class="line">            $PD_P = $PD_score / $tree_ref-&gt;get_total_tree_length;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $PD_per_taxon   = eval {$PD_score / $richness};</div>
<div class="line">        $PD_P_per_taxon = eval {$PD_P / $richness};</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    my %results = (</div>
<div class="line">        PD                =&gt; $PD_score,</div>
<div class="line">        PD_P              =&gt; $PD_P,</div>
<div class="line">        PD_per_taxon      =&gt; $PD_per_taxon,</div>
<div class="line">        PD_P_per_taxon    =&gt; $PD_P_per_taxon,</div>
<div class="line"></div>
<div class="line">        PD_INCLUDED_NODE_LIST =&gt; \%included_nodes,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5f5a00ccb8e1d8e5c2fc7747061b5ae1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_pe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_pe' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_pe-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_pe-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_pe-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_pe: 100</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a5f5a00ccb8e1d8e5c2fc7747061b5ae1">_calc_pe</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;    </div>
<div class="line"></div>
<div class="line">    my $tree_ref         = $args{trimmed_tree};</div>
<div class="line">    my $node_ranges      = $args{node_range};</div>
<div class="line">    my $results_cache    = $args{PE_RESULTS_CACHE};</div>
<div class="line">    my $element_list_all = $args{element_list_all};</div>
<div class="line"></div>
<div class="line">    my $bd = $args{basedata_ref} || $self-&gt;get_basedata_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #create a hash of terminal nodes for the taxa present</span></div>
<div class="line"><span class="preprocessor"></span>    my $all_nodes = $tree_ref-&gt;get_node_hash;</div>
<div class="line"></div>
<div class="line">    my $root_node = $tree_ref-&gt;get_tree_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  default these to undef - more meaningful than zero</span></div>
<div class="line"><span class="preprocessor"></span>    my ($PE_WE, $PE_WE_P);</div>
<div class="line"></div>
<div class="line">    my %ranges;</div>
<div class="line">    my %wts;</div>
<div class="line">    my %local_ranges;</div>
<div class="line">    my %unweighted_wts;  #  count once <span class="keywordflow">for each</span> label, not weighted by group</div>
<div class="line">    my %nodes_in_path;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $group (@$element_list_all) {</div>
<div class="line">        my $results;</div>
<div class="line"><span class="preprocessor">        #  use the cached results for a group if present</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (exists $results_cache-&gt;{$group}) {</div>
<div class="line">            $results = $results_cache-&gt;{$group};</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">        #  else build them and cache them</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">else</span> {</div>
<div class="line">            my $labels = $bd-&gt;get_labels_in_group_as_hash (group =&gt; $group);</div>
<div class="line">            my $nodes_in_path = $self-&gt;get_path_lengths_to_root_node (</div>
<div class="line">                @_,</div>
<div class="line">                labels =&gt; $labels,</div>
<div class="line">            );</div>
<div class="line">     </div>
<div class="line">            my ($gp_score, %gp_wts, %gp_ranges);</div>
<div class="line">            </div>
<div class="line"><span class="preprocessor">            #  loop over the nodes and run the calcs</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">while</span> (my ($name, $length) = each %$nodes_in_path) {</div>
<div class="line">                my $range = $node_ranges-&gt;{$name};</div>
<div class="line">                my $wt    = eval {$length / $range} || 0;</div>
<div class="line">                $gp_score += $wt;</div>
<div class="line">                $gp_wts{$name}    = $wt;</div>
<div class="line">                $gp_ranges{$name} = $range;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $results = {</div>
<div class="line">                PE_WE           =&gt; $gp_score,</div>
<div class="line">                wts             =&gt; \%gp_wts,</div>
<div class="line">                ranges          =&gt; \%gp_ranges,</div>
<div class="line">                nodes_in_path   =&gt; $nodes_in_path,</div>
<div class="line">            };</div>
<div class="line"></div>
<div class="line">            $results_cache-&gt;{$group} = $results;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (defined $results-&gt;{PE_WE}) {</div>
<div class="line">            $PE_WE += $results-&gt;{PE_WE};</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        my $hash_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # ranges are invariant, so can be crashed together</span></div>
<div class="line"><span class="preprocessor"></span>        $hash_ref = $results-&gt;{ranges};</div>
<div class="line">        @ranges{keys %$hash_ref} = values %$hash_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # nodes are also invariant</span></div>
<div class="line"><span class="preprocessor"></span>        $hash_ref = $results-&gt;{nodes_in_path};</div>
<div class="line">        @nodes_in_path{keys %$hash_ref} = values %$hash_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        # weights need to be summed</span></div>
<div class="line"><span class="preprocessor"></span>        $hash_ref = $results-&gt;{wts};</div>
<div class="line">        <span class="keywordflow">foreach</span> my $node (keys %$hash_ref) {</div>
<div class="line">            $wts{$node} += $hash_ref-&gt;{$node};</div>
<div class="line">            $local_ranges{$node}++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        no warnings <span class="stringliteral">&#39;uninitialized&#39;</span>;</div>
<div class="line">        my $total_tree_length = $tree_ref-&gt;get_total_tree_length;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #Phylogenetic endemism = sum for all nodes of: (branch length/total tree length) / node range</span></div>
<div class="line"><span class="preprocessor"></span>        $PE_WE_P = eval {$PE_WE / $total_tree_length};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PE_WE          =&gt; $PE_WE,</div>
<div class="line">        PE_WE_P        =&gt; $PE_WE_P,</div>
<div class="line">        PE_WTLIST      =&gt; \%wts,</div>
<div class="line">        PE_RANGELIST   =&gt; \%ranges,</div>
<div class="line">        PE_LOCAL_RANGELIST =&gt; \%local_ranges,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a554090ce5a90ab9024a3765458a71b69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_phylo_abc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_phylo_abc' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_phylo_abc-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_phylo_abc-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_phylo_abc-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_phylo_abc: 72</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a554090ce5a90ab9024a3765458a71b69">_calc_phylo_abc</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $label_hash1 = $args{label_hash1};</div>
<div class="line">    my $label_hash2 = $args{label_hash2};</div>
<div class="line"></div>
<div class="line">    my $tree = $args{trimmed_tree};</div>
<div class="line"></div>
<div class="line">    my $nodes_in_path1 = $self-&gt;get_path_lengths_to_root_node (</div>
<div class="line">        %args,</div>
<div class="line">        labels   =&gt; $label_hash1,</div>
<div class="line">        tree_ref =&gt; $tree,</div>
<div class="line">        el_list  =&gt; $args{element_list1},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my $nodes_in_path2 = $self-&gt;get_path_lengths_to_root_node (</div>
<div class="line">        %args,</div>
<div class="line">        labels   =&gt; $label_hash2,</div>
<div class="line">        tree_ref =&gt; $tree,</div>
<div class="line">        el_list  =&gt; $args{element_list2},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %A = (%$nodes_in_path1, %$nodes_in_path2); </div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # create a new hash %B for nodes in label hash 1 but not 2</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    # then get length of B</span></div>
<div class="line"><span class="preprocessor"></span>    my %B = %A;</div>
<div class="line">    <span class="keyword">delete</span> @B{keys %$nodes_in_path2};</div>
<div class="line">    my $phylo_B = sum (0, values %B);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # create a new hash %C for nodes in label hash 2 but not 1</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    # then get length of C</span></div>
<div class="line"><span class="preprocessor"></span>    my %C = %A;</div>
<div class="line">    <span class="keyword">delete</span> @C{keys %$nodes_in_path1};</div>
<div class="line">    my $phylo_C = sum (0, values %C);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    # get length of %A = branches not in %B or %C</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keyword">delete</span> @A{keys %B, keys %C};</div>
<div class="line">    my $phylo_A = sum (0, values %A);</div>
<div class="line"></div>
<div class="line">    my $phylo_ABC = $phylo_A + $phylo_B + $phylo_C;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  return the values but reduce the precision to avoid</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  floating point problems later on</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    $phylo_A = 0 + $self-&gt;set_precision (</div>
<div class="line">        precision =&gt; $_calc_phylo_abc_precision,</div>
<div class="line">        value     =&gt; $phylo_A,</div>
<div class="line">    );</div>
<div class="line">    $phylo_B = 0 + $self-&gt;set_precision (</div>
<div class="line">        precision =&gt; $_calc_phylo_abc_precision,</div>
<div class="line">        value     =&gt; $phylo_B,</div>
<div class="line">    );</div>
<div class="line">    $phylo_C = 0 + $self-&gt;set_precision (</div>
<div class="line">        precision =&gt; $_calc_phylo_abc_precision,</div>
<div class="line">        value     =&gt; $phylo_C,</div>
<div class="line">    );</div>
<div class="line">    $phylo_ABC = 0 + $self-&gt;set_precision (</div>
<div class="line">        precision =&gt; $_calc_phylo_abc_precision,</div>
<div class="line">        value     =&gt; $phylo_ABC,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_A   =&gt; $phylo_A,</div>
<div class="line">        PHYLO_B   =&gt; $phylo_B,</div>
<div class="line">        PHYLO_C   =&gt; $phylo_C,</div>
<div class="line">        PHYLO_ABC =&gt; $phylo_ABC,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="afd8b992a802e1766f68623daf4785788"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_phylo_aed_t </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_phylo_aed_t' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_phylo_aed_t-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_phylo_aed_t-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_phylo_aed_t-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_phylo_aed_t: 25</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#afd8b992a802e1766f68623daf4785788">_calc_phylo_aed_t</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $aed_hash   = $args{PHYLO_AED_LIST};</div>
<div class="line">    my $label_hash = $args{label_hash_all};</div>
<div class="line">    my $aed_t;</div>
<div class="line">    my %scores;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (keys %$label_hash) {</div>
<div class="line">        my $abundance = $label_hash-&gt;{$label};</div>
<div class="line">        my $aed_score = $aed_hash-&gt;{$label};</div>
<div class="line">        my $weight    = $abundance * $aed_score;</div>
<div class="line"></div>
<div class="line">        $scores{$label} = $weight;</div>
<div class="line">        $aed_t += $weight;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_AED_T        =&gt; $aed_t,</div>
<div class="line">        PHYLO_AED_T_WTLIST =&gt; \%scores,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a1e64479299544c61f7a04df535d329a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_phylo_mpd_mntd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_phylo_mpd_mntd' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_phylo_mpd_mntd-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_phylo_mpd_mntd-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_phylo_mpd_mntd-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_phylo_mpd_mntd: 135</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a1e64479299544c61f7a04df535d329a2">_calc_phylo_mpd_mntd</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $label_hash1 = $args{label_hash1};</div>
<div class="line">    my $label_hash2 = $args{label_hash2};</div>
<div class="line">    my $mx          = $args{PHYLO_MPD_MNTD_MATRIX}</div>
<div class="line">      || croak <span class="stringliteral">&quot;Argument PHYLO_MPD_MNTD_MATRIX not defined\n&quot;</span>;</div>
<div class="line">    my $labels_on_tree = $args{PHYLO_LABELS_ON_TREE};</div>
<div class="line">    my $tree_ref       = $args{tree_ref};</div>
<div class="line">    my $abc_num        = $args{abc_num} || 1;</div>
<div class="line">    my $use_wts        = $abc_num == 1 ? $args{mpd_mntd_use_wts} : 1;</div>
<div class="line">    my $return_means_only       = $args{mpd_mntd_means_only};</div>
<div class="line">    my $label_hashrefs_are_same = $label_hash1 eq $label_hash2;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;default_mpd_mntd_results (@_)</div>
<div class="line">        <span class="keywordflow">if</span> $label_hashrefs_are_same</div>
<div class="line">           &amp;&amp; scalar keys %$label_hash1 == 1;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Are we on the tree and have a non-zero count?</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  Could be a needless slowdown under permutations using only labels on the tree.</span></div>
<div class="line"><span class="preprocessor"></span>    my @labels1 = sort grep { exists $labels_on_tree-&gt;{$_} &amp;&amp; $label_hash1-&gt;{$_}} keys %$label_hash1;</div>
<div class="line">    my @labels2 = $label_hashrefs_are_same</div>
<div class="line">        ? @labels1</div>
<div class="line">        : sort grep { exists $labels_on_tree-&gt;{$_} &amp;&amp; $label_hash2-&gt;{$_} } keys %$label_hash2;</div>
<div class="line"></div>
<div class="line">    my (@mpd_path_lengths, @mntd_path_lengths, @mpd_wts, @mntd_wts);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Loop over all possible pairs, </span></div>
<div class="line"><span class="preprocessor"></span>    BY_LABEL:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $label1 (@labels1) {</div>
<div class="line">        my $label_count1 = $label_hash1-&gt;{$label1};</div>
<div class="line"></div>
<div class="line">        my @mpd_path_lengths_this_node;</div>
<div class="line">        my @mntd_path_lengths_this_node;</div>
<div class="line">        my @mpd_wts_this_node;</div>
<div class="line">        my $i = 0;</div>
<div class="line"></div>
<div class="line">        LABEL2:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $label2 (@labels2) {</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  skip same labels (FIXME: but not if used as dissim measure)</span></div>
<div class="line"><span class="preprocessor"></span>            next LABEL2 <span class="keywordflow">if</span> $label1 eq $label2;</div>
<div class="line"></div>
<div class="line">            my $label_count2 = $label_hash2-&gt;{$label2};</div>
<div class="line"></div>
<div class="line">            my $path_length = $mx-&gt;get_value(</div>
<div class="line">                element1 =&gt; $label1,</div>
<div class="line">                element2 =&gt; $label2,</div>
<div class="line">            );</div>
<div class="line">            <span class="keywordflow">if</span> (!defined $path_length) {  #  need to calculate it</div>
<div class="line">                my $last_ancestor = $tree_ref-&gt;get_last_shared_ancestor_for_nodes (</div>
<div class="line">                    node_names =&gt; {$label1 =&gt; 1, $label2 =&gt; 1},</div>
<div class="line">                );</div>
<div class="line"></div>
<div class="line">                my %path;</div>
<div class="line">                <span class="keywordflow">foreach</span> my $node_name ($label1, $label2) {</div>
<div class="line">                    my $node_ref = $tree_ref-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line">                    my $sub_path = $node_ref-&gt;get_path_lengths_to_ancestral_node (</div>
<div class="line">                        ancestral_node =&gt; $last_ancestor,</div>
<div class="line">                        %args,</div>
<div class="line">                    );</div>
<div class="line">                    @path{keys %$sub_path} = values %$sub_path;</div>
<div class="line">                }</div>
<div class="line">                <span class="keyword">delete</span> $path{$last_ancestor-&gt;get_name()};</div>
<div class="line">                $path_length = sum values %path;</div>
<div class="line">                $mx-&gt;set_value(</div>
<div class="line">                    element1 =&gt; $label1,</div>
<div class="line">                    element2 =&gt; $label2,</div>
<div class="line">                    value    =&gt; $path_length,</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            push @mpd_path_lengths_this_node, $path_length;</div>
<div class="line">            push @mntd_path_lengths_this_node, $path_length;</div>
<div class="line">            <span class="keywordflow">if</span> ($use_wts) {</div>
<div class="line">                push @mpd_wts_this_node, $label_count2;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $i ++;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ($i) {  #  only <span class="keywordflow">if</span> we added something</div>
<div class="line"><span class="preprocessor">            #  weighting scheme won&#39;t work with non-integer wts - need to use weighted stats</span></div>
<div class="line"><span class="preprocessor"></span>            push @mpd_path_lengths, @mpd_path_lengths_this_node;</div>
<div class="line">            my $min = min (@mntd_path_lengths_this_node);</div>
<div class="line">            push @mntd_path_lengths, $min;</div>
<div class="line">            <span class="keywordflow">if</span> ($use_wts) {</div>
<div class="line">                push @mpd_wts, map {$_ * $label_count1} @mpd_wts_this_node;</div>
<div class="line">                push @mntd_wts, $label_count1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results;</div>
<div class="line"></div>
<div class="line">    my @paths = (\@mntd_path_lengths, \@mpd_path_lengths);</div>
<div class="line">    my @pfxs  = qw /PNTD PMPD/;</div>
<div class="line">    my $i = -1;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $path (@paths) {</div>
<div class="line">        $i++;</div>
<div class="line"></div>
<div class="line">        my $pfx  = $pfxs[$i] . $abc_num;</div>
<div class="line">        my ($mean, $n, $wts);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ($use_wts) {</div>
<div class="line">            $wts  = $pfx =~ /^PMPD/ ? \@mpd_wts : \@mntd_wts;</div>
<div class="line">            $n    = sum @$wts;</div>
<div class="line">            $mean = eval {sum (pairwise {$a * $b} @$path, @$wts) / $n};</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            $n    = scalar @$path;</div>
<div class="line">            $mean = eval {sum (@$path) / $n};;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_MEAN&#39;</span>} = $mean;</div>
<div class="line"></div>
<div class="line">        next <span class="keywordflow">if</span> $return_means_only;</div>
<div class="line"></div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_N&#39;</span>}   = $n;</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_MIN&#39;</span>} = min @$path;</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_MAX&#39;</span>} = max @$path;</div>
<div class="line"></div>
<div class="line">        my $rmsd;</div>
<div class="line">        <span class="keywordflow">if</span> ($n) {</div>
<div class="line">            my $sumsq = $use_wts</div>
<div class="line">                ? sum (pairwise {$a ** 2 * $b} @$path, @$wts)</div>
<div class="line">                : sum (map {$_ ** 2} @$path);</div>
<div class="line">            $rmsd = sqrt ($sumsq / $n);</div>
<div class="line">        }</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_RMSD&#39;</span>} = $rmsd;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a48f963ddb07aeb8ce09bcab34658f910"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::Phylogenetic::_calc_taxonomic_distinctness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_calc_taxonomic_distinctness' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_calc_taxonomic_distinctness-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_calc_taxonomic_distinctness-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_calc_taxonomic_distinctness-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _calc_taxonomic_distinctness: 79</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a48f963ddb07aeb8ce09bcab34658f910">_calc_taxonomic_distinctness</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $label_hash = $args{label_hash_all};</div>
<div class="line">    my $tree = $args{trimmed_tree};</div>
<div class="line"></div>
<div class="line">    my $numerator;</div>
<div class="line">    my $denominator = 0;</div>
<div class="line">    my $ssq_wtd_value;</div>
<div class="line">    my @labels = sort keys %$label_hash;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  Need to loop over each label and get the weighted contribution</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  for each level of the tree.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  The weight for each comparison is the distance along the tree to</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  the shared ancestor.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #  We should use the distance from node a to b to avoid doubled comparisons</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  and use get_path_to_node for the full path length.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  We can pop from @labels as we go to achieve this</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  (this is the i&lt;j constraint from Warwick &amp; Clarke, but used in reverse)</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line"><span class="preprocessor">    #  Actually, it&#39;s simpler to loop over the list twice and get the lengths to shared ancestor</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line">    BY_LABEL:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (@labels) {</div>
<div class="line">        my $label_count1 = $label_hash-&gt;{$label};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  save some calcs (if ever this happens)</span></div>
<div class="line"><span class="preprocessor"></span>        next BY_LABEL <span class="keywordflow">if</span> $label_count1 == 0;</div>
<div class="line"></div>
<div class="line">        my $node = $tree-&gt;get_node_ref (node =&gt; $label);</div>
<div class="line"></div>
<div class="line">        LABEL2:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $label2 (@labels) {</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  skip same labels</span></div>
<div class="line"><span class="preprocessor"></span>            next LABEL2 <span class="keywordflow">if</span> $label eq $label2;</div>
<div class="line"></div>
<div class="line">            my $label_count2 = $label_hash-&gt;{$label2};</div>
<div class="line">            next LABEL2 <span class="keywordflow">if</span> $label_count2 == 0;</div>
<div class="line"></div>
<div class="line">            my $node2 = $tree-&gt;get_node_ref (node =&gt; $label2);</div>
<div class="line"></div>
<div class="line">            my $ancestor = $node-&gt;get_shared_ancestor (node =&gt; $node2);</div>
<div class="line"></div>
<div class="line">            my $path_length = $ancestor-&gt;get_total_length</div>
<div class="line">                            - $node2-&gt;get_total_length;</div>
<div class="line"></div>
<div class="line">            my $weight = $label_count1 * $label_count2;</div>
<div class="line"></div>
<div class="line">            my $wtd_value = $path_length * $weight;</div>
<div class="line"></div>
<div class="line">            $numerator     += $wtd_value;</div>
<div class="line">            $ssq_wtd_value += $wtd_value ** 2;</div>
<div class="line">            $denominator   += $weight;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $distinctness;</div>
<div class="line">    my $variance;</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        no warnings <span class="stringliteral">&#39;uninitialized&#39;</span>;</div>
<div class="line">        $distinctness  = eval {$numerator / $denominator};</div>
<div class="line">        $variance = eval {$ssq_wtd_value / $denominator - $distinctness ** 2}</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        TD_DISTINCTNESS =&gt; $distinctness,</div>
<div class="line">        TD_DENOMINATOR  =&gt; $denominator,</div>
<div class="line">        TD_NUMERATOR    =&gt; $numerator,</div>
<div class="line">        TD_VARIATION    =&gt; $variance,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a25f31ed20a5b18f039b37d859b81a782"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_labels_not_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_labels_not_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_labels_not_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_labels_not_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_labels_not_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_labels_not_on_tree: 28</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a25f31ed20a5b18f039b37d859b81a782">calc_labels_not_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $not_on_tree = $args{labels_not_on_tree};</div>
<div class="line"></div>
<div class="line">    my %labels1 = %{$args{label_hash_all}};</div>
<div class="line">    my $richness = scalar keys %labels1;</div>
<div class="line">    <span class="keyword">delete</span> @labels1{keys %$not_on_tree};</div>
<div class="line"></div>
<div class="line">    my %labels2 = %{$args{label_hash_all}};</div>
<div class="line">    <span class="keyword">delete</span> @labels2{keys %labels1};</div>
<div class="line"></div>
<div class="line">    my $count_not_on_tree = scalar keys %labels2;</div>
<div class="line">    my $p_not_on_tree;</div>
<div class="line">    {</div>
<div class="line">        no warnings <span class="stringliteral">&#39;numeric&#39;</span>;</div>
<div class="line">        $p_not_on_tree = eval { $count_not_on_tree / $richness } || 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_LABELS_NOT_ON_TREE   =&gt; \%labels2,</div>
<div class="line">        PHYLO_LABELS_NOT_ON_TREE_N =&gt; $count_not_on_tree,</div>
<div class="line">        PHYLO_LABELS_NOT_ON_TREE_P =&gt; $p_not_on_tree,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a76da673e32cfa6fedf5ee81b3102631b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_labels_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_labels_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_labels_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_labels_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_labels_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_labels_on_tree: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a76da673e32cfa6fedf5ee81b3102631b">calc_labels_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my %labels = %{$args{label_hash_all}};</div>
<div class="line">    my $not_on_tree = $args{labels_not_on_tree};</div>
<div class="line">    <span class="keyword">delete</span> @labels{keys %$not_on_tree};</div>
<div class="line">    </div>
<div class="line">    my %results = (PHYLO_LABELS_ON_TREE =&gt; \%labels);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a2c93c235022d8aefedfb53e17849a4c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pd' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pd-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pd-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pd-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pd: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2c93c235022d8aefedfb53e17849a4c6">calc_pd</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my @keys = qw /PD PD_P PD_per_taxon PD_P_per_taxon/;</div>
<div class="line">    my %results;</div>
<div class="line">    @results{@keys} = @args{@keys};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a23f4b66cfd7e10dddfa92dfec12fcf62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pd_endemism </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pd_endemism' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pd_endemism-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pd_endemism-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pd_endemism-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pd_endemism: 27</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a23f4b66cfd7e10dddfa92dfec12fcf62">calc_pd_endemism</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $weights = $args{PE_WTLIST};</div>
<div class="line">    my $tree_ref = $args{trimmed_tree};</div>
<div class="line">    </div>
<div class="line">    my $pd_e;</div>
<div class="line">    my %pd_e_wts;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (keys %$weights) {</div>
<div class="line">        my $wt = $weights-&gt;{$label};</div>
<div class="line">        my $tree_node = $tree_ref-&gt;get_node_ref(node =&gt; $label);</div>
<div class="line">        my $length = $tree_node-&gt;get_length;</div>
<div class="line">        next <span class="keywordflow">if</span> $wt != $length || $wt == 0;</div>
<div class="line"></div>
<div class="line">        $pd_e += $wt;</div>
<div class="line">        $pd_e_wts{$label} = $wt;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PD_ENDEMISM     =&gt; $pd_e,</div>
<div class="line">        PD_ENDEMISM_WTS =&gt; \%pd_e_wts,</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa9f17003eef7301bfbd90a577ced22a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pd_node_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pd_node_list' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pd_node_list-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pd_node_list-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pd_node_list-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pd_node_list: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa9f17003eef7301bfbd90a577ced22a7">calc_pd_node_list</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my @keys = qw /PD_INCLUDED_NODE_LIST/;</div>
<div class="line"></div>
<div class="line">    my %results;</div>
<div class="line">    @results{@keys} = @args{@keys};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a116b76363c525f76ff421f752c023ffd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pd_terminal_node_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pd_terminal_node_list' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pd_terminal_node_list-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pd_terminal_node_list-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pd_terminal_node_list-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pd_terminal_node_list: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a116b76363c525f76ff421f752c023ffd">calc_pd_terminal_node_list</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $tree_ref = $args{tree_ref};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  loop over nodes and just keep terminals</span></div>
<div class="line"><span class="preprocessor"></span>    my $pd_included_node_list = $args{PD_INCLUDED_NODE_LIST};</div>
<div class="line">    my @keys = keys %$pd_included_node_list;</div>
<div class="line">    my %node_hash = %{$tree_ref-&gt;get_node_hash};</div>
<div class="line"></div>
<div class="line">    my %terminals;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_name (@keys) {</div>
<div class="line">        next <span class="keywordflow">if</span> ! $tree_ref-&gt;get_node_ref(node =&gt; $node_name)-&gt;is_terminal_node;</div>
<div class="line">        $terminals{$node_name} = $pd_included_node_list-&gt;{$node_name};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PD_INCLUDED_TERMINAL_NODE_LIST =&gt; \%terminals,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a64b67172500dbfe4f092bfaeb9de12c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pe' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pe-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pe-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pe-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pe: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a64b67172500dbfe4f092bfaeb9de12c9">calc_pe</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my @keys = qw /PE_WE PE_WE_P/;</div>
<div class="line">    my %results;</div>
<div class="line">    @results{@keys} = @args{@keys};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a58eef8581208290e26a44a9ca338267d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pe_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pe_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pe_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pe_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pe_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pe_lists: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a58eef8581208290e26a44a9ca338267d">calc_pe_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my @keys = qw /PE_WTLIST PE_RANGELIST PE_LOCAL_RANGELIST/;</div>
<div class="line">    my %results;</div>
<div class="line">    @results{@keys} = @args{@keys};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a192ace354325740fbb3c1879ff46c5cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_pe_single </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_pe_single' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_pe_single-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_pe_single-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_pe_single-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_pe_single: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a192ace354325740fbb3c1879ff46c5cb">calc_pe_single</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $node_ranges = $args{PE_RANGELIST};</div>
<div class="line"><span class="preprocessor">    #my %wts;</span></div>
<div class="line"><span class="preprocessor"></span>    my $tree = $args{trimmed_tree};</div>
<div class="line">    my $pe_single;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_name (keys %$node_ranges) {</div>
<div class="line">        my $range    = $node_ranges-&gt;{$node_name};</div>
<div class="line">        my $node_ref = $tree-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line"><span class="preprocessor">        #$wts{$node_name} = $node_ref-&gt;get_length;</span></div>
<div class="line"><span class="preprocessor"></span>        $pe_single += $node_ref-&gt;get_length / $range;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    my $tree_length = $tree-&gt;get_total_tree_length;</div>
<div class="line">    my $pe_single_p = defined $pe_single ? ($pe_single / $tree_length) : undef;</div>
<div class="line">    </div>
<div class="line">    my %results = (</div>
<div class="line">        PE_WE_SINGLE   =&gt; $pe_single,</div>
<div class="line">        PE_WE_SINGLE_P =&gt; $pe_single_p,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6507228e59a22fbedbe1543d3812c315"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_abc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_abc' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_abc-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_abc-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_abc-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_abc: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a6507228e59a22fbedbe1543d3812c315">calc_phylo_abc</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  seems inefficient, but might clear a memory leak</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my %results = $self-&gt;_calc_phylo_abc(%args);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a92310db284ce699990dd5271b0f0768c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_aed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_aed' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_aed-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_aed-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_aed-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_aed: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a92310db284ce699990dd5271b0f0768c">calc_phylo_aed</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $label_hash = $args{label_hash_all};</div>
<div class="line">    my $es_wts     = $args{ES_SCORES};</div>
<div class="line">    my $ed_wts     = $args{ED_SCORES};</div>
<div class="line">    my $aed_wts    = $args{AED_SCORES};</div>
<div class="line"></div>
<div class="line">    my (%es, %ed, %aed);</div>
<div class="line"><span class="preprocessor">    # now loop over the terminals and extract the weights (would slices be faster?)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    # Do we want the proportional values?  Divide by PD to get them.</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $label (keys %$label_hash) {</div>
<div class="line">        $aed{$label} = $aed_wts-&gt;{$label};</div>
<div class="line">        $ed{$label}  = $ed_wts-&gt;{$label};</div>
<div class="line">        $es{$label}  = $es_wts-&gt;{$label};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_ES_LIST  =&gt; \%es,</div>
<div class="line">        PHYLO_ED_LIST  =&gt; \%ed,</div>
<div class="line">        PHYLO_AED_LIST =&gt; \%aed,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a689436af93945fc331ec13537d8af167"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_aed_t </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_aed_t' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_aed_t-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_aed_t-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_aed_t-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_aed_t: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a689436af93945fc331ec13537d8af167">calc_phylo_aed_t</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = (PHYLO_AED_T =&gt; $args{PHYLO_AED_T});</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ada1e0945b1a543ed47e08d70ed6ce364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_aed_t_wtlists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_aed_t_wtlists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_aed_t_wtlists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_aed_t_wtlists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_aed_t_wtlists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_aed_t_wtlists: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ada1e0945b1a543ed47e08d70ed6ce364">calc_phylo_aed_t_wtlists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $wt_list   = $args{PHYLO_AED_T_WTLIST};</div>
<div class="line">    my $aed_t     = $args{PHYLO_AED_T};</div>
<div class="line">    my $p_wt_list = {};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (keys %$wt_list) {</div>
<div class="line">        $p_wt_list-&gt;{$label} = $wt_list-&gt;{$label} / $aed_t;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_AED_T_WTLIST   =&gt; $wt_list,</div>
<div class="line">        PHYLO_AED_T_WTLIST_P =&gt; $p_wt_list,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa28e7c7454b6747f3b4bdfa39a2b53c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_corrected_weighted_endemism </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_corrected_weighted_endemism' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_corrected_weighted_endemism-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_corrected_weighted_endemism-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_corrected_weighted_endemism-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_corrected_weighted_endemism: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa28e7c7454b6747f3b4bdfa39a2b53c7">calc_phylo_corrected_weighted_endemism</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $pe = $args{PE_WE};</div>
<div class="line">    my $pd = $args{PD};</div>
<div class="line">    no warnings <span class="stringliteral">&#39;uninitialized&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PE_CWE =&gt; eval {$pe / $pd},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad3399d7275e08d4a146d0a1e508541bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_corrected_weighted_rarity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_corrected_weighted_rarity' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_corrected_weighted_rarity-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_corrected_weighted_rarity-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_corrected_weighted_rarity-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_corrected_weighted_rarity: 14</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ad3399d7275e08d4a146d0a1e508541bc">calc_phylo_corrected_weighted_rarity</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $aed_t = $args{PHYLO_AED_T};</div>
<div class="line">    my $pd    = $args{PD};</div>
<div class="line">    no warnings <span class="stringliteral">&#39;uninitialized&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        PHYLO_RARITY_CWR =&gt; eval {$aed_t / $pd},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7e163442c3ec88f7e8de614683b50a47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_jaccard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_jaccard' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_jaccard-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_jaccard-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_jaccard-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_jaccard: 15</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a7e163442c3ec88f7e8de614683b50a47">calc_phylo_jaccard</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my ($A, $B, $C, $ABC) = @args{qw /PHYLO_A PHYLO_B PHYLO_C PHYLO_ABC/};  </div>
<div class="line"></div>
<div class="line">    my $val;</div>
<div class="line">    <span class="keywordflow">if</span> ($A + $B and $A + $C) {  #  sum of each side must be non-zero</div>
<div class="line">        $val = eval {1 - ($A / $ABC)};</div>
<div class="line">    }    </div>
<div class="line"></div>
<div class="line">    my %results = (PHYLO_JACCARD =&gt; $val);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a33ab698c19d8593cae1d50e29f9cf682"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_mpd_mntd1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_mpd_mntd1' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_mpd_mntd1-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_mpd_mntd1-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_mpd_mntd1-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_mpd_mntd1: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a33ab698c19d8593cae1d50e29f9cf682">calc_phylo_mpd_mntd1</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = $self-&gt;_calc_phylo_mpd_mntd (</div>
<div class="line">        %args,</div>
<div class="line">        label_hash1 =&gt; $args{label_hash_all},</div>
<div class="line">        label_hash2 =&gt; $args{label_hash_all},</div>
<div class="line">        abc_num     =&gt; 1,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aee5876cc4ea13b5fbbe67f9666499bd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_mpd_mntd2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_mpd_mntd2' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_mpd_mntd2-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_mpd_mntd2-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_mpd_mntd2-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_mpd_mntd2: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aee5876cc4ea13b5fbbe67f9666499bd0">calc_phylo_mpd_mntd2</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = $self-&gt;_calc_phylo_mpd_mntd (</div>
<div class="line">        %args,</div>
<div class="line">        label_hash1 =&gt; $args{label_hash_all},</div>
<div class="line">        label_hash2 =&gt; $args{label_hash_all},</div>
<div class="line">        abc_num     =&gt; 2,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a542c95486798e604d7d82a672850f4f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_mpd_mntd3 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_mpd_mntd3' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_mpd_mntd3-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_mpd_mntd3-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_mpd_mntd3-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_mpd_mntd3: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a542c95486798e604d7d82a672850f4f0">calc_phylo_mpd_mntd3</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = $self-&gt;_calc_phylo_mpd_mntd (</div>
<div class="line">        %args,</div>
<div class="line">        label_hash1 =&gt; $args{label_hash_all},</div>
<div class="line">        label_hash2 =&gt; $args{label_hash_all},</div>
<div class="line">        abc_num     =&gt; 3,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ada7c83a3afd6a4041e28c15ce2803b92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_s2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_s2' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_s2-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_s2-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_s2-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_s2: 15</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ada7c83a3afd6a4041e28c15ce2803b92">calc_phylo_s2</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my ($A, $B, $C) = @args{qw /PHYLO_A PHYLO_B PHYLO_C/};  </div>
<div class="line"></div>
<div class="line">    my $val;</div>
<div class="line">    <span class="keywordflow">if</span> ($A + $B and $A + $C) {  #  sum of each side must be non-zero</div>
<div class="line">        $val = eval {1 - ($A / ($A + min ($B, $C)))};</div>
<div class="line">    }    </div>
<div class="line"></div>
<div class="line">    my %results = (PHYLO_S2 =&gt; $val);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6683836a9ba2da2e87f0e88ec71e41a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_phylo_sorenson </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_phylo_sorenson' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_phylo_sorenson-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_phylo_sorenson-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_phylo_sorenson-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_phylo_sorenson: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a6683836a9ba2da2e87f0e88ec71e41a5">calc_phylo_sorenson</a> {</div>
<div class="line"></div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my ($A, $B, $C, $ABC) = @args{qw /PHYLO_A PHYLO_B PHYLO_C PHYLO_ABC/};</div>
<div class="line"></div>
<div class="line">    my $val;</div>
<div class="line">    <span class="keywordflow">if</span> ($A + $B and $A + $C) {  #  sum of each side must be non-zero</div>
<div class="line">        $val = eval {1 - (2 * $A / ($A + $ABC))};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (PHYLO_SORENSON =&gt; $val);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa8974fc6e847c02b4050224d19874435"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_taxonomic_distinctness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_taxonomic_distinctness' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_taxonomic_distinctness-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_taxonomic_distinctness-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_taxonomic_distinctness-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_taxonomic_distinctness: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aa8974fc6e847c02b4050224d19874435">calc_taxonomic_distinctness</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;_calc_taxonomic_distinctness (@_);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a3911885c5ea540cf08d754ba847efc53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::calc_taxonomic_distinctness_binary </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-calc_taxonomic_distinctness_binary' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-calc_taxonomic_distinctness_binary-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-calc_taxonomic_distinctness_binary-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-calc_taxonomic_distinctness_binary-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in calc_taxonomic_distinctness_binary: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a3911885c5ea540cf08d754ba847efc53">calc_taxonomic_distinctness_binary</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my %results = $self-&gt;_calc_taxonomic_distinctness (@_);</div>
<div class="line">    my %results2;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $key (keys %results) {</div>
<div class="line">        my $key2 = $key;</div>
<div class="line">        $key2 =~ s/^TD_/TDB_/;</div>
<div class="line">        $results2{$key2} = $results{$key};</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results2 : \%results2;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a04e694952ad3536e6a0a08af88e39648"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::default_mpd_mntd_results </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-default_mpd_mntd_results' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-default_mpd_mntd_results-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-default_mpd_mntd_results-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-default_mpd_mntd_results-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in default_mpd_mntd_results: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a04e694952ad3536e6a0a08af88e39648">default_mpd_mntd_results</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $abcnum = $args{abcnum} || 1;</div>
<div class="line">    </div>
<div class="line">    my $mpd_pfx  = <span class="stringliteral">&#39;PMPD&#39;</span> . $abcnum;</div>
<div class="line">    my $mntd_pfx = <span class="stringliteral">&#39;PNTD&#39;</span> . $abcnum;</div>
<div class="line">    my %results;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $pfx ($mpd_pfx, $mntd_pfx) {</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_RMSD&#39;</span>}   = undef;</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_N&#39;</span>}    = 0;</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_MIN&#39;</span>}  = undef;</div>
<div class="line">        $results{$pfx . <span class="stringliteral">&#39;_MAX&#39;</span>}  = undef;</div>
<div class="line"><span class="preprocessor">        #$results{$pfx . &#39;_SUM&#39;}  = undef;</span></div>
<div class="line"><span class="preprocessor"></span>        $results{$pfx . <span class="stringliteral">&#39;_MEAN&#39;</span>} = undef;</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a2a1520401f99b57f3cb7c6404c33a5d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_aed_scores </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_aed_scores' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_aed_scores-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_aed_scores-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_aed_scores-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_aed_scores: 55</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2a1520401f99b57f3cb7c6404c33a5d3">get_aed_scores</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $tree = $args{trimmed_tree};</div>
<div class="line">    my $node_abundances = $args{global_node_abundance_hash};</div>
<div class="line">    my (%es_wts, %ed_wts, %aed_wts);</div>
<div class="line">    my $terminal_elements = $tree-&gt;get_root_node-&gt;get_terminal_elements;</div>
<div class="line"></div>
<div class="line">    LABEL:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (keys %$terminal_elements) {</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  check if node exists - should use a pre_calc</span></div>
<div class="line"><span class="preprocessor"></span>        my $node_ref = eval {</div>
<div class="line">            $tree-&gt;get_node_ref (node =&gt; $label);</div>
<div class="line">        };</div>
<div class="line">        <span class="keywordflow">if</span> (my $e = $EVAL_ERROR) {  #  still needed? </div>
<div class="line">            next LABEL <span class="keywordflow">if</span> Biodiverse::Tree::NotExistsNode-&gt;caught;</div>
<div class="line">            croak $e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        my $length  = $node_ref-&gt;get_length;</div>
<div class="line">        my $es_sum  = $length;</div>
<div class="line">        my $ed_sum  = $length;</div>
<div class="line">        my $aed_sum = $length / $node_abundances-&gt;{$label};</div>
<div class="line">        my $es_wt  = 1;</div>
<div class="line">        my ($ed_wt, $aed_wt);</div>
<div class="line"><span class="preprocessor">        #my $aed_label_count = $node_abundances-&gt;{$label};</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        TRAVERSE_TO_ROOT:</div>
<div class="line">        <span class="keywordflow">while</span> ($node_ref = $node_ref-&gt;get_parent) {</div>
<div class="line">            my $node_len = $node_ref-&gt;get_length;</div>
<div class="line"></div>
<div class="line">            $es_wt  /= $node_ref-&gt;get_child_count;  #  es uses a cumulative scheme</div>
<div class="line">            $ed_wt  =  1 / $node_ref-&gt;get_terminal_element_count;</div>
<div class="line">            $aed_wt =  1 / $node_abundances-&gt;{$node_ref-&gt;get_name};</div>
<div class="line"></div>
<div class="line">            $es_sum  += $node_len * $es_wt;</div>
<div class="line">            $ed_sum  += $node_len * $ed_wt;</div>
<div class="line">            $aed_sum += $node_len * $aed_wt;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $es_wts{$label}  = $es_sum;</div>
<div class="line">        $ed_wts{$label}  = $ed_sum;</div>
<div class="line">        $aed_wts{$label} = $aed_sum;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        ES_SCORES  =&gt; \%es_wts,</div>
<div class="line">        ED_SCORES  =&gt; \%ed_wts,</div>
<div class="line">        AED_SCORES =&gt; \%aed_wts,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a06c5a178a5538aee3e4c81f9af95e38d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_global_node_abundance_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_global_node_abundance_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_global_node_abundance_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_global_node_abundance_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_global_node_abundance_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_global_node_abundance_hash: 44</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a06c5a178a5538aee3e4c81f9af95e38d">get_global_node_abundance_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $progress_bar = <a class="code" href="classBiodiverse_1_1Progress.html">Biodiverse::Progress</a>-&gt;<a class="code" href="classBiodiverse_1_1Progress.html#a88f4cef6f66986952a850fb70a2b62d8">new</a>();    </div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[PD INDICES] Calculating abundance for each node in the tree\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $tree  = $args{trimmed_tree} || croak <span class="stringliteral">&quot;Argument trimmed_tree missing\n&quot;</span>;  </div>
<div class="line">    my $nodes = $tree-&gt;get_node_hash;</div>
<div class="line">    my %node_hash;</div>
<div class="line"></div>
<div class="line">    my $toDo = scalar keys %$nodes;</div>
<div class="line">    my $count = 0;</div>
<div class="line"></div>
<div class="line">    my $progress = int (100 * $count / $toDo);</div>
<div class="line">    $progress_bar-&gt;update(</div>
<div class="line">        <span class="stringliteral">&quot;Calculating node abundances\n($progress)&quot;</span>,</div>
<div class="line">        $progress,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  should get terminals and then climb up the tree, adding as we go</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $node (values %$nodes) {</div>
<div class="line"><span class="preprocessor">        #my $node  = $tree-&gt;get_node_ref (node =&gt; $node_name);</span></div>
<div class="line"><span class="preprocessor"></span>        my $abundance = $self-&gt;get_node_abundance_global (</div>
<div class="line">            %args,</div>
<div class="line">            node_ref =&gt; $node,</div>
<div class="line">        );</div>
<div class="line">        <span class="keywordflow">if</span> (defined $abundance) {</div>
<div class="line">            $node_hash{$node-&gt;get_name} = $abundance;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $count ++;</div>
<div class="line">        my $progress = $count / $toDo;</div>
<div class="line">        $progress_bar-&gt;update(</div>
<div class="line">            <span class="stringliteral">&quot;Calculating node abundances\n($progress)&quot;</span>,</div>
<div class="line">            $progress,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (global_node_abundance_hash =&gt; \%node_hash);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a10f42f2748f0c1027154266d1e9f589b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_labels_not_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_labels_not_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_labels_not_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_labels_not_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_labels_not_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_labels_not_on_tree: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a10f42f2748f0c1027154266d1e9f589b">get_labels_not_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;                          </div>
<div class="line"></div>
<div class="line">    my $bd   = $self-&gt;get_basedata_ref;</div>
<div class="line">    my $tree = $args{tree_ref};</div>
<div class="line">    </div>
<div class="line">    my $labels = $bd-&gt;get_labels;</div>
<div class="line">    </div>
<div class="line">    my @not_in_tree = grep { !$tree-&gt;exists_node (name =&gt; $_) } @$labels;</div>
<div class="line"></div>
<div class="line">    my %hash;</div>
<div class="line">    @hash{@not_in_tree} = (1) x scalar @not_in_tree;</div>
<div class="line"></div>
<div class="line">    my %results = (labels_not_on_tree =&gt; \%hash);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a54e2211da03a97e8ffe3dd0b24f24bcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata__calc_pd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata__calc_pd' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata__calc_pd-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata__calc_pd-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata__calc_pd-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata__calc_pd: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a54e2211da03a97e8ffe3dd0b24f24bcb">get_metadata__calc_pd</a> {</div>
<div class="line">        my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic diversity (PD) base calcs.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity base calcs&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; <span class="stringliteral">&#39;calc_labels_on_tree&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        required_args   =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af3cc9576e2cda52efc5c9aebfc0fb209"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata__calc_pe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata__calc_pe' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata__calc_pe-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata__calc_pe-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata__calc_pe-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata__calc_pe: 15</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af3cc9576e2cda52efc5c9aebfc0fb209">get_metadata__calc_pe</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic endemism (PE) base calcs.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Endemism base calcs&#39;</span>,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;Rosauer et al (2009) Mol. Ecol. http://dx.doi.org/10.1111/j.1365-294X.2009.04311.x&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ae4a58e46fc1f91f3b09f2ab3e2b4a869">get_node_range_hash</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a74aaae25e3217dedea64204e6d8ea60f">get_trimmed_tree</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aed787eefc553576a2e017bbd52dcfa13">get_pe_element_cache</a>/],</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_abc&#39;</span>],  #  don<span class="stringliteral">&#39;t need calc_abc2 as we don&#39;</span>t use its counts</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        required_args   =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1},</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac81f534d26abd7ae149f9efb3cb88986"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata__calc_phylo_aed_t </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata__calc_phylo_aed_t' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata__calc_phylo_aed_t-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata__calc_phylo_aed_t-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata__calc_phylo_aed_t-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata__calc_phylo_aed_t: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac81f534d26abd7ae149f9efb3cb88986">get_metadata__calc_phylo_aed_t</a> {</div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Inner sub for AED_T calcs&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /calc_abc3 <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a92310db284ce699990dd5271b0f0768c">calc_phylo_aed</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ac0d392a516bde6a56713a368d3bc246f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_labels_not_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_labels_not_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_labels_not_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_labels_not_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_labels_not_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_labels_not_on_tree: 29</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ac0d392a516bde6a56713a368d3bc246f">get_metadata_calc_labels_not_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Create a hash of the labels that are not on the tree&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Labels not on tree&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_LABELS_NOT_ON_TREE =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;A hash of labels that are not found on the tree, across both neighbour sets&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },  #  should poss also <span class="keywordflow">do</span> nbr sets 1 and 2</div>
<div class="line">            PHYLO_LABELS_NOT_ON_TREE_N =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Number of labels not on the tree&#39;</span>,</div>
<div class="line">                </div>
<div class="line">            },</div>
<div class="line">            PHYLO_LABELS_NOT_ON_TREE_P =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Proportion of labels not on the tree&#39;</span>,</div>
<div class="line">                </div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a10f42f2748f0c1027154266d1e9f589b">get_labels_not_on_tree</a>/],</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_abc&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        required_args   =&gt; [<span class="stringliteral">&#39;tree_ref&#39;</span>],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a743a9a06da367cf468ad4cd8fc3eb755"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_labels_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_labels_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_labels_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_labels_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_labels_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_labels_on_tree: 20</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a743a9a06da367cf468ad4cd8fc3eb755">get_metadata_calc_labels_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Create a hash of the labels that are on the tree&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Labels on tree&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_LABELS_ON_TREE =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;A hash of labels that are found on the tree, across both neighbour sets&#39;</span>,</div>
<div class="line">            },  #  should poss also <span class="keywordflow">do</span> nbr sets 1 and 2</div>
<div class="line">        },</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a10f42f2748f0c1027154266d1e9f589b">get_labels_not_on_tree</a>/],</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_abc&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        required_args   =&gt; [<span class="stringliteral">&#39;tree_ref&#39;</span>],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8aed3c2b5292759e8042899894be19c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pd' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pd-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pd-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pd-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pd: 65</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8aed3c2b5292759e8042899894be19c8">get_metadata_calc_pd</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic diversity (PD) based on branch &#39;</span></div>
<div class="line">                           . <span class="stringliteral">&quot;lengths back to the root of the tree.\n&quot;</span></div>
<div class="line">                           . <span class="stringliteral">&#39;Uses labels in both neighbourhoods.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; <span class="stringliteral">&#39;_calc_pd&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PD              =&gt; {</div>
<div class="line">                cluster       =&gt; undef,</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;Phylogenetic diversity&#39;</span>,</div>
<div class="line">                reference     =&gt; <span class="stringliteral">&#39;Faith (1992) Biol. Cons. http://dx.doi.org/10.1016/0006-3207(92)91201-3&#39;</span>,</div>
<div class="line">                formula       =&gt; [</div>
<div class="line">                    <span class="stringliteral">&#39;= \sum_{c \in C} L_c&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; where &#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;C&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39;is the set of branches in the minimum spanning path &#39;</span></div>
<div class="line">                     . <span class="stringliteral">&#39;joining the labels in both neighbour sets to the root of the tree,&#39;</span>,</div>
<div class="line">                     <span class="charliteral">&#39;c&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; is a branch (a single segment between two nodes) in the &#39;</span></div>
<div class="line">                    . <span class="stringliteral">&#39;spanning path &#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;C&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39;, and &#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39;L_c&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; is the length of branch &#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;c&#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;.&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">            },</div>
<div class="line">            PD_P            =&gt; {</div>
<div class="line">                cluster       =&gt; undef,</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;Phylogenetic diversity as a proportion of total tree length&#39;</span>,</div>
<div class="line">                formula       =&gt; [</div>
<div class="line">                    <span class="stringliteral">&#39;= \frac { PD }{ \sum_{c \in C} L_c }&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; where terms are the same as for PD, but &#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;c&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39;, &#39;</span>,</div>
<div class="line">                    <span class="charliteral">&#39;C&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; and &#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39;L_c&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; are calculated for all nodes in the tree.&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">            },</div>
<div class="line">            PD_per_taxon    =&gt; {</div>
<div class="line">                cluster       =&gt; undef,</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;Phylogenetic diversity per taxon&#39;</span>,</div>
<div class="line">                formula       =&gt; [</div>
<div class="line">                    <span class="stringliteral">&#39;= \frac { PD }{ RICHNESS\_ALL }&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">            },</div>
<div class="line">            PD_P_per_taxon  =&gt; {</div>
<div class="line">                cluster       =&gt; undef,</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;Phylogenetic diversity per taxon as a proportion of total tree length&#39;</span>,</div>
<div class="line">                formula       =&gt; [</div>
<div class="line">                    <span class="stringliteral">&#39;= \frac { PD\_P }{ RICHNESS\_ALL }&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8d843eb6cf1a3d27d568d6de8e3e716f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pd_endemism </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pd_endemism' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pd_endemism-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pd_endemism-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pd_endemism-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pd_endemism: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8d843eb6cf1a3d27d568d6de8e3e716f">get_metadata_calc_pd_endemism</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Absolute endemism analogue of PE.  &#39;</span></div>
<div class="line">                        .  <span class="stringliteral">&#39;It is the sum of the branch lengths restricted &#39;</span></div>
<div class="line">                        .  <span class="stringliteral">&#39;to the neighbour sets.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;PD-Endemism&#39;</span>,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;See Faith (2004) Cons Biol.  http://dx.doi.org/10.1111/j.1523-1739.2004.00330.x&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_pe_lists&#39;</span>],</div>
<div class="line">        pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PD_ENDEMISM =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity Endemism&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PD_ENDEMISM_WTS =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity Endemism weights per node found only in the neighbour set&#39;</span>,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a107ceadcbecc1f5c8c5440df42d84533"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pd_node_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pd_node_list' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pd_node_list-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pd_node_list-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pd_node_list-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pd_node_list: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a107ceadcbecc1f5c8c5440df42d84533">get_metadata_calc_pd_node_list</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic diversity (PD) nodes used.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity node list&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc        =&gt; <span class="stringliteral">&#39;_calc_pd&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line"><span class="preprocessor">        #required_args   =&gt; {&#39;tree_ref&#39; =&gt; 1},</span></div>
<div class="line"><span class="preprocessor"></span>        indices         =&gt; {</div>
<div class="line">            PD_INCLUDED_NODE_LIST =&gt; {</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;List of tree nodes included in the PD calculations&#39;</span>,</div>
<div class="line">                type          =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a44984ab0e02ece193ea6dd8e7284d0d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pd_terminal_node_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pd_terminal_node_list' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pd_terminal_node_list-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pd_terminal_node_list-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pd_terminal_node_list-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pd_terminal_node_list: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a44984ab0e02ece193ea6dd8e7284d0d4">get_metadata_calc_pd_terminal_node_list</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic diversity (PD) terminal nodes used.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Diversity terminal node list&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        pre_calc        =&gt; <span class="stringliteral">&#39;_calc_pd&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        required_args   =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1},</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PD_INCLUDED_TERMINAL_NODE_LIST =&gt; {</div>
<div class="line">                description   =&gt; <span class="stringliteral">&#39;List of tree terminal nodes included in the PD calculations&#39;</span>,</div>
<div class="line">                type          =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a449c3e28e0f7ad2a2d053ca74b0e69a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pe' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pe-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pe-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pe-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pe: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a449c3e28e0f7ad2a2d053ca74b0e69a1">get_metadata_calc_pe</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Phylogenetic endemism (PE).&#39;</span></div>
<div class="line">                            . <span class="stringliteral">&#39;Uses labels in both neighbourhoods and &#39;</span></div>
<div class="line">                            . <span class="stringliteral">&#39;trims the tree to exclude labels not in the &#39;</span></div>
<div class="line">                            . <span class="stringliteral">&#39;BaseData object.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Endemism&#39;</span>,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;Rosauer et al (2009) Mol. Ecol. http://dx.doi.org/10.1111/j.1365-294X.2009.04311.x&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;_calc_pe&#39;</span>],  </div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PE_WE           =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylogenetic endemism&#39;</span></div>
<div class="line">            },</div>
<div class="line">            PE_WE_P         =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylogenetic weighted endemism as a proportion of the total tree length&#39;</span></div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a20a8a91c9e5fc69602b24f8cf34bb1e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pe_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pe_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pe_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pe_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pe_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pe_lists: 27</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a20a8a91c9e5fc69602b24f8cf34bb1e1">get_metadata_calc_pe_lists</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Lists used in the Phylogenetic endemism (PE) calculations.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Endemism lists&#39;</span>,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;Rosauer et al (2009) Mol. Ecol. http://dx.doi.org/10.1111/j.1365-294X.2009.04311.x&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>, </div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;_calc_pe&#39;</span>],  </div>
<div class="line">        uses_nbr_lists  =&gt; 1,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PE_WTLIST       =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Node weights used in PE calculations&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PE_RANGELIST    =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Node ranges used in PE calculations&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PE_LOCAL_RANGELIST =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Local node ranges used in PE calculations (number of groups in which a node is found)&#39;</span>,</div>
<div class="line">                type        =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4fb71ecea709d59c994a40c887c55418"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_pe_single </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_pe_single' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_pe_single-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_pe_single-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_pe_single-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_pe_single: 27</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4fb71ecea709d59c994a40c887c55418">get_metadata_calc_pe_single</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;PE scores, but not weighted by local ranges.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic Endemism single&#39;</span>,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;Rosauer et al (2009) Mol. Ecol. http://dx.doi.org/10.1111/j.1365-294X.2009.04311.x&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;_calc_pe&#39;</span>],</div>
<div class="line">        pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PE_WE_SINGLE    =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&quot;Phylogenetic endemism unweighted by the number of neighbours.\n&quot;</span></div>
<div class="line">                               . <span class="stringliteral">&quot;Counts each label only once, regardless of how many groups in the neighbourhood it is found in.\n&quot;</span></div>
<div class="line">                               . <span class="stringliteral">&#39;Useful if your data have sampling biases. &#39;</span></div>
<div class="line">                               . <span class="stringliteral">&#39;Better with small sample windows.&#39;</span></div>
<div class="line">            },</div>
<div class="line">            PE_WE_SINGLE_P  =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&quot;Phylogenetic endemism unweighted by the number of neighbours as a proportion of the total tree length.\n&quot;</span></div>
<div class="line">                               . <span class="stringliteral">&quot;Counts each label only once, regardless of how many groups in the neighbourhood it is found.\n&quot;</span></div>
<div class="line">                               . <span class="stringliteral">&quot;Useful if your data have sampling biases.&quot;</span></div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aadd771887dac28834a9ef774cd51adc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_abc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_abc' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_abc-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_abc-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_abc-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_abc: 32</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aadd771887dac28834a9ef774cd51adc4">get_metadata_calc_phylo_abc</a> {</div>
<div class="line">    </div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt;  <span class="stringliteral">&#39;Phylogenetic ABC&#39;</span>,</div>
<div class="line">        description     =&gt;  <span class="stringliteral">&#39;Calculate the shared and not shared branch lengths between two sets of labels&#39;</span>,</div>
<div class="line">        type            =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt;  <span class="stringliteral">&#39;calc_abc&#39;</span>,</div>
<div class="line">        pre_calc_global =&gt;  [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a74aaae25e3217dedea64204e6d8ea60f">get_trimmed_tree</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a242c401cd29d200f45196fb8f78d2140">get_path_length_cache</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  2,  #  how many sets of lists it must have</div>
<div class="line">        required_args   =&gt; {tree_ref =&gt; 1},</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_A =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Length of branches shared by labels in nbr sets 1 and 2&#39;</span>,</div>
<div class="line">                lumper       =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_B =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Length of branches unique to labels in nbr set 1&#39;</span>,</div>
<div class="line">                lumper       =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_C =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Length of branches unique to labels in nbr set 2&#39;</span>,</div>
<div class="line">                lumper       =&gt; 0,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_ABC =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Length of all branches associated with labels in nbr sets 1 and 2&#39;</span>,</div>
<div class="line">                lumper       =&gt; 1,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;   </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a15c996d950da88aebd24eb3489e1826c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_aed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_aed' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_aed-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_aed-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_aed-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_aed: 34</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a15c996d950da88aebd24eb3489e1826c">get_metadata_calc_phylo_aed</a> {</div>
<div class="line">    my $descr = <span class="stringliteral">&quot;Evolutionary distinctiveness metrics (AED, ED, ES)\n&quot;</span></div>
<div class="line">                . <span class="stringliteral">&#39;Label values are constant for all &#39;</span></div>
<div class="line">                . <span class="stringliteral">&#39;neighbourhoods in which each label is found. &#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt;  <span class="stringliteral">&#39;Evolutionary distinctiveness&#39;</span>,</div>
<div class="line">        description     =&gt;  $descr,</div>
<div class="line">        type            =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /calc_abc/],</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2a1520401f99b57f3cb7c6404c33a5d3">get_aed_scores</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">        reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_AED_LIST =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Abundance weighted ED per terminal label&#39;</span>,</div>
<div class="line">                list         =&gt; 1,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_ES_LIST =&gt; {</div>
<div class="line">                description  =&gt;  <span class="stringliteral">&#39;Equal splits partitioning of PD per terminal label&#39;</span>,</div>
<div class="line">                list         =&gt; 1,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Redding &amp; Mooers (2006) http://dx.doi.org/10.1111%2Fj.1523-1739.2006.00555.x&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_ED_LIST =&gt; {</div>
<div class="line">                description  =&gt;  q{<span class="stringliteral">&quot;Fair proportion&quot;</span> partitioning of PD per terminal label},</div>
<div class="line">                list         =&gt; 1,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Isaac et al. (2007) http://dx.doi.org/10.1371/journal.pone.0000296&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a83d08257cc9e58fa3049ffbe9e8c56de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_aed_t </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_aed_t' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_aed_t-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_aed_t-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_aed_t-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_aed_t: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a83d08257cc9e58fa3049ffbe9e8c56de">get_metadata_calc_phylo_aed_t</a> {</div>
<div class="line">    </div>
<div class="line">    my $descr = <span class="stringliteral">&#39;Abundance weighted ED_t &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;(sum of values in PHYLO_AED_LIST times their abundances).&#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39; This is equivalent to a phylogenetic rarity score &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;(see phylogenetic endemism)&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt;  <span class="stringliteral">&#39;Evolutionary distinctiveness per site&#39;</span>,</div>
<div class="line">        description     =&gt;  <span class="stringliteral">&#39;Site level evolutionary distinctiveness&#39;</span>,</div>
<div class="line">        type            =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#afd8b992a802e1766f68623daf4785788">_calc_phylo_aed_t</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">        reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_AED_T =&gt; {</div>
<div class="line">                description  =&gt; $descr,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a192d525b6e5de0dcc29289bbb53393ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_aed_t_wtlists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_aed_t_wtlists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_aed_t_wtlists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_aed_t_wtlists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_aed_t_wtlists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_aed_t_wtlists: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a192d525b6e5de0dcc29289bbb53393ba">get_metadata_calc_phylo_aed_t_wtlists</a> {</div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt;  <span class="stringliteral">&#39;Evolutionary distinctiveness per terminal taxon per site&#39;</span>,</div>
<div class="line">        description     =&gt;  <span class="stringliteral">&#39;Site level evolutionary distinctiveness per terminal taxon&#39;</span>,</div>
<div class="line">        type            =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#afd8b992a802e1766f68623daf4785788">_calc_phylo_aed_t</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">        reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_AED_T_WTLIST =&gt; {</div>
<div class="line">                description  =&gt; <span class="stringliteral">&#39;Abundance weighted ED per terminal taxon &#39;</span></div>
<div class="line">                              . <span class="stringliteral">&#39;(the AED score of each taxon multiplied by its &#39;</span></div>
<div class="line">                              . <span class="stringliteral">&#39;abundance in the sample)&#39;</span>,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">                type         =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">            PHYLO_AED_T_WTLIST_P =&gt; {</div>
<div class="line">                description  =&gt; <span class="stringliteral">&#39;Proportional contribution of each terminal taxon to the AED_T score&#39;</span>,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;Cadotte &amp; Davies (2010) http://dx.doi.org/10.1111/j.1472-4642.2010.00650.x&#39;</span>,</div>
<div class="line">                type         =&gt; <span class="stringliteral">&#39;list&#39;</span>,</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5f7f04f5cb6f8b74b7842313421b67fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_corrected_weighted_endemism </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_endemism' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_corrected_weighted_endemism-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_endemism-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_endemism-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_corrected_weighted_endemism: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a5f7f04f5cb6f8b74b7842313421b67fe">get_metadata_calc_phylo_corrected_weighted_endemism</a>{</div>
<div class="line">    </div>
<div class="line">    my $descr = <span class="stringliteral">&#39;Corrected weighted endemism.  &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;This is the phylogenetic analogue of corrected &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;weighted endemism.&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Corrected weighted phylogenetic endemism&#39;</span>,</div>
<div class="line">        description     =&gt; q{What proportion of the PD is range-restricted to <span class="keyword">this</span> neighbour <span class="keyword">set</span>?},</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a64b67172500dbfe4f092bfaeb9de12c9">calc_pe</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2c93c235022d8aefedfb53e17849a4c6">calc_pd</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PE_CWE =&gt; {</div>
<div class="line">                description  =&gt; $descr,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line">                formula      =&gt; [<span class="stringliteral">&#39;PE_WE / PD&#39;</span>],</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4149e499fa48ba742a650a28adc6c0e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_corrected_weighted_rarity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_rarity' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_corrected_weighted_rarity-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_rarity-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_corrected_weighted_rarity-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_corrected_weighted_rarity: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4149e499fa48ba742a650a28adc6c0e2">get_metadata_calc_phylo_corrected_weighted_rarity</a> {</div>
<div class="line">    </div>
<div class="line">    my $descr = <span class="stringliteral">&#39;Corrected weighted phylogenetic rarity.  &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;This is the phylogenetic rarity analogue of corrected &#39;</span></div>
<div class="line">              . <span class="stringliteral">&#39;weighted endemism.&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name            =&gt;  <span class="stringliteral">&#39;Corrected weighted phylogenetic rarity&#39;</span>,</div>
<div class="line">        description     =&gt;  q{What proportion of the PD is abundance-restricted to <span class="keyword">this</span> neighbour <span class="keyword">set</span>?},</div>
<div class="line">        type            =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#afd8b992a802e1766f68623daf4785788">_calc_phylo_aed_t</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a2c93c235022d8aefedfb53e17849a4c6">calc_pd</a>/],</div>
<div class="line">        uses_nbr_lists  =&gt;  1,</div>
<div class="line">        reference       =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            PHYLO_RARITY_CWR =&gt; {</div>
<div class="line">                description  =&gt; $descr,</div>
<div class="line">                reference    =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line">                formula      =&gt; [<span class="stringliteral">&#39;AED_T / PD&#39;</span>],</div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a11c43f5eb013442c1b0f9e3c4a98b168"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_jaccard </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_jaccard' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_jaccard-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_jaccard-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_jaccard-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_jaccard: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a11c43f5eb013442c1b0f9e3c4a98b168">get_metadata_calc_phylo_jaccard</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name           =&gt;  <span class="stringliteral">&#39;Phylo Jaccard&#39;</span>,</div>
<div class="line">        type           =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        description    =&gt;  <span class="stringliteral">&quot;Jaccard phylogenetic dissimilarity between two sets of taxa, represented by spanning sets of branches\n&quot;</span>,</div>
<div class="line">        pre_calc       =&gt;  <span class="stringliteral">&#39;calc_phylo_abc&#39;</span>,</div>
<div class="line">        uses_nbr_lists =&gt;  2,  #  how many sets of lists it must have</div>
<div class="line">        indices        =&gt; {</div>
<div class="line">            PHYLO_JACCARD =&gt; {</div>
<div class="line">                cluster     =&gt;  <span class="stringliteral">&#39;NO_CACHE_ABC&#39;</span>,</div>
<div class="line">                formula     =&gt;  [</div>
<div class="line">                    <span class="stringliteral">&#39;= 1 - (A / (A + B + C))&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; where A is the length of shared branches, &#39;</span></div>
<div class="line">                    . <span class="stringliteral">&#39;and B and C are the length of branches found only in neighbour sets 1 and 2&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylo Jaccard score&#39;</span>,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        required_args =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1}</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;   </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aaf2ef7dd0ca00d62184cf54607d583bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_mpd_mntd1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_mpd_mntd1' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_mpd_mntd1-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd1-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd1-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_mpd_mntd1: 18</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aaf2ef7dd0ca00d62184cf54607d583bd">get_metadata_calc_phylo_mpd_mntd1</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %submeta = $self-&gt;get_mpd_mntd_metadata (</div>
<div class="line">        abc_sub =&gt; <span class="stringliteral">&#39;calc_abc&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Distance stats from each label to the nearest label &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;along the tree.  Compares with &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;all other labels across both neighbour sets. &#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic and Nearest taxon distances, unweighted&#39;</span>,</div>
<div class="line">        %submeta,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a43c34083719a3d5caf763ed065fc8326"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_mpd_mntd2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_mpd_mntd2' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_mpd_mntd2-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd2-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd2-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_mpd_mntd2: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a43c34083719a3d5caf763ed065fc8326">get_metadata_calc_phylo_mpd_mntd2</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %submeta = $self-&gt;get_mpd_mntd_metadata (</div>
<div class="line">        abc_sub =&gt; <span class="stringliteral">&#39;calc_abc2&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Distance stats from each label to the nearest label &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;along the tree.  Compares with &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;all other labels across both neighbour sets. &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;Weighted by sample counts&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic and Nearest taxon distances, local range weighted&#39;</span>,</div>
<div class="line">        %submeta,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a642069c10bb3902416b8d76e9931f6fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_mpd_mntd3 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_mpd_mntd3' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_mpd_mntd3-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd3-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_mpd_mntd3-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_mpd_mntd3: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a642069c10bb3902416b8d76e9931f6fe">get_metadata_calc_phylo_mpd_mntd3</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %submeta = $self-&gt;get_mpd_mntd_metadata (</div>
<div class="line">        abc_sub =&gt; <span class="stringliteral">&#39;calc_abc3&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Distance stats from each label to the nearest label &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;along the tree.  Compares with &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;all other labels across both neighbour sets. &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;Weighted by sample counts (which currently must be integers)&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Phylogenetic and Nearest taxon distances, abundance weighted&#39;</span>,</div>
<div class="line">        %submeta,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aaa8fc3311834bcc58c4ee9940f52f423"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_s2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_s2' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_s2-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_s2-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_s2-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_s2: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aaa8fc3311834bcc58c4ee9940f52f423">get_metadata_calc_phylo_s2</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        name           =&gt;  <span class="stringliteral">&#39;Phylo S2&#39;</span>,</div>
<div class="line">        type           =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        description    =&gt;  <span class="stringliteral">&quot;S2 phylogenetic dissimilarity between two sets of taxa, represented by spanning sets of branches\n&quot;</span>,</div>
<div class="line">        pre_calc       =&gt;  <span class="stringliteral">&#39;calc_phylo_abc&#39;</span>,</div>
<div class="line">        uses_nbr_lists =&gt;  2,  #  how many sets of lists it must have</div>
<div class="line">        indices        =&gt; {</div>
<div class="line">            PHYLO_S2 =&gt; {</div>
<div class="line">                cluster     =&gt;  <span class="stringliteral">&#39;NO_CACHE_ABC&#39;</span>,</div>
<div class="line">                formula     =&gt;  [</div>
<div class="line">                    <span class="stringliteral">&#39;= 1 - (A / (A + min (B, C)))&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; where A is the length of shared branches, &#39;</span></div>
<div class="line">                    . <span class="stringliteral">&#39;and B and C are the length of branches found only in neighbour sets 1 and 2&#39;</span>,</div>
<div class="line">                ],</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylo S2 score&#39;</span>,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        required_args =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1}</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;   </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a514dacbbfc1d00493f725622837f83f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_phylo_sorenson </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_phylo_sorenson' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_phylo_sorenson-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_phylo_sorenson-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_phylo_sorenson-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_phylo_sorenson: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a514dacbbfc1d00493f725622837f83f7">get_metadata_calc_phylo_sorenson</a> {</div>
<div class="line">    </div>
<div class="line">    my %arguments = (</div>
<div class="line">        name           =&gt;  <span class="stringliteral">&#39;Phylo Sorenson&#39;</span>,</div>
<div class="line">        type           =&gt;  <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,  #  keeps it clear of the other indices in the GUI</div>
<div class="line">        description    =&gt;  <span class="stringliteral">&quot;Sorenson phylogenetic dissimilarity between two sets of taxa, represented by spanning sets of branches\n&quot;</span>,</div>
<div class="line">        pre_calc       =&gt;  <span class="stringliteral">&#39;calc_phylo_abc&#39;</span>,</div>
<div class="line">        uses_nbr_lists =&gt;  2,  #  how many sets of lists it must have</div>
<div class="line">        indices        =&gt; {</div>
<div class="line">            PHYLO_SORENSON =&gt; {</div>
<div class="line">                cluster     =&gt;  <span class="stringliteral">&#39;NO_CACHE_ABC&#39;</span>,</div>
<div class="line">                formula     =&gt;  [</div>
<div class="line">                    <span class="stringliteral">&#39;1 - (2A / (2A + B + C))&#39;</span>,</div>
<div class="line">                    <span class="stringliteral">&#39; where A is the length of shared branches, &#39;</span></div>
<div class="line">                    . <span class="stringliteral">&#39;and B and C are the length of branches found only in neighbour sets 1 and 2&#39;</span></div>
<div class="line">                ],</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Phylo Sorenson score&#39;</span>,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        required_args =&gt; {<span class="stringliteral">&#39;tree_ref&#39;</span> =&gt; 1}</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;   </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aec57fa7b2fc3ec002df8bee3bcfe5c24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_taxonomic_distinctness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_taxonomic_distinctness' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_taxonomic_distinctness-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_taxonomic_distinctness-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_taxonomic_distinctness-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_taxonomic_distinctness: 39</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aec57fa7b2fc3ec002df8bee3bcfe5c24">get_metadata_calc_taxonomic_distinctness</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $indices = {</div>
<div class="line">        TD_DISTINCTNESS =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Taxonomic distinctness&#39;</span>,</div>
<div class="line"><span class="preprocessor">            #formula        =&gt; [],</span></div>
<div class="line"><span class="preprocessor"></span>        },</div>
<div class="line">        TD_DENOMINATOR  =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Denominator from TD_DISTINCTNESS calcs&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        TD_NUMERATOR    =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Numerator from TD_DISTINCTNESS calcs&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        TD_VARIATION    =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Variation of the taxonomic distinctness&#39;</span>,</div>
<div class="line"><span class="preprocessor">            #formula        =&gt; [],</span></div>
<div class="line"><span class="preprocessor"></span>        },</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    my $ref = <span class="stringliteral">&#39;Warwick &amp; Clarke (1995) Mar Ecol Progr Ser. &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;http://dx.doi.org/10.3354/meps129301 ; &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;Clarke &amp; Warwick (2001) Mar Ecol Progr Ser. &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;http://dx.doi.org/10.3354/meps216265&#39;</span>;</div>
<div class="line">    </div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Taxonomic/phylogenetic distinctness and variation. &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;THIS IS A BETA LEVEL IMPLEMENTATION.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Taxonomic/phylogenetic distinctness&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        reference       =&gt; $ref,</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_abc3&#39;</span>],</div>
<div class="line">        pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,</div>
<div class="line">        indices         =&gt; $indices,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="acb0bf74f229d6aab22fafe1bbcd57c2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_calc_taxonomic_distinctness_binary </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_calc_taxonomic_distinctness_binary' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_calc_taxonomic_distinctness_binary-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_calc_taxonomic_distinctness_binary-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_calc_taxonomic_distinctness_binary-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_calc_taxonomic_distinctness_binary: 52</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#acb0bf74f229d6aab22fafe1bbcd57c2d">get_metadata_calc_taxonomic_distinctness_binary</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $indices = {</div>
<div class="line">        TDB_DISTINCTNESS =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Taxonomic distinctness, binary weighted&#39;</span>,</div>
<div class="line">            formula        =&gt; [</div>
<div class="line">                <span class="stringliteral">&#39;= \frac{\sum \sum_{i \neq j} \omega_{ij}}{s(s-1))}&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;where &#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;\omega_{ij}&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;is the path length from label &#39;</span>,</div>
<div class="line">                <span class="charliteral">&#39;i&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;to the ancestor node shared with &#39;</span>,</div>
<div class="line">                <span class="charliteral">&#39;j&#39;</span>,</div>
<div class="line">            ],</div>
<div class="line">        },</div>
<div class="line">        TDB_DENOMINATOR  =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Denominator from TDB_DISTINCTNESS&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        TDB_NUMERATOR    =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Numerator from TDB_DISTINCTNESS&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        TDB_VARIATION    =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Variation of the binary taxonomic distinctness&#39;</span>,</div>
<div class="line">            formula        =&gt; [</div>
<div class="line">                <span class="stringliteral">&#39;= \frac{\sum \sum_{i \neq j} \omega_{ij}^2}{s(s-1))} - \bar{\omega}^2&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;where &#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;\bar{\omega} = \frac{\sum \sum_{i \neq j} \omega_{ij}}{s(s-1))} \equiv TDB\_DISTINCTNESS&#39;</span>,</div>
<div class="line">            ],</div>
<div class="line">        },</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    my $ref = <span class="stringliteral">&#39;Warwick &amp; Clarke (1995) Mar Ecol Progr Ser. &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;http://dx.doi.org/10.3354/meps129301 ; &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;Clarke &amp; Warwick (2001) Mar Ecol Progr Ser. &#39;</span></div>
<div class="line">            . <span class="stringliteral">&#39;http://dx.doi.org/10.3354/meps216265&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Taxonomic/phylogenetic distinctness and variation &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;using presence/absence weights.  &#39;</span></div>
<div class="line">                         . <span class="stringliteral">&#39;THIS IS A BETA LEVEL IMPLEMENTATION.&#39;</span>,</div>
<div class="line">        name            =&gt; <span class="stringliteral">&#39;Taxonomic/phylogenetic distinctness, binary weighted&#39;</span>,</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;Phylogenetic Indices&#39;</span>,</div>
<div class="line">        reference       =&gt; $ref,</div>
<div class="line">        pre_calc        =&gt; [<span class="stringliteral">&#39;calc_abc&#39;</span>],</div>
<div class="line">        pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>],</div>
<div class="line">        uses_nbr_lists  =&gt; 1,</div>
<div class="line">        indices         =&gt; $indices,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ad33a257fcafabfc96d56910cf3caa0cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_aed_scores </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_aed_scores' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_aed_scores-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_aed_scores-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_aed_scores-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_aed_scores: 21</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ad33a257fcafabfc96d56910cf3caa0cc">get_metadata_get_aed_scores</a> {</div>
<div class="line"></div>
<div class="line">    my %args = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;A hash of the ES, ED and BED scores for each label&#39;</span>,</div>
<div class="line">        pre_calc        =&gt; [qw /calc_abc/],</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a74aaae25e3217dedea64204e6d8ea60f">get_trimmed_tree</a> <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a06c5a178a5538aee3e4c81f9af95e38d">get_global_node_abundance_hash</a>/],</div>
<div class="line">        indices         =&gt; {</div>
<div class="line">            ES_SCORES =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Hash of ES scores for each label&#39;</span></div>
<div class="line">            },</div>
<div class="line">            ED_SCORES =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Hash of ED scores for each label&#39;</span></div>
<div class="line">            },</div>
<div class="line">            AED_SCORES =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;Hash of AED scores for each label&#39;</span></div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %args : \%args;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="affaad19b3b28612d8a842a7e02ca8791"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_global_node_abundance_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_global_node_abundance_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_global_node_abundance_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_global_node_abundance_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_global_node_abundance_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_global_node_abundance_hash: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#affaad19b3b28612d8a842a7e02ca8791">get_metadata_get_global_node_abundance_hash</a> {</div>
<div class="line">    my %arguments = (pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>]);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abe948113b1c178099a81f9ede7ee94f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_labels_not_on_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_labels_not_on_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_labels_not_on_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_labels_not_on_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_labels_not_on_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_labels_not_on_tree: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#abe948113b1c178099a81f9ede7ee94f9">get_metadata_get_labels_not_on_tree</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %arguments = (required_args =&gt; <span class="stringliteral">&#39;tree_ref&#39;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a0c769609093626177369f59ec8bd00ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_node_range_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_node_range_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_node_range_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_node_range_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_node_range_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_node_range_hash: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a0c769609093626177369f59ec8bd00ec">get_metadata_get_node_range_hash</a> {</div>
<div class="line">    my %arguments = (pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>]);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4ed4743cdb2a7e49c59f75802751745c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_node_range_hash_as_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_node_range_hash_as_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_node_range_hash_as_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_node_range_hash_as_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_node_range_hash_as_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_node_range_hash_as_lists: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a4ed4743cdb2a7e49c59f75802751745c">get_metadata_get_node_range_hash_as_lists</a> {</div>
<div class="line">    my %arguments = (pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>]);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a95666a1d09854d55caf95b970f6fb943"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_path_length_cache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_path_length_cache' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_path_length_cache-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_path_length_cache-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_path_length_cache-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_path_length_cache: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a95666a1d09854d55caf95b970f6fb943">get_metadata_get_path_length_cache</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Cache for path lengths.&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a66952c05ab3d8382776a840aa19ec3e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_path_lengths_to_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_path_lengths_to_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_path_lengths_to_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_path_lengths_to_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_path_lengths_to_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_path_lengths_to_root_node: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a66952c05ab3d8382776a840aa19ec3e2">get_metadata_get_path_lengths_to_root_node</a> {</div>
<div class="line"></div>
<div class="line">    my %arguments = (</div>
<div class="line">        description     =&gt; <span class="stringliteral">&#39;Get the path lengths to the root node of a tree for a set of labels.&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,  #  how many lists it must have</div>
<div class="line">        pre_calc_global =&gt; <span class="stringliteral">&#39;get_path_length_cache&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a64e6ae5f5a5fca162084505f4e6a4da7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_pe_element_cache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_pe_element_cache' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_pe_element_cache-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_pe_element_cache-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_pe_element_cache-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_pe_element_cache: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a64e6ae5f5a5fca162084505f4e6a4da7">get_metadata_get_pe_element_cache</a> {</div>
<div class="line">    </div>
<div class="line">    my %arguments = (</div>
<div class="line">        description =&gt; <span class="stringliteral">&#39;Create a hash in which to cache the PE scores for each element&#39;</span>,</div>
<div class="line">        indices     =&gt; {</div>
<div class="line">            PE_RESULTS_CACHE =&gt; {</div>
<div class="line">                description =&gt; <span class="stringliteral">&#39;The hash in which to cache the PE scores for each element&#39;</span></div>
<div class="line">            },</div>
<div class="line">        },</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a22399970061a4799f9b84c4d5b34953e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_phylo_mpd_mntd_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_phylo_mpd_mntd_matrix' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_phylo_mpd_mntd_matrix-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_phylo_mpd_mntd_matrix-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_phylo_mpd_mntd_matrix-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_phylo_mpd_mntd_matrix: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a22399970061a4799f9b84c4d5b34953e">get_metadata_get_phylo_mpd_mntd_matrix</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line"><span class="preprocessor">        #required_args =&gt; &#39;tree_ref&#39;,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #pre_calc_global =&gt; [&#39;get_trimmed_tree&#39;],  #  need to work with whole tree, so comment out</span></div>
<div class="line"><span class="preprocessor"></span>    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab7222556869ce6b0d39b5178d0a16cc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_trimmed_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_trimmed_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_trimmed_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_trimmed_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_trimmed_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_trimmed_tree: 4</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ab7222556869ce6b0d39b5178d0a16cc2">get_metadata_get_trimmed_tree</a> {</div>
<div class="line">    my %arguments = (required_args =&gt; <span class="stringliteral">&#39;tree_ref&#39;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %arguments : \%arguments;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a0ef9ec33b8880de4d7a1227228c5a0e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_metadata_get_trimmed_tree_as_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_metadata_get_trimmed_tree_as_matrix' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_metadata_get_trimmed_tree_as_matrix-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_metadata_get_trimmed_tree_as_matrix-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_metadata_get_trimmed_tree_as_matrix-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_metadata_get_trimmed_tree_as_matrix: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a0ef9ec33b8880de4d7a1227228c5a0e7">get_metadata_get_trimmed_tree_as_matrix</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        pre_calc_global =&gt; [<span class="stringliteral">&#39;get_trimmed_tree&#39;</span>],</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af1323b6818c6b5c3f28b6dd82decde20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_mpd_mntd_metadata </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_mpd_mntd_metadata' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_mpd_mntd_metadata-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_mpd_mntd_metadata-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_mpd_mntd_metadata-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_mpd_mntd_metadata: 68</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af1323b6818c6b5c3f28b6dd82decde20">get_mpd_mntd_metadata</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $abc_sub = $args{abc_sub} || <span class="stringliteral">&#39;calc_abc&#39;</span>;</div>
<div class="line"></div>
<div class="line">    my $num = 1;</div>
<div class="line">    <span class="keywordflow">if</span> ($abc_sub =~ /(\d)$/) {</div>
<div class="line">        $num = $1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $indices = {</div>
<div class="line">        PNTD_MEAN =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Mean of nearest taxon distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PNTD_MAX =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Maximum of nearest taxon distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PNTD_MIN =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Minimum of nearest taxon distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PNTD_RMSD =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Root mean squared nearest taxon distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PNTD_N =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Count of nearest taxon distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PMPD_MEAN =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Mean of pairwise phylogenetic distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PMPD_MAX =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Maximum of pairwise phylogenetic distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PMPD_MIN =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Minimum of pairwise phylogenetic distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PMPD_RMSD =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Root mean squared pairwise phylogenetic distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">        PMPD_N =&gt; {</div>
<div class="line">            description    =&gt; <span class="stringliteral">&#39;Count of pairwise phylogenetic distances&#39;</span>,</div>
<div class="line">        },</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    my $pre_calc = [$abc_sub, <span class="stringliteral">&#39;calc_labels_on_tree&#39;</span>];</div>
<div class="line">    </div>
<div class="line">    my $indices_filtered = {};</div>
<div class="line">    my $pfx_re = qr /(PNTD|PMPD)/;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $key (keys %$indices) {</div>
<div class="line">        next <span class="keywordflow">if</span> not $key =~ /$pfx_re/;  #  next prob redundant, but need $1 from re</div>
<div class="line">        my $pfx = $1;</div>
<div class="line">        my $new_key = $key;</div>
<div class="line">        $new_key =~ s/$pfx/$pfx$num/;</div>
<div class="line">        $indices_filtered-&gt;{$new_key} = $indices-&gt;{$key};</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %metadata = (</div>
<div class="line">        type            =&gt; <span class="stringliteral">&#39;PhyloCom Indices&#39;</span>,</div>
<div class="line">        reference       =&gt; $webb_et_al_ref,</div>
<div class="line">        pre_calc        =&gt; $pre_calc,</div>
<div class="line">        pre_calc_global =&gt; [qw /<a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a63741a662d99cc0224f1e9d1e3c13b7e">get_phylo_mpd_mntd_matrix</a>/],</div>
<div class="line">        required_args   =&gt; <span class="stringliteral">&#39;tree_ref&#39;</span>,</div>
<div class="line">        uses_nbr_lists  =&gt; 1,</div>
<div class="line">        indices         =&gt; $indices_filtered,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %metadata : \%metadata;    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8c0e09968e4e1f16ba9c3d1abeb71d24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_node_abundance_global </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_abundance_global' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_abundance_global-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_abundance_global-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_abundance_global-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_abundance_global: 21</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8c0e09968e4e1f16ba9c3d1abeb71d24">get_node_abundance_global</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $node_ref = $args{node_ref} || croak <span class="stringliteral">&quot;node_ref arg not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $bd = $args{basedata_ref} || $self-&gt;get_basedata_ref;</div>
<div class="line">    </div>
<div class="line">    my $abundance = 0;</div>
<div class="line">    <span class="keywordflow">if</span> ($node_ref-&gt;is_terminal_node) {</div>
<div class="line">        $abundance += $bd-&gt;get_label_sample_count (element =&gt; $node_ref-&gt;get_name);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">        my $children =  $node_ref-&gt;get_terminal_elements;</div>
<div class="line">        <span class="keywordflow">foreach</span> my $name (keys %$children) {</div>
<div class="line">            $abundance += $bd-&gt;get_label_sample_count (element =&gt; $name);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $abundance;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab8d095a4cd76acb6e483fd3c03dcaf90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_node_range </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_range' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_range-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_range-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_range-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_range: 23</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ab8d095a4cd76acb6e483fd3c03dcaf90">get_node_range</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $node_ref = $args{node_ref} || croak <span class="stringliteral">&quot;node_ref arg not specified\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $bd = $args{basedata_ref} || $self-&gt;get_basedata_ref;</div>
<div class="line"></div>
<div class="line">    my @labels   = ($node_ref-&gt;get_name);</div>
<div class="line">    my $children =  $node_ref-&gt;get_all_descendents;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  collect the set of non-internal (named) nodes</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  Possibly should only work with terminals</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  which would simplify things.</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $name (keys %$children) {</div>
<div class="line">        next <span class="keywordflow">if</span> $children-&gt;{$name}-&gt;is_internal_node;</div>
<div class="line">        push (@labels, $name);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my @range = $bd-&gt;get_range_union (labels =&gt; \@labels);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @range : scalar @range;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ae4a58e46fc1f91f3b09f2ab3e2b4a869"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_node_range_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_range_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_range_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_range_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_range_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_range_hash: 59</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#ae4a58e46fc1f91f3b09f2ab3e2b4a869">get_node_range_hash</a> { # calculate the range occupied by each node/clade in a tree</div>
<div class="line"><span class="preprocessor">                          # this function expects a tree reference as an argument</span></div>
<div class="line"><span class="preprocessor"></span>    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $return_lists = $args{return_lists};</div>
<div class="line"></div>
<div class="line">    my $progress_bar = <a class="code" href="classBiodiverse_1_1Progress.html">Biodiverse::Progress</a>-&gt;<a class="code" href="classBiodiverse_1_1Progress.html#a88f4cef6f66986952a850fb70a2b62d8">new</a>();    </div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[PD INDICES] Calculating range for each node in the tree\n&quot;</span>;</div>
<div class="line">    </div>
<div class="line">    my $tree  = $args{trimmed_tree} || croak <span class="stringliteral">&quot;Argument trimmed_tree missing\n&quot;</span>;  </div>
<div class="line">    my $nodes = $tree-&gt;get_node_hash;</div>
<div class="line">    my %node_range;</div>
<div class="line">  </div>
<div class="line">    my $toDo = scalar keys %$nodes;</div>
<div class="line">    my $count = 0;</div>
<div class="line">    print <span class="stringliteral">&quot;[PD INDICES] Progress (% of $toDo nodes): &quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $progress      = $count / $toDo;</div>
<div class="line">    my $progress_text = int (100 * $progress);</div>
<div class="line">    $progress_bar-&gt;update(</div>
<div class="line">        <span class="stringliteral">&quot;Calculating node ranges\n($progress_text %)&quot;</span>,</div>
<div class="line">        $progress,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $node_name (keys %{$nodes}) {</div>
<div class="line">        my $node  = $tree-&gt;get_node_ref (node =&gt; $node_name);</div>
<div class="line">        <span class="keywordflow">if</span> ($return_lists) {</div>
<div class="line">            my @range = $self-&gt;get_node_range (</div>
<div class="line">                %args,</div>
<div class="line">                node_ref =&gt; $node,</div>
<div class="line">            );</div>
<div class="line">            my %range_hash;</div>
<div class="line">            @range_hash{@range} = undef;</div>
<div class="line">            $node_range{$node_name} = \%range_hash;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            my $range = $self-&gt;get_node_range (</div>
<div class="line">                %args,</div>
<div class="line">                node_ref =&gt; $node,</div>
<div class="line">            );</div>
<div class="line">            <span class="keywordflow">if</span> (defined $range) {</div>
<div class="line">                $node_range{$node_name} = $range;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        $count ++;</div>
<div class="line">        $progress     = $count / $toDo;</div>
<div class="line">        $progress_text = int (100 * $progress);</div>
<div class="line">        $progress_bar-&gt;update(</div>
<div class="line">            <span class="stringliteral">&quot;Calculating node ranges\n($progress_text)&quot;</span>,</div>
<div class="line">            $progress,</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (node_range =&gt; \%node_range);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a04ebb2beebb4ff2a71bec5b6ac0f1ac4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_node_range_hash_as_lists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_node_range_hash_as_lists' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_node_range_hash_as_lists-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_node_range_hash_as_lists-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_node_range_hash_as_lists-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_node_range_hash_as_lists: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a04ebb2beebb4ff2a71bec5b6ac0f1ac4">get_node_range_hash_as_lists</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $res = $self-&gt;get_node_range_hash (@_, return_lists =&gt; 1);</div>
<div class="line">    my %results = (</div>
<div class="line">        node_range_hash =&gt; $res-&gt;{node_range},</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a242c401cd29d200f45196fb8f78d2140"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_path_length_cache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_length_cache' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_length_cache-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_length_cache-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_length_cache-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_length_cache: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a242c401cd29d200f45196fb8f78d2140">get_path_length_cache</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = (path_length_cache =&gt; {});</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8f5df0a04ff5c23b1d8e3c2919f7a5c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_path_lengths_to_root_node </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_path_lengths_to_root_node' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_path_lengths_to_root_node-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_path_lengths_to_root_node-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_path_lengths_to_root_node-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_path_lengths_to_root_node: 49</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a8f5df0a04ff5c23b1d8e3c2919f7a5c5">get_path_lengths_to_root_node</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = (return_lengths =&gt; 1, @_);</div>
<div class="line"></div>
<div class="line">    my $cache = !$args{no_cache};</div>
<div class="line"><span class="preprocessor">    #$cache = 0;  #  turn it off for debug</span></div>
<div class="line"><span class="preprocessor"></span>    </div>
<div class="line"><span class="preprocessor">    #  have we cached it?</span></div>
<div class="line"><span class="preprocessor"></span>    my $use_path_cache = $cache &amp;&amp; $self-&gt;get_pairwise_mode();</div>
<div class="line">    <span class="keywordflow">if</span> ($use_path_cache) {</div>
<div class="line">        my $cache   = $args{path_length_cache};</div>
<div class="line">        my @el_list = keys %{$args{el_list}};</div>
<div class="line">        <span class="keywordflow">if</span> (scalar @el_list == 1) {  #  caching makes sense only <span class="keywordflow">if</span> we have only one element</div>
<div class="line">            my $path = $cache-&gt;{$el_list[0]};</div>
<div class="line">            <span class="keywordflow">return</span> (wantarray ? %$path : $path) <span class="keywordflow">if</span> $path;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            $use_path_cache = undef;  #  skip caching below</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my $label_list = $args{labels};</div>
<div class="line">    my $tree_ref   = $args{tree_ref}</div>
<div class="line">      or croak <span class="stringliteral">&quot;argument tree_ref is not defined\n&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my $return_lengths = $args{return_lengths};</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #create a hash of terminal nodes for the taxa present</span></div>
<div class="line"><span class="preprocessor"></span>    my $all_nodes = $tree_ref-&gt;get_node_hash;</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  now loop through the labels and get the path to the root node</span></div>
<div class="line"><span class="preprocessor"></span>    my %path;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $label (sort keys %$label_list) {</div>
<div class="line">        next <span class="keywordflow">if</span> not exists $all_nodes-&gt;{$label};</div>
<div class="line"></div>
<div class="line">        my $current_node = $all_nodes-&gt;{$label};</div>
<div class="line"></div>
<div class="line">        my $sub_path = $current_node-&gt;get_path_lengths_to_root_node (cache =&gt; $cache);</div>
<div class="line">        @path{keys %$sub_path} = values %$sub_path;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($use_path_cache) {</div>
<div class="line">        my $cache_h = $args{path_length_cache};</div>
<div class="line">        my @el_list = keys %{$args{el_list}};</div>
<div class="line">        $cache_h-&gt;{$el_list[0]} = \%path;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %path : \%path;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aed787eefc553576a2e017bbd52dcfa13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_pe_element_cache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_pe_element_cache' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_pe_element_cache-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_pe_element_cache-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_pe_element_cache-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_pe_element_cache: 7</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#aed787eefc553576a2e017bbd52dcfa13">get_pe_element_cache</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my %results = (PE_RESULTS_CACHE =&gt; {});</div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a63741a662d99cc0224f1e9d1e3c13b7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_phylo_mpd_mntd_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_phylo_mpd_mntd_matrix' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_phylo_mpd_mntd_matrix-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_phylo_mpd_mntd_matrix-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_phylo_mpd_mntd_matrix-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_phylo_mpd_mntd_matrix: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a63741a662d99cc0224f1e9d1e3c13b7e">get_phylo_mpd_mntd_matrix</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my $mx = Biodiverse::Matrix::LowMem-&gt;new (NAME =&gt; <span class="stringliteral">&#39;mntd_matrix&#39;</span>);</div>
<div class="line">    </div>
<div class="line">    my %results = (PHYLO_MPD_MNTD_MATRIX =&gt; $mx);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a74aaae25e3217dedea64204e6d8ea60f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_trimmed_tree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_trimmed_tree' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_trimmed_tree-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_trimmed_tree-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_trimmed_tree-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_trimmed_tree: 21</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#a74aaae25e3217dedea64204e6d8ea60f">get_trimmed_tree</a> { # create a copy of the current tree, including only those branches</div>
<div class="line"><span class="preprocessor">                       # which have records in the base-data</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                       # this function expects a tree reference as an argument</span></div>
<div class="line"><span class="preprocessor"></span>    my $self = shift;</div>
<div class="line">    my %args = @_;                          </div>
<div class="line"></div>
<div class="line">    print <span class="stringliteral">&quot;[PD INDICES] Creating a trimmed tree by removing clades not present in the spatial data\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    my $bd = $self-&gt;get_basedata_ref;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  keep only those that match the basedata object</span></div>
<div class="line"><span class="preprocessor"></span>    my $trimmed_tree = $args{tree_ref}-&gt;clone;</div>
<div class="line">    $trimmed_tree-&gt;trim (keep =&gt; scalar $bd-&gt;get_labels);</div>
<div class="line">    my $name = $trimmed_tree-&gt;get_param(<span class="stringliteral">&#39;NAME&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (!defined $name) {$name = <span class="stringliteral">&#39;noname&#39;</span>};</div>
<div class="line">    $trimmed_tree-&gt;rename(new_name =&gt; $name . <span class="stringliteral">&#39; trimmed&#39;</span>);</div>
<div class="line"></div>
<div class="line">    my %results = (trimmed_tree =&gt; $trimmed_tree);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af6a6ce9e061f978c0a8d8750d82975b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::Phylogenetic::get_trimmed_tree_as_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_trimmed_tree_as_matrix' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_trimmed_tree_as_matrix-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_trimmed_tree_as_matrix-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_trimmed_tree_as_matrix-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_trimmed_tree_as_matrix: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html#af6a6ce9e061f978c0a8d8750d82975b4">get_trimmed_tree_as_matrix</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $mx = $args{trimmed_tree}-&gt;to_matrix (<span class="keyword">class</span> =&gt; $mx_class_for_trees);</div>
<div class="line"></div>
<div class="line">    my %results = (TRIMMED_TREE_AS_MATRIX =&gt; $mx);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/Biodiverse/Indices/<a class="el" href="Phylogenetic_8pm_source.html">Phylogenetic.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Biodiverse</b></li><li class="navelem"><b>Indices</b></li><li class="navelem"><a class="el" href="classBiodiverse_1_1Indices_1_1Phylogenetic.html">Phylogenetic</a></li>
    <li class="footer">Generated on Tue Nov 5 2013 19:08:11 for Biodiverse by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
