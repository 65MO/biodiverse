<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Biodiverse: Biodiverse::Indices Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Biodiverse
   &#160;<span id="projectnumber">0.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classBiodiverse_1_1Indices.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classBiodiverse_1_1Indices-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Biodiverse::Indices Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Biodiverse::Indices:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classBiodiverse_1_1Indices__coll__graph.png" border="0" usemap="#Biodiverse_1_1Indices_coll__map" alt="Collaboration graph"/></div>
<map name="Biodiverse_1_1Indices_coll__map" id="Biodiverse_1_1Indices_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:abadf510c5ce22be5a26893c446a57275"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abadf510c5ce22be5a26893c446a57275"></a>
scalar&#160;</td><td class="memItemRight" valign="bottom"><b>EMPTY_STRING</b></td></tr>
<tr class="separator:abadf510c5ce22be5a26893c446a57275"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Avaliable Methods</h2></td></tr>
<tr class="memitem:a0497b74e5724b08e1c623ce1ad022626"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a0497b74e5724b08e1c623ce1ad022626">_convert_to_array</a> ()</td></tr>
<tr class="separator:a0497b74e5724b08e1c623ce1ad022626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b5d18fd694d5de85ee199cd5f936c56"><td class="memItemLeft" align="right" valign="top">private method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a2b5d18fd694d5de85ee199cd5f936c56">_convert_to_hash</a> ()</td></tr>
<tr class="separator:a2b5d18fd694d5de85ee199cd5f936c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93959091db7757fbd6838876fe7a208d"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a93959091db7757fbd6838876fe7a208d">get_pairwise_mode</a> ()</td></tr>
<tr class="separator:a93959091db7757fbd6838876fe7a208d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b115230c2e0ffc562af783e2e9c0951"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a0b115230c2e0ffc562af783e2e9c0951">get_index_source</a> ()</td></tr>
<tr class="separator:a0b115230c2e0ffc562af783e2e9c0951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8edd1eb1053052bb6c699b30ef0b2e24"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a8edd1eb1053052bb6c699b30ef0b2e24">get_deps_per_calc_by_type</a> ()</td></tr>
<tr class="separator:a8edd1eb1053052bb6c699b30ef0b2e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a89b78257465421ebfa2351710adb89"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a6a89b78257465421ebfa2351710adb89">get_calculations</a> ()</td></tr>
<tr class="separator:a6a89b78257465421ebfa2351710adb89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4960ad3981bfcd971470870640c0210"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#af4960ad3981bfcd971470870640c0210">get_valid_region_grower_indices</a> ()</td></tr>
<tr class="separator:af4960ad3981bfcd971470870640c0210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae63b1da9005f7fe21bd6aeb3015032"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#adae63b1da9005f7fe21bd6aeb3015032">get_indices_uses_lists_count</a> ()</td></tr>
<tr class="separator:adae63b1da9005f7fe21bd6aeb3015032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4302ef8223595ccc51abe1e26f739b43"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a4302ef8223595ccc51abe1e26f739b43">get_valid_calculations</a> ()</td></tr>
<tr class="separator:a4302ef8223595ccc51abe1e26f739b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a605e2168323e527af56100b86750bf42"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a605e2168323e527af56100b86750bf42">get_calculation_metadata_as_wiki</a> ()</td></tr>
<tr class="separator:a605e2168323e527af56100b86750bf42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211af026c4148f3653cdeec157f8114e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a211af026c4148f3653cdeec157f8114e">get_valid_calculation_count</a> ()</td></tr>
<tr class="separator:a211af026c4148f3653cdeec157f8114e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5baaabcf681c7efe218c3129cc7618f1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a5baaabcf681c7efe218c3129cc7618f1">is_region_grower_index</a> ()</td></tr>
<tr class="separator:a5baaabcf681c7efe218c3129cc7618f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02576609aa6ef856a491f8a946003fc3"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a02576609aa6ef856a491f8a946003fc3">get_valid_calculations_to_run</a> ()</td></tr>
<tr class="separator:a02576609aa6ef856a491f8a946003fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f73c1e6bda15c54511435e60d0ba3e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#ab7f73c1e6bda15c54511435e60d0ba3e">run_precalc_globals</a> ()</td></tr>
<tr class="separator:ab7f73c1e6bda15c54511435e60d0ba3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4288db9cf06cf2c58f278863051efe39"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a4288db9cf06cf2c58f278863051efe39">get_calculations_as_flat_hash</a> ()</td></tr>
<tr class="separator:a4288db9cf06cf2c58f278863051efe39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cf2b7e5af5007f227e2371cf8341d6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a78cf2b7e5af5007f227e2371cf8341d6">run_postcalc_locals</a> ()</td></tr>
<tr class="separator:a78cf2b7e5af5007f227e2371cf8341d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b653e2cf5ae1ebc02b930dabae47779"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a9b653e2cf5ae1ebc02b930dabae47779">new</a> ()</td></tr>
<tr class="separator:a9b653e2cf5ae1ebc02b930dabae47779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a891d72306f449376de18ca12095e91fc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a891d72306f449376de18ca12095e91fc">get_results_from_pre_calc_global</a> ()</td></tr>
<tr class="separator:a891d72306f449376de18ca12095e91fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1384c2dc6ce11eba1ebd94a08ceaa1bd"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a1384c2dc6ce11eba1ebd94a08ceaa1bd">run_calculations</a> ()</td></tr>
<tr class="separator:a1384c2dc6ce11eba1ebd94a08ceaa1bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352aed717ed90ec13e36e1ba7e49cda8"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a352aed717ed90ec13e36e1ba7e49cda8">get_required_args</a> ()</td></tr>
<tr class="separator:a352aed717ed90ec13e36e1ba7e49cda8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcde60a82a0a0b839388006afd54c544"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#adcde60a82a0a0b839388006afd54c544">reset_results</a> ()</td></tr>
<tr class="separator:adcde60a82a0a0b839388006afd54c544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3818f945a2dbeab73ef68e715ce8f9f1"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a3818f945a2dbeab73ef68e715ce8f9f1">set_pairwise_mode</a> ()</td></tr>
<tr class="separator:a3818f945a2dbeab73ef68e715ce8f9f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af79fac39412709b2f2d3f8baacb7e79f"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#af79fac39412709b2f2d3f8baacb7e79f">aggregate_calc_lists_by_type</a> ()</td></tr>
<tr class="separator:af79fac39412709b2f2d3f8baacb7e79f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c4a0cdfb8427e4059839cf1cf0729e"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#af6c4a0cdfb8427e4059839cf1cf0729e">get_index_source_hash</a> ()</td></tr>
<tr class="separator:af6c4a0cdfb8427e4059839cf1cf0729e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2f9b1edc670ced31ffbbffbd782003"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a7c2f9b1edc670ced31ffbbffbd782003">is_cluster_index</a> ()</td></tr>
<tr class="separator:a7c2f9b1edc670ced31ffbbffbd782003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f4b59e84ca80acf747510142288cfcc"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a5f4b59e84ca80acf747510142288cfcc">get_valid_cluster_indices</a> ()</td></tr>
<tr class="separator:a5f4b59e84ca80acf747510142288cfcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba7a55c75a6ba3da6639e6e4ac38cc6"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#abba7a55c75a6ba3da6639e6e4ac38cc6">run_postcalc_globals</a> ()</td></tr>
<tr class="separator:abba7a55c75a6ba3da6639e6e4ac38cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa918a94069ac0caffaaa6b9caf3e1d43"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#aa918a94069ac0caffaaa6b9caf3e1d43">run_precalc_locals</a> ()</td></tr>
<tr class="separator:aa918a94069ac0caffaaa6b9caf3e1d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587a122f1216ae00a7c037cda02fd12b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a587a122f1216ae00a7c037cda02fd12b">get_indices</a> ()</td></tr>
<tr class="separator:a587a122f1216ae00a7c037cda02fd12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb8ebd9e8c7c4fb7a4455545bc5dff8a"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#aeb8ebd9e8c7c4fb7a4455545bc5dff8a">run_dependencies</a> ()</td></tr>
<tr class="separator:aeb8ebd9e8c7c4fb7a4455545bc5dff8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e901c631d4befbf62372628a36aa4b"><td class="memItemLeft" align="right" valign="top">public method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBiodiverse_1_1Indices.html#a08e901c631d4befbf62372628a36aa4b">parse_dependencies_for_calc</a> ()</td></tr>
<tr class="separator:a08e901c631d4befbf62372628a36aa4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Indices_8pm_source.html#l00017">17</a> of file <a class="el" href="Indices_8pm_source.html">Indices.pm</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a0497b74e5724b08e1c623ce1ad022626"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::_convert_to_array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_convert_to_array' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_convert_to_array-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_convert_to_array-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_convert_to_array-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _convert_to_array: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a0497b74e5724b08e1c623ce1ad022626">_convert_to_array</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $input = $args{input};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keywordflow">if</span> !defined $input;</div>
<div class="line"></div>
<div class="line">    my @array;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (defined $input) {</div>
<div class="line">        my $reftype = reftype $input;</div>
<div class="line">        <span class="keywordflow">if</span> (!defined $reftype) {</div>
<div class="line">            @array = ($input);</div>
<div class="line">        }</div>
<div class="line">        elsif ($reftype eq <span class="stringliteral">&#39;ARRAY&#39;</span>) {</div>
<div class="line">            @array = @$input;  #  makes a copy</div>
<div class="line">        }</div>
<div class="line">        elsif ($reftype eq <span class="stringliteral">&#39;HASH&#39;</span>) {</div>
<div class="line">            @array = keys %$input;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">        #  anything else is not returned</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? @array : \@array;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a2b5d18fd694d5de85ee199cd5f936c56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">private method Biodiverse::Indices::_convert_to_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-_convert_to_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-_convert_to_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-_convert_to_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-_convert_to_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in _convert_to_hash: 26</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a2b5d18fd694d5de85ee199cd5f936c56">_convert_to_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $input = $args{input};</div>
<div class="line">    </div>
<div class="line">    Biodiverse::MissingArgument-&gt;throw (<span class="stringliteral">&#39;Input undefined in _convert_to_hash&#39;</span>)</div>
<div class="line">      <span class="keywordflow">if</span> !defined $input;</div>
<div class="line"></div>
<div class="line">    my %hash;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (defined $input) {</div>
<div class="line">        my $reftype = reftype $input;</div>
<div class="line">        <span class="keywordflow">if</span> (!defined $reftype) {</div>
<div class="line">            $hash{$input} = $input;</div>
<div class="line">        }</div>
<div class="line">        elsif ($reftype eq <span class="stringliteral">&#39;ARRAY&#39;</span>) {</div>
<div class="line">            @hash{@$input} = (1) x scalar @$input;</div>
<div class="line">        }</div>
<div class="line">        elsif ($reftype eq <span class="stringliteral">&#39;HASH&#39;</span>) {</div>
<div class="line">            %hash = %$input;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %hash : \%hash;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af79fac39412709b2f2d3f8baacb7e79f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::aggregate_calc_lists_by_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-aggregate_calc_lists_by_type' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-aggregate_calc_lists_by_type-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-aggregate_calc_lists_by_type-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-aggregate_calc_lists_by_type-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in aggregate_calc_lists_by_type: 30</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#af79fac39412709b2f2d3f8baacb7e79f">aggregate_calc_lists_by_type</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $calc_hash = $args{calc_hash};</div>
<div class="line">    </div>
<div class="line">    my @types = qw /pre_calc_global pre_calc post_calc post_calc_global/;</div>
<div class="line">    my %aggregated;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $type (@types) {</div>
<div class="line">        $aggregated{$type} = [];</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> (my ($calc, $sub_hash) = each %$calc_hash) {</div>
<div class="line">        my $calcs_by_type = $sub_hash-&gt;{calcs_by_type};</div>
<div class="line">        <span class="keywordflow">while</span> (my ($type, $array) = each %$calcs_by_type) {</div>
<div class="line">            my $agg_array = $aggregated{$type};</div>
<div class="line">            push @$agg_array, @$array;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="preprocessor">    #  now uniquify</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $type (@types) {</div>
<div class="line">        my $array = $aggregated{$type};</div>
<div class="line">        my @u_array = uniq @$array;</div>
<div class="line">        $aggregated{$type} = \@u_array;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %aggregated : \%aggregated;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a605e2168323e527af56100b86750bf42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_calculation_metadata_as_wiki </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_calculation_metadata_as_wiki' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_calculation_metadata_as_wiki-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_calculation_metadata_as_wiki-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_calculation_metadata_as_wiki-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_calculation_metadata_as_wiki: 217</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a605e2168323e527af56100b86750bf42">get_calculation_metadata_as_wiki</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %calculations = $self-&gt;get_calculations (@_);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  the html version</span></div>
<div class="line"><span class="preprocessor"></span>    my @header = (  </div>
<div class="line"><span class="preprocessor">        #&quot;Name&quot;,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #&quot;Analysis description&quot;,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">        #&quot;Subroutine&quot;,</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="stringliteral">&#39;Index #&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Index&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Index description&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Valid cluster metric?&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Minimum number of neighbour sets&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Formula&#39;</span>,</div>
<div class="line">        <span class="stringliteral">&#39;Reference&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $text (@header) {</div>
<div class="line">        $text = <span class="stringliteral">&quot;*$text*&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %hash;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my @place_holder = (undef, undef);</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my %indices;</div>
<div class="line">    my %calculation_hash;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $type (sort keys %calculations) {</div>
<div class="line">        <span class="keywordflow">foreach</span> my $calculations (@{$calculations{$type}}) {</div>
<div class="line">            my $ref = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line">            $ref-&gt;{analysis} = $calculations;</div>
<div class="line">            $calculation_hash{$type}{$calculations} = $ref;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #my $sort_by_type_then_name = sub {   $a-&gt;{type} cmp $b-&gt;{type}</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #                                  || $a-&gt;{name} cmp $b-&gt;{name}</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #                                  };</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    my $html;</div>
<div class="line"></div>
<div class="line">    my %done;</div>
<div class="line">    my $count = 1;</div>
<div class="line">    my $SPACE = q{ };</div>
<div class="line"></div>
<div class="line">    my $gadget_start_text</div>
<div class="line"><span class="preprocessor">        #= q{&lt;wiki:gadget url=&quot;http://mathml-gadget.googlecode.com/svn/trunk/mathml-gadget.xml&quot; border=&quot;0&quot; up_content=&quot;};</span></div>
<div class="line"><span class="preprocessor"></span>        = <span class="stringliteral">&#39;&lt;img src=&quot;http://latex.codecogs.com/png.latex?&#39;</span>;</div>
<div class="line">    my $gadget_end_text</div>
<div class="line"><span class="preprocessor">        #= q{&quot;/&gt;};</span></div>
<div class="line"><span class="preprocessor"></span>        = <span class="stringliteral">&#39; /&gt;&#39;</span>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #loop through the types</span></div>
<div class="line"><span class="preprocessor"></span>    BY_TYPE:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $type (sort keys %calculation_hash) {</div>
<div class="line">        $html .= <span class="stringliteral">&quot;==$type==&quot;</span>;</div>
<div class="line"></div>
<div class="line">        my $type_ref = $calculation_hash{$type};</div>
<div class="line"></div>
<div class="line">        BY_NAME:  #  loop through the names</div>
<div class="line">        <span class="keywordflow">foreach</span> my $ref (sort {$a-&gt;{name} cmp $b-&gt;{name}} values %$type_ref) {</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #my $starter = $ref-&gt;{name};</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">            #print $starter . &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">            $html .= <span class="stringliteral">&quot;\n \n \n&quot;</span>;</div>
<div class="line">            $html .= <span class="stringliteral">&quot;\n \n  ===$ref-&gt;{name}===\n \n&quot;</span>;</div>
<div class="line">            $html .= <span class="stringliteral">&quot;*Description:*   $ref-&gt;{description}\n\n&quot;</span>;</div>
<div class="line">            $html .= <span class="stringliteral">&quot;*Subroutine:*   $ref-&gt;{analysis}\n\n&quot;</span>;</div>
<div class="line"><span class="preprocessor">            #$html .= &quot;&lt;p&gt;&lt;b&gt;Module:&lt;/b&gt;   $ref-&gt;{source_module}&lt;/p&gt;\n&quot;;  #  not supported yet</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> ($ref-&gt;{reference}) {</div>
<div class="line">                $html .= <span class="stringliteral">&quot;*Reference:*   $ref-&gt;{reference}\n \n\n&quot;</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            my $formula = $ref-&gt;{formula};</div>
<div class="line">            croak <span class="stringliteral">&#39;Formula is not an array&#39;</span></div>
<div class="line">              <span class="keywordflow">if</span> defined $formula and not (ref $formula) =~ /ARRAY/;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ($formula and (ref $formula) =~ /ARRAY/) {</div>
<div class="line">                my $formula_url;</div>
<div class="line">                my $iter = 0;</div>
<div class="line"></div>
<div class="line">                FORMULA_ELEMENT_OVERVIEW:</div>
<div class="line">                <span class="keywordflow">foreach</span> my $element (@{$formula}) {</div>
<div class="line">                    <span class="keywordflow">if</span> (! defined $element</div>
<div class="line">                        || $element eq q{}) {</div>
<div class="line">                        $iter ++;</div>
<div class="line">                        next FORMULA_ELEMENT_OVERVIEW;</div>
<div class="line">                       }</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> ($iter % 2) {</div>
<div class="line"><span class="preprocessor">                        #$formula .= &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>                        <span class="keywordflow">if</span> ($element =~ /^\s/) {</div>
<div class="line">                            $formula_url .= $element;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> {</div>
<div class="line">                            $formula_url .= <span class="stringliteral">&quot; $element&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="preprocessor">                        #$formula .= &quot;\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>                        $formula_url .= $gadget_start_text;</div>
<div class="line">                        $formula_url .= $element;</div>
<div class="line">                        $formula_url .= qq{%.png<span class="stringliteral">&quot; title=&quot;</span>$element<span class="stringliteral">&quot;};</span></div>
<div class="line"><span class="stringliteral">                        $formula_url .= $gadget_end_text;</span></div>
<div class="line"><span class="stringliteral">                    }</span></div>
<div class="line"><span class="stringliteral">                    $iter++;</span></div>
<div class="line"><span class="stringliteral">                }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                $html .= &quot;</span>*Formula:*\n   $formula_url\n\n<span class="stringliteral">&quot;;</span></div>
<div class="line"><span class="stringliteral">            }</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my @table;</span></div>
<div class="line"><span class="stringliteral">            push @table, [@header];</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">            my $i = 0;</span></div>
<div class="line"><span class="stringliteral">            my $uses_reference = 0;</span></div>
<div class="line"><span class="stringliteral">            my $uses_formula = 0;</span></div>
<div class="line"><span class="stringliteral">            foreach my $index (sort keys %{$ref-&gt;{indices}}) {</span></div>
<div class="line"><span class="stringliteral">                </span></div>
<div class="line"><span class="stringliteral">                my $index_hash = $ref-&gt;{indices}{$index};</span></div>
<div class="line"><span class="stringliteral">                </span></div>
<div class="line"><span class="stringliteral">                #  repeated code from above - need to generalise to a sub</span></div>
<div class="line"><span class="stringliteral">                my $formula_url;</span></div>
<div class="line"><span class="stringliteral">                my $formula = $index_hash-&gt;{formula};</span></div>
<div class="line"><span class="stringliteral">                croak &quot;</span>Formula <span class="keywordflow">for</span> $index is not an array<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                  if defined $formula and not ((ref $formula) =~ /ARRAY/);</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">                if (1 and $formula and (ref $formula) =~ /ARRAY/) {</span></div>
<div class="line"><span class="stringliteral">                    </span></div>
<div class="line"><span class="stringliteral">                    $uses_formula = 1;</span></div>
<div class="line"><span class="stringliteral">                    </span></div>
<div class="line"><span class="stringliteral">                    my $iter = 0;</span></div>
<div class="line"><span class="stringliteral">                    foreach my $element (@{$index_hash-&gt;{formula}}) {</span></div>
<div class="line"><span class="stringliteral">                        if ($iter % 2) {</span></div>
<div class="line"><span class="stringliteral">                            if ($element =~ /^\s/) {</span></div>
<div class="line"><span class="stringliteral">                                $formula_url .= $element;</span></div>
<div class="line"><span class="stringliteral">                            }</span></div>
<div class="line"><span class="stringliteral">                            else {</span></div>
<div class="line"><span class="stringliteral">                                $formula_url .= &quot;</span> $element<span class="stringliteral">&quot;;</span></div>
<div class="line"><span class="stringliteral">                            }</span></div>
<div class="line"><span class="stringliteral">                        }</span></div>
<div class="line"><span class="stringliteral">                        else {</span></div>
<div class="line"><span class="stringliteral">                            $formula_url .= $gadget_start_text;</span></div>
<div class="line"><span class="stringliteral">                            $formula_url .= $element;</span></div>
<div class="line"><span class="stringliteral">                            $formula_url .= qq{%.png&quot;</span> title=<span class="stringliteral">&quot;$element&quot;</span>};</div>
<div class="line">                            $formula_url .= $gadget_end_text;</div>
<div class="line">                        }</div>
<div class="line">                        $iter++;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                $formula_url .= $SPACE;</div>
<div class="line">                </div>
<div class="line">                my @line;</div>
<div class="line">                </div>
<div class="line">                push @line, $count;</div>
<div class="line">                push @line, $index;</div>
<div class="line">                </div>
<div class="line">                my $description = $index_hash-&gt;{description} || $SPACE;</div>
<div class="line">                $description =~ s{\n}{ }gmo;  # purge any newlines</div>
<div class="line">                push @line, $description;</div>
<div class="line">                </div>
<div class="line">                push @line, $index_hash-&gt;{cluster} ? <span class="stringliteral">&quot;cluster metric&quot;</span> : $SPACE;</div>
<div class="line">                push @line, $index_hash-&gt;{uses_nbr_lists} || $ref-&gt;{uses_nbr_lists} || $SPACE;</div>
<div class="line">                push @line, $formula_url;</div>
<div class="line">                my $reference = $index_hash-&gt;{reference};</div>
<div class="line">                <span class="keywordflow">if</span> (defined $index_hash-&gt;{reference}) {</div>
<div class="line">                    $uses_reference = 1;</div>
<div class="line">                    $reference =~s{\n}{ }gmo;</div>
<div class="line">                }</div>
<div class="line">                push @line, $reference || $SPACE;</div>
<div class="line"></div>
<div class="line">                push @table, \@line;</div>
<div class="line"></div>
<div class="line">                $i++;</div>
<div class="line">                $count ++;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  remove the reference col if none given</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> (! $uses_reference) {</div>
<div class="line">                <span class="keywordflow">foreach</span> my $row (@table) {</div>
<div class="line">                    pop @$row;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  and remove the formula also if need be</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">if</span> (! $uses_formula) {</div>
<div class="line">                <span class="keywordflow">foreach</span> my $row (@table) {</div>
<div class="line">                    splice @$row, 5, 1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #$html .= $table;</span></div>
<div class="line"><span class="preprocessor"></span>            </div>
<div class="line">            <span class="keywordflow">foreach</span> my $line (@table) {</div>
<div class="line">                my $line_text;</div>
<div class="line">                $line_text .= q{|| };</div>
<div class="line">                $line_text .= join (q{ || }, @$line);</div>
<div class="line">                $line_text .= q{ ||};</div>
<div class="line">                $line_text .= <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">                </div>
<div class="line">                my $x = grep {! defined $_} @$line;</div>
<div class="line">                </div>
<div class="line">                $html .= $line_text;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $html .= <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line">            </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $html;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a6a89b78257465421ebfa2351710adb89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_calculations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_calculations' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_calculations-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_calculations-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_calculations-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_calculations: 16</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a6a89b78257465421ebfa2351710adb89">get_calculations</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    my %calculations;</div>
<div class="line"></div>
<div class="line">    my $list = Class::Inspector-&gt;methods (blessed $self);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $method (@$list) {</div>
<div class="line">        next <span class="keywordflow">if</span> $method !~ /^calc_/;</div>
<div class="line">        next <span class="keywordflow">if</span> $method =~ /calc_abc\d?$/;</div>
<div class="line">        my $ref = $self-&gt;get_args (sub =&gt; $method);</div>
<div class="line">        push @{$calculations{$ref-&gt;{type}}}, $method;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %calculations : \%calculations;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4288db9cf06cf2c58f278863051efe39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_calculations_as_flat_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_calculations_as_flat_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_calculations_as_flat_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_calculations_as_flat_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_calculations_as_flat_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_calculations_as_flat_hash: 5</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a4288db9cf06cf2c58f278863051efe39">get_calculations_as_flat_hash</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $list = $self-&gt;get_calculations;</div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_list_as_flat_hash (list =&gt; $list);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a8edd1eb1053052bb6c699b30ef0b2e24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_deps_per_calc_by_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_deps_per_calc_by_type' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_deps_per_calc_by_type-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_deps_per_calc_by_type-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_deps_per_calc_by_type-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_deps_per_calc_by_type: 24</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a8edd1eb1053052bb6c699b30ef0b2e24">get_deps_per_calc_by_type</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    my $calc_hash = $args{calc_hash};</div>
<div class="line">    </div>
<div class="line">    my @types = qw /pre_calc_global pre_calc post_calc post_calc_global/;</div>
<div class="line">    my %aggregated;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $type (@types) {</div>
<div class="line">        $aggregated{$type} = {};</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> (my ($calc, $sub_hash) = each %$calc_hash) {</div>
<div class="line">        my $calcs_by_type = $sub_hash-&gt;{deps_by_type_per_calc};</div>
<div class="line">        <span class="keywordflow">while</span> (my ($type, $hash) = each %$calcs_by_type) {</div>
<div class="line">            <span class="keywordflow">while</span> (my ($dep_calc, $array) = each %$hash) {</div>
<div class="line">                $aggregated{$type}{$dep_calc} = $array;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %aggregated : \%aggregated;    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a0b115230c2e0ffc562af783e2e9c0951"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_index_source </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_index_source' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_index_source-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_index_source-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_index_source-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_index_source: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a0b115230c2e0ffc562af783e2e9c0951">get_index_source</a> {  #  <span class="keywordflow">return</span> the source sub <span class="keywordflow">for</span> an index</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    croak <span class="stringliteral">&quot;index argument not specified\n&quot;</span> <span class="keywordflow">if</span> ! defined $args{index};</div>
<div class="line"></div>
<div class="line">    my $source = $self-&gt;get_index_source_hash;</div>
<div class="line">    my @tmp = %{$source-&gt;{$args{index}}};</div>
<div class="line">    <span class="keywordflow">return</span> $tmp[0];  #  the hash key is the first value.  Messy, but it works.</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get a hash of indices arising from these calculations (keys),</span></div>
<div class="line"><span class="preprocessor">#   with the analysis as the value</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af6c4a0cdfb8427e4059839cf1cf0729e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_index_source_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_index_source_hash' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_index_source_hash-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_index_source_hash-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_index_source_hash-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_index_source_hash: 25</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#af6c4a0cdfb8427e4059839cf1cf0729e">get_index_source_hash</a> { </div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{calculations} || $self-&gt;get_calculations_as_flat_hash;</div>
<div class="line">    my %list2;</div>
<div class="line">    my $using_nbr_list_count = $args{uses_nbr_lists} <span class="comment">// 2;  #  need to use 2 for back compat</span></div>
<div class="line"></div>
<div class="line">    CALC:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calculations (keys %$list) {</div>
<div class="line">        my $args = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line"></div>
<div class="line">        next CALC <span class="keywordflow">if</span> $using_nbr_list_count &lt; $args-&gt;{uses_nbr_lists};</div>
<div class="line"></div>
<div class="line">        INDEX:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $index (keys %{$args-&gt;{indices}}) {</div>
<div class="line">            my $index_uses_nbr_lists = $args-&gt;{indices}{$index}{uses_nbr_lists} <span class="comment">// 1;</span></div>
<div class="line">            next INDEX <span class="keywordflow">if</span> $using_nbr_list_count &lt; $index_uses_nbr_lists;</div>
<div class="line"></div>
<div class="line">            $list2{$index}{$calculations}++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %list2 : \%list2;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a587a122f1216ae00a7c037cda02fd12b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_indices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_indices' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_indices-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_indices-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_indices-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_indices: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a587a122f1216ae00a7c037cda02fd12b">get_indices</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;get_index_source_hash (@_);    </div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="adae63b1da9005f7fe21bd6aeb3015032"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_indices_uses_lists_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_indices_uses_lists_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_indices_uses_lists_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_indices_uses_lists_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_indices_uses_lists_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_indices_uses_lists_count: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#adae63b1da9005f7fe21bd6aeb3015032">get_indices_uses_lists_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $list = $args{calculations} || $self-&gt;get_calculations;</div>
<div class="line">    my %list = $self-&gt;get_list_as_flat_hash (list =&gt; $list);</div>
<div class="line"></div>
<div class="line">    my %indices;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calculations (keys %list) {</div>
<div class="line">        my $ref = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line">        <span class="keywordflow">foreach</span> my $index (keys %{$ref-&gt;{indices}}) {</div>
<div class="line">            $indices{$index} = $ref-&gt;{indices}{$index}{uses_nbr_lists};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %indices : \%indices;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  get a list of indices in a set of calculations</span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a93959091db7757fbd6838876fe7a208d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_pairwise_mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_pairwise_mode' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_pairwise_mode-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_pairwise_mode-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_pairwise_mode-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_pairwise_mode: 58</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a93959091db7757fbd6838876fe7a208d">get_pairwise_mode</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;{pairwise_mode};</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">1;</div>
<div class="line"></div>
<div class="line">__END__</div>
<div class="line"></div>
<div class="line">=head1 NAME</div>
<div class="line"></div>
<div class="line"><a class="code" href="classBiodiverse_1_1Indices.html">Biodiverse::Indices</a></div>
<div class="line"></div>
<div class="line">=head1 SYNOPSIS</div>
<div class="line"></div>
<div class="line">  use Biodiverse::Indices;</div>
<div class="line">  my $indices = Biodiverse::Indices-&gt;<a class="code" href="classBiodiverse_1_1Indices.html#a9b653e2cf5ae1ebc02b930dabae47779">new</a>;</div>
<div class="line"></div>
<div class="line">=head1 DESCRIPTION</div>
<div class="line"></div>
<div class="line">Indices handler <span class="keywordflow">for</span> the Biodiverse system.</div>
<div class="line">See L&lt;http:<span class="comment">//code.google.com/p/biodiverse/wiki/Indices&gt; for the list</span></div>
<div class="line">of available indices.</div>
<div class="line"></div>
<div class="line">=head1 METHODS</div>
<div class="line"></div>
<div class="line">=over</div>
<div class="line"></div>
<div class="line">=item NEED TO INSERT METHODS</div>
<div class="line"></div>
<div class="line">=back</div>
<div class="line"></div>
<div class="line">=head1 REPORTING ERRORS</div>
<div class="line"></div>
<div class="line">Use the issue tracker at http:<span class="comment">//www.purl.org/biodiverse</span></div>
<div class="line"></div>
<div class="line">=head1 COPYRIGHT</div>
<div class="line"></div>
<div class="line">Copyright (c) 2010 Shawn Laffan. All rights reserved.  </div>
<div class="line"></div>
<div class="line">=head1 LICENSE</div>
<div class="line"></div>
<div class="line">This program is free software: you can redistribute it and/or modify</div>
<div class="line">it under the terms of the GNU General Public License as published by</div>
<div class="line">the Free Software Foundation, either version 3 of the License, or</div>
<div class="line">(at your option) any later version.</div>
<div class="line"></div>
<div class="line">This program is distributed in the hope that it will be useful,</div>
<div class="line">but WITHOUT ANY WARRANTY; without even the implied warranty of</div>
<div class="line">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</div>
<div class="line">GNU General Public License <span class="keywordflow">for</span> more details.</div>
<div class="line"></div>
<div class="line">For a full copy of the license see &lt;http:<span class="comment">//www.gnu.org/licenses/&gt;.</span></div>
<div class="line"></div>
<div class="line">=cut</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a352aed717ed90ec13e36e1ba7e49cda8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_required_args </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_required_args' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_required_args-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_required_args-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_required_args-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_required_args: 25</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a352aed717ed90ec13e36e1ba7e49cda8">get_required_args</a> {  #  <span class="keywordflow">return</span> a hash of those methods that require a parameter be specified</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{calculations} || $self-&gt;get_calculations_as_flat_hash;</div>
<div class="line">    my %params;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">foreach</span> my $calculations (keys %$list) {</div>
<div class="line">        my $ref = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line">        <span class="keywordflow">if</span> (exists $ref-&gt;{required_args}) {  #  make it a hash <span class="keywordflow">if</span> it not already</div>
<div class="line">            my $reqd_ags = $ref-&gt;{required_args};</div>
<div class="line">            <span class="keywordflow">if</span> ((ref $reqd_ags) =~ /ARRAY/) {</div>
<div class="line">                my %hash;</div>
<div class="line">                @hash{@$reqd_ags} = (1) x scalar @$reqd_ags;</div>
<div class="line">                $ref-&gt;{required_args} = \%hash;</div>
<div class="line">            }</div>
<div class="line">            elsif (not ref $ref-&gt;{required_args}) {</div>
<div class="line">                $ref-&gt;{required_args} = {$ref-&gt;{required_args} =&gt; 1};</div>
<div class="line">            }</div>
<div class="line">            $params{$calculations} = $ref-&gt;{required_args};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %params : \%params;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a891d72306f449376de18ca12095e91fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_results_from_pre_calc_global </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_results_from_pre_calc_global' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_results_from_pre_calc_global-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_results_from_pre_calc_global-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_results_from_pre_calc_global-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_results_from_pre_calc_global: 13</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a891d72306f449376de18ca12095e91fc">get_results_from_pre_calc_global</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    no autovivification;</div>
<div class="line">    </div>
<div class="line">    my $results = $self-&gt;get_param (<span class="stringliteral">&#39;AS_RESULTS_FROM_GLOBAL&#39;</span>);</div>
<div class="line">    my $calc_results = $results-&gt;{$args{calculation}};</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %$calc_results : $calc_results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a211af026c4148f3653cdeec157f8114e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_valid_calculation_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_valid_calculation_count' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_valid_calculation_count-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_valid_calculation_count-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_valid_calculation_count-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_valid_calculation_count: 6</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a211af026c4148f3653cdeec157f8114e">get_valid_calculation_count</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my $calcs = $self-&gt;get_valid_calculations_to_run;</div>
<div class="line">    <span class="keywordflow">return</span> scalar keys %$calcs;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a4302ef8223595ccc51abe1e26f739b43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_valid_calculations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_valid_calculations' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_valid_calculations-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_valid_calculations-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_valid_calculations-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_valid_calculations: 58</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a4302ef8223595ccc51abe1e26f739b43">get_valid_calculations</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $calcs = $self-&gt;_convert_to_hash (input =&gt; $args{calculations});</div>
<div class="line">    $calcs    = [sort keys %$calcs];  #  Alpha sort <span class="keywordflow">for</span> consistent order of eval.</div>
<div class="line"></div>
<div class="line">    my %valid_calcs;</div>
<div class="line">    my @removed;</div>
<div class="line"></div>
<div class="line">  CALC:</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calc (@$calcs) {</div>
<div class="line"><span class="preprocessor">        #print &quot;$calc\n&quot;;</span></div>
<div class="line"><span class="preprocessor"></span>        my $deps = eval {</div>
<div class="line">            $self-&gt;parse_dependencies_for_calc (</div>
<div class="line">                calculation =&gt; $calc,</div>
<div class="line">                %args,</div>
<div class="line">            );</div>
<div class="line">        };</div>
<div class="line">        my $e = $EVAL_ERROR;</div>
<div class="line">        <span class="keywordflow">if</span> ($e) {</div>
<div class="line">            <span class="keywordflow">for</span> my $exception (@valid_calc_exceptions) {</div>
<div class="line">                <span class="keywordflow">if</span> ($exception-&gt;caught) {</div>
<div class="line">                    print $e;</div>
<div class="line">                    push @removed, $calc;</div>
<div class="line">                    next CALC;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            croak $EVAL_ERROR;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $valid_calcs{$calc} = $deps;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (scalar @removed) {</div>
<div class="line">        print <span class="stringliteral">&quot;[INDICES] The following calcs are not valid and have been removed:\n&quot;</span></div>
<div class="line">            . join q{ }, @removed, <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %aggregated_calc_lists = $self-&gt;aggregate_calc_lists_by_type (</div>
<div class="line">        calc_hash =&gt; \%valid_calcs,</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    my %aggregated_deps_per_calc = $self-&gt;get_deps_per_calc_by_type (</div>
<div class="line">        calc_hash =&gt; \%valid_calcs,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        calculations_to_run =&gt; \%valid_calcs,</div>
<div class="line">        calc_lists_by_type  =&gt; \%aggregated_calc_lists,</div>
<div class="line">        calc_deps_by_type   =&gt; \%aggregated_deps_per_calc,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    $self-&gt;set_param (VALID_CALCULATIONS =&gt; \%results);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a02576609aa6ef856a491f8a946003fc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_valid_calculations_to_run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_valid_calculations_to_run' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_valid_calculations_to_run-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_valid_calculations_to_run-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_valid_calculations_to_run-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_valid_calculations_to_run: 9</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a02576609aa6ef856a491f8a946003fc3">get_valid_calculations_to_run</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    </div>
<div class="line">    my $valid_calcs = $self-&gt;get_param(<span class="stringliteral">&#39;VALID_CALCULATIONS&#39;</span>);</div>
<div class="line">    my $calcs = $valid_calcs-&gt;{calculations_to_run};</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %$calcs : $calcs;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5f4b59e84ca80acf747510142288cfcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_valid_cluster_indices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_valid_cluster_indices' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_valid_cluster_indices-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_valid_cluster_indices-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_valid_cluster_indices-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_valid_cluster_indices: 19</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a5f4b59e84ca80acf747510142288cfcc">get_valid_cluster_indices</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{calculations} || $self-&gt;get_calculations_as_flat_hash;</div>
<div class="line"></div>
<div class="line">    my %indices;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calculations (keys %$list) {</div>
<div class="line">        my $ref = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line">        <span class="keywordflow">foreach</span> my $index (keys %{$ref-&gt;{indices}}) {</div>
<div class="line">            <span class="keywordflow">if</span> ($ref-&gt;{indices}{$index}{cluster}) {</div>
<div class="line">                my $description = $ref-&gt;{indices}{$index}{description};</div>
<div class="line">                $indices{$index} = $description;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %indices : \%indices;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="af4960ad3981bfcd971470870640c0210"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::get_valid_region_grower_indices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-get_valid_region_grower_indices' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-get_valid_region_grower_indices-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-get_valid_region_grower_indices-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-get_valid_region_grower_indices-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in get_valid_region_grower_indices: 28</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#af4960ad3981bfcd971470870640c0210">get_valid_region_grower_indices</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $list = $args{calculations} || $self-&gt;get_calculations_as_flat_hash;</div>
<div class="line"></div>
<div class="line">    my %indices;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calculations (keys %$list) {</div>
<div class="line">        my $ref = $self-&gt;get_args (sub =&gt; $calculations);</div>
<div class="line">        INDEX:</div>
<div class="line">        <span class="keywordflow">foreach</span> my $index (keys %{$ref-&gt;{indices}}) {</div>
<div class="line">            my $hash_ref = $ref-&gt;{indices}{$index};</div>
<div class="line">            next INDEX</div>
<div class="line">              <span class="keywordflow">if</span>  exists $hash_ref-&gt;{lumper}</div>
<div class="line">                 and not $hash_ref-&gt;{lumper};</div>
<div class="line">            next INDEX <span class="keywordflow">if</span> $hash_ref-&gt;{cluster};</div>
<div class="line">            next INDEX</div>
<div class="line">              <span class="keywordflow">if</span> defined $hash_ref-&gt;{type}</div>
<div class="line">                 and $hash_ref-&gt;{type} eq <span class="stringliteral">&#39;list&#39;</span>;</div>
<div class="line">            </div>
<div class="line">            my $description = $ref-&gt;{indices}{$index}{description};</div>
<div class="line">            $indices{$index} = $description;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %indices : \%indices;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a7c2f9b1edc670ced31ffbbffbd782003"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::is_cluster_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_cluster_index' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_cluster_index-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_cluster_index-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_cluster_index-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_cluster_index: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a7c2f9b1edc670ced31ffbbffbd782003">is_cluster_index</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $index = $args{index};</div>
<div class="line">    croak <span class="stringliteral">&quot;index argument missing\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> !defined $index;</div>
<div class="line">    </div>
<div class="line">    my %valid = $self-&gt;get_valid_cluster_indices;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> exists $valid{$index};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a5baaabcf681c7efe218c3129cc7618f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::is_region_grower_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-is_region_grower_index' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-is_region_grower_index-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-is_region_grower_index-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-is_region_grower_index-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in is_region_grower_index: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a5baaabcf681c7efe218c3129cc7618f1">is_region_grower_index</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    my $index = $args{index};</div>
<div class="line">    croak <span class="stringliteral">&quot;index argument missing\n&quot;</span></div>
<div class="line">      <span class="keywordflow">if</span> !defined $index;</div>
<div class="line">    </div>
<div class="line">    my %valid = $self-&gt;get_valid_region_grower_indices;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> exists $valid{$index};</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a9b653e2cf5ae1ebc02b930dabae47779"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-new' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-new-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-new-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-new-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in new: 22</span></div>
<div class="line"><span class="preprocessor"></span>sub <span class="keyword">new</span> {</div>
<div class="line">    my $class = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $self = bless {}, $class;</div>
<div class="line"></div>
<div class="line">    my %PARAMS = (  #  <span class="keywordflow">default</span> params</div>
<div class="line">        TYPE            =&gt; <span class="stringliteral">&#39;INDICES&#39;</span>,</div>
<div class="line">        OUTSUFFIX       =&gt; <span class="stringliteral">&#39;bis&#39;</span>,</div>
<div class="line">        OUTSUFFIX_YAML  =&gt; <span class="stringliteral">&#39;biy&#39;</span>,</div>
<div class="line">    );</div>
<div class="line">    $self-&gt;set_params (%PARAMS, %args);</div>
<div class="line">    $self-&gt;set_default_params;  #  load any user overrides</div>
<div class="line"></div>
<div class="line">    $self-&gt;reset_results(global =&gt; 1);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  avoid memory leak probs with circular refs to parents</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  ensures children are destroyed when parent is destroyed</span></div>
<div class="line"><span class="preprocessor"></span>    $self-&gt;weaken_basedata_ref;  </div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a08e901c631d4befbf62372628a36aa4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::parse_dependencies_for_calc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-parse_dependencies_for_calc' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-parse_dependencies_for_calc-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-parse_dependencies_for_calc-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-parse_dependencies_for_calc-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in parse_dependencies_for_calc: 146</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a08e901c631d4befbf62372628a36aa4b">parse_dependencies_for_calc</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $calcs = [$args{calculation}];  # array is a leftover - need to correct it</div>
<div class="line"></div>
<div class="line">    my $nbr_list_count = $args{nbr_list_count} || $self-&gt;get_param (<span class="stringliteral">&#39;NBR_LIST_COUNT&#39;</span>) || 1;</div>
<div class="line">    my $calc_args      = $args{calc_args} || \%args;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Types of calculation.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  Order is important.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  pre_calc can depend on any other type,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  post_calc and post_calc_global can only depend on themselves and pre_calc_global,</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  post_calc_global can only depend on itself and pre_calc_global</span></div>
<div class="line"><span class="preprocessor"></span>    my @types     = qw /pre_calc post_calc post_calc_global pre_calc_global/;</div>
<div class="line">    my @type_list = @types;</div>
<div class="line"></div>
<div class="line">    my %calcs_by_type;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $type (@types) {</div>
<div class="line">        $calcs_by_type{$type} = [];</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">    #  Start with the ones we want results for.</span></div>
<div class="line"><span class="preprocessor"></span>    $calcs_by_type{pre_calc} = $calcs;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  hash of dependencies per calculation, and the reverse</span></div>
<div class="line"><span class="preprocessor"></span>    my %deps_by_type;</div>
<div class="line">    my %reverse_deps;</div>
<div class="line">    my %metadata_hash;</div>
<div class="line">    my %indices_to_clear;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Iterate over each type, adding to the lists for</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  itself and each subsequent type</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  (hence the unusual while condition and the shifting at the end)</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">while</span> (defined (my $type = $type_list[0])) {</div>
<div class="line">        my $list = $calcs_by_type{$type};</div>
<div class="line">        <span class="keywordflow">foreach</span> my $calc (@$list) {</div>
<div class="line">            my $metadata;</div>
<div class="line">            <span class="keywordflow">if</span> ($metadata_hash{$calc}) {</div>
<div class="line">                $metadata = $metadata_hash{$calc};</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> {</div>
<div class="line">                $metadata = eval {$self-&gt;get_args (sub =&gt; $calc)};</div>
<div class="line">                croak $EVAL_ERROR <span class="keywordflow">if</span> $EVAL_ERROR;</div>
<div class="line">                $metadata_hash{$calc} = $metadata;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #  run some validity checks</span></div>
<div class="line"><span class="preprocessor"></span>            my $uses_nbr_lists = $metadata-&gt;{uses_nbr_lists};</div>
<div class="line">            <span class="keywordflow">if</span> (defined $uses_nbr_lists) {</div>
<div class="line">                <span class="keywordflow">if</span> ($uses_nbr_lists &gt; $nbr_list_count) {</div>
<div class="line">                    Biodiverse::Indices::InsufficientElementLists-&gt;throw (</div>
<div class="line">                        error =&gt; <span class="stringliteral">&quot;[INDICES] WARNING: Insufficient neighbour lists for $calc. &quot;</span></div>
<div class="line">                                . <span class="stringliteral">&quot;Need $uses_nbr_lists but only $nbr_list_count available.\n&quot;</span>,</div>
<div class="line">                    );</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">            #  check the indices have sufficient nbr sets</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="keywordflow">while</span> (my ($index, $index_meta) = each %{$metadata-&gt;{indices}}) {</div>
<div class="line">                my $index_uses_nbr_lists = $index_meta-&gt;{uses_nbr_lists} || 1;</div>
<div class="line">                <span class="keywordflow">if</span> ($index_uses_nbr_lists &gt; $nbr_list_count) {</div>
<div class="line">                    $indices_to_clear{$index} ++;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> ($metadata-&gt;{required_args}) {</div>
<div class="line"><span class="preprocessor">                #  don&#39;t really need to convert to hash here, but do need a list form</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                #my $reqd_args_h = $self-&gt;_convert_to_hash (input =&gt; $metadata-&gt;{required_args});</span></div>
<div class="line"><span class="preprocessor"></span>                my $reqd_args_a = $self-&gt;_convert_to_array (input =&gt; $metadata-&gt;{required_args});</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">foreach</span> my $required_arg (sort @$reqd_args_a) {</div>
<div class="line">                    my $re = qr /^($required_arg)$/;</div>
<div class="line">                    my $is_defined;</div>
<div class="line">                    CALC_ARG:</div>
<div class="line">                    <span class="keywordflow">foreach</span> my $calc_arg (sort grep {$_ =~ $re} keys %$calc_args) {</div>
<div class="line"><span class="preprocessor">                        #if ($calc_arg =~ $re) {</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">                            #my $match = $1;</span></div>
<div class="line"><span class="preprocessor"></span>                            <span class="keywordflow">if</span> (defined $calc_args-&gt;{$calc_arg}) {</div>
<div class="line">                                $is_defined ++;</div>
<div class="line">                            }</div>
<div class="line"><span class="preprocessor">                        #}</span></div>
<div class="line"><span class="preprocessor"></span>                    }</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> (! $is_defined) {</div>
<div class="line">                        Biodiverse::Indices::MissingRequiredArguments-&gt;throw (</div>
<div class="line">                            error =&gt; <span class="stringliteral">&quot;[INDICES] WARNING: $calc missing required &quot;</span></div>
<div class="line">                                    . <span class="stringliteral">&quot;parameter $required_arg, &quot;</span></div>
<div class="line">                                    . <span class="stringliteral">&quot;dropping it and any calc that depends on it\n&quot;</span>,</div>
<div class="line">                        );</div>
<div class="line">                        </div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> ($metadata-&gt;{pre_conditions}) {</div>
<div class="line">                my $pre_cond_a = $self-&gt;_convert_to_array (input =&gt; $metadata-&gt;{pre_conditions});</div>
<div class="line">                </div>
<div class="line">                <span class="keywordflow">foreach</span> my $pre_cond (sort @$pre_cond_a) {</div>
<div class="line">                    my $check = $self-&gt;$pre_cond (%$calc_args);</div>
<div class="line">                    <span class="keywordflow">if</span> (! $check) {</div>
<div class="line">                        Biodiverse::Indices::FailedPreCondition-&gt;throw (</div>
<div class="line">                            error =&gt; <span class="stringliteral">&quot;[INDICES] WARNING: $calc failed precondition. &quot;</span></div>
<div class="line">                                    . <span class="stringliteral">&quot;Dropping it and any calc that depends on it\n&quot;</span>,</div>
<div class="line">                        );</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">foreach</span> my $secondary_type (@types) {</div>
<div class="line"><span class="preprocessor">                #  $pc is the secondary pre or post calc (global or not)</span></div>
<div class="line"><span class="preprocessor"></span>                my $pc = $metadata-&gt;{$secondary_type};</div>
<div class="line">                next <span class="keywordflow">if</span> ! defined $pc;</div>
<div class="line">                $pc = $self-&gt;_convert_to_array (input =&gt; $pc);</div>
<div class="line">                my $secondary_list = $calcs_by_type{$secondary_type};</div>
<div class="line">                push @$secondary_list, @$pc;</div>
<div class="line"></div>
<div class="line">                $deps_by_type{$secondary_type}{$calc} = $pc;</div>
<div class="line">                <span class="keywordflow">foreach</span> my $c (@$pc) {</div>
<div class="line">                    $reverse_deps{$c}{$calc}++;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        shift @type_list;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  now we reverse the pre_calc and pre_calc_global lists</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  and clear any dups </span></div>
<div class="line"><span class="preprocessor"></span>    <span class="keywordflow">foreach</span> my $type (@types) {</div>
<div class="line">        my $list = $calcs_by_type{$type};</div>
<div class="line">        my @u_list = uniq ($type =~ /^post/ ? @$list : reverse @$list);</div>
<div class="line">        $calcs_by_type{$type} = \@u_list;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    my %results = (</div>
<div class="line">        calcs_by_type         =&gt; \%calcs_by_type,</div>
<div class="line">        deps_by_type_per_calc =&gt; \%deps_by_type,</div>
<div class="line">        reverse_deps          =&gt; \%reverse_deps,</div>
<div class="line">        indices_to_clear      =&gt; \%indices_to_clear,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">my @valid_calc_exceptions = qw /</div>
<div class="line">    Biodiverse::Indices::MissingRequiredArguments</div>
<div class="line">    Biodiverse::Indices::InsufficientElementLists</div>
<div class="line">    Biodiverse::Indices::FailedPreCondition</div>
<div class="line">/;</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="adcde60a82a0a0b839388006afd54c544"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::reset_results </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-reset_results' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-reset_results-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-reset_results-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-reset_results-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in reset_results: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#adcde60a82a0a0b839388006afd54c544">reset_results</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ($args{global}) {</div>
<div class="line">        $self-&gt;set_param (AS_RESULTS_FROM_GLOBAL =&gt; {});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a1384c2dc6ce11eba1ebd94a08ceaa1bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_calculations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_calculations' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_calculations-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_calculations-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_calculations-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_calculations: 31</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a1384c2dc6ce11eba1ebd94a08ceaa1bd">run_calculations</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    $self-&gt;reset_results;  #  clear any previous local results - poss redundant now</div>
<div class="line"></div>
<div class="line">    my $pre_calc_local_results = $self-&gt;run_precalc_locals (%args);</div>
<div class="line"></div>
<div class="line">    my %calcs_to_run = $self-&gt;get_valid_calculations_to_run;</div>
<div class="line"></div>
<div class="line">    my %results;  #  stores the results</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calc (keys %calcs_to_run) {</div>
<div class="line">        my $calc_results = $pre_calc_local_results-&gt;{$calc};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">        #  remove those that are invalid</span></div>
<div class="line"><span class="preprocessor"></span>        my $indices_to_clear = $calcs_to_run{$calc}{indices_to_clear};</div>
<div class="line">        <span class="keywordflow">if</span> ($indices_to_clear) {</div>
<div class="line">            <span class="keyword">delete</span> @{$calc_results}{keys %$indices_to_clear};</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        @results{keys %$calc_results} = values %$calc_results;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    $self-&gt;run_postcalc_locals (%args);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#  Allow access to the pre_calc_global results.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#  Local results are more problematic as they can be cleaned up by post_calc_locals.</span></div>
<div class="line"><span class="preprocessor">#  Or are they?  However, the fact remains that, at the moment, they are not stored anywhere.  </span></div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aeb8ebd9e8c7c4fb7a4455545bc5dff8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_dependencies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_dependencies' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_dependencies-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_dependencies-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_dependencies-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_dependencies: 69</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#aeb8ebd9e8c7c4fb7a4455545bc5dff8a">run_dependencies</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $type = $args{type};</div>
<div class="line"></div>
<div class="line">    my $tmp = $self-&gt;get_param(<span class="stringliteral">&#39;AS_RESULTS_FROM_GLOBAL&#39;</span>) || {};</div>
<div class="line">    my %as_results_from_global = %$tmp;  #  make a copy</div>
<div class="line"></div>
<div class="line">    my $validated_calcs = $self-&gt;get_param (<span class="stringliteral">&#39;VALID_CALCULATIONS&#39;</span>);</div>
<div class="line">    my $calc_list = $validated_calcs-&gt;{calc_lists_by_type}{$type};</div>
<div class="line">    my $dep_list  = $validated_calcs-&gt;{calc_deps_by_type}{$type};</div>
<div class="line">    my $dep_list_global = $validated_calcs-&gt;{calc_deps_by_type}{pre_calc_global};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">    #  Now we run the calculations at this level.</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  We also keep track of what has been run</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #  to avoid repetition through multiple dependencies.</span></div>
<div class="line"><span class="preprocessor"></span>    my %results;</div>
<div class="line">    my %as_results_from;</div>
<div class="line">    <span class="keywordflow">foreach</span> my $calc (@$calc_list) {</div>
<div class="line">        my $calc_results;</div>
<div class="line"><span class="preprocessor">        #  if already cached then just grab it - should never happen now?</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (exists $as_results_from{$calc}) {</div>
<div class="line">            $calc_results = $as_results_from{$calc};</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            my %dep_results;</div>
<div class="line">            <span class="keywordflow">if</span> (exists $dep_list-&gt;{$calc}) {</div>
<div class="line">                my $deps = $dep_list-&gt;{$calc} || [];</div>
<div class="line">                <span class="keywordflow">foreach</span> my $dep (@$deps) {</div>
<div class="line">                    my $dep_res = exists $as_results_from{$dep}</div>
<div class="line">                        ? $as_results_from{$dep}</div>
<div class="line">                        : {};</div>
<div class="line">                    @dep_results{keys %$dep_res} = values %$dep_res;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (exists $dep_list_global-&gt;{$calc}) {</div>
<div class="line">                my $deps = $dep_list_global-&gt;{$calc} || [];</div>
<div class="line">                <span class="keywordflow">foreach</span> my $dep (@$deps) {</div>
<div class="line">                    my $dep_res = exists $as_results_from_global{$dep}</div>
<div class="line">                        ? $as_results_from_global{$dep}</div>
<div class="line">                        : {};</div>
<div class="line">                    @dep_results{keys %$dep_res} = values %$dep_res;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $calc_results = eval {</div>
<div class="line">                $self-&gt;$calc (  </div>
<div class="line">                    %args,</div>
<div class="line">                    %dep_results,</div>
<div class="line">                );</div>
<div class="line">            };</div>
<div class="line">            croak $EVAL_ERROR <span class="keywordflow">if</span> $EVAL_ERROR;</div>
<div class="line">            $as_results_from{$calc} = $calc_results;</div>
<div class="line">            <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&#39;pre_calc_global&#39;</span>) {</div>
<div class="line">                $as_results_from_global{$calc} = $calc_results;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        $results{$calc} = $calc_results;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ($type eq <span class="stringliteral">&#39;pre_calc_global&#39;</span>) {</div>
<div class="line">        $self-&gt;set_param (AS_RESULTS_FROM_GLOBAL =&gt; \%as_results_from_global);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %results : \%results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="abba7a55c75a6ba3da6639e6e4ac38cc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_postcalc_globals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_postcalc_globals' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_postcalc_globals-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_postcalc_globals-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_postcalc_globals-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_postcalc_globals: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#abba7a55c75a6ba3da6639e6e4ac38cc6">run_postcalc_globals</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;run_dependencies (</div>
<div class="line">        %args,</div>
<div class="line">        type =&gt; <span class="stringliteral">&#39;post_calc_global&#39;</span>,</div>
<div class="line">    );</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a78cf2b7e5af5007f227e2371cf8341d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_postcalc_locals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_postcalc_locals' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_postcalc_locals-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_postcalc_locals-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_postcalc_locals-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_postcalc_locals: 11</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a78cf2b7e5af5007f227e2371cf8341d6">run_postcalc_locals</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;run_dependencies (</div>
<div class="line">        %args,</div>
<div class="line">        type =&gt; <span class="stringliteral">&#39;post_calc&#39;</span>,</div>
<div class="line">    );</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="ab7f73c1e6bda15c54511435e60d0ba3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_precalc_globals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_precalc_globals' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_precalc_globals-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_precalc_globals-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_precalc_globals-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_precalc_globals: 12</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#ab7f73c1e6bda15c54511435e60d0ba3e">run_precalc_globals</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    my $results = $self-&gt;run_dependencies (</div>
<div class="line">        %args,</div>
<div class="line">        type =&gt; <span class="stringliteral">&#39;pre_calc_global&#39;</span>,</div>
<div class="line">    );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> wantarray ? %$results : $results;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="aa918a94069ac0caffaaa6b9caf3e1d43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::run_precalc_locals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-run_precalc_locals' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-run_precalc_locals-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-run_precalc_locals-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-run_precalc_locals-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in run_precalc_locals: 10</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#aa918a94069ac0caffaaa6b9caf3e1d43">run_precalc_locals</a> {</div>
<div class="line">    my $self = shift;</div>
<div class="line">    my %args = @_;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> $self-&gt;run_dependencies (</div>
<div class="line">        %args,</div>
<div class="line">        type =&gt; <span class="stringliteral">&#39;pre_calc&#39;</span>,</div>
<div class="line">    );</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<a class="anchor" id="a3818f945a2dbeab73ef68e715ce8f9f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">public method Biodiverse::Indices::set_pairwise_mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undocumented Method  
<div id='codesection-set_pairwise_mode' class='dynheader closed' style='cursor:pointer;' onclick='return toggleVisibility(this)'>
    <img id='codesection-set_pairwise_mode-trigger' src='closed.png' style='display:inline'><b>Code:</b>
</div>
<div id='codesection-set_pairwise_mode-summary' class='dyncontent' style='display:block;font-size:small;'>click to view</div>
<div id='codesection-set_pairwise_mode-content' class='dyncontent' style='display: none;'>
 <div class="fragment"><div class="line"><span class="preprocessor"># Number of lines of code in set_pairwise_mode: 8</span></div>
<div class="line"><span class="preprocessor"></span>sub <a class="code" href="classBiodiverse_1_1Indices.html#a3818f945a2dbeab73ef68e715ce8f9f1">set_pairwise_mode</a> {</div>
<div class="line">    my ($self, $mode) = @_;</div>
<div class="line">    </div>
<div class="line">    $self-&gt;{pairwise_mode} = $mode;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> $mode;</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/Biodiverse/<a class="el" href="Indices_8pm_source.html">Indices.pm</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Biodiverse</b></li><li class="navelem"><a class="el" href="classBiodiverse_1_1Indices.html">Indices</a></li>
    <li class="footer">Generated on Tue Nov 5 2013 19:07:25 for Biodiverse by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
